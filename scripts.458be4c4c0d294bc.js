var fA=Object.defineProperty,gA=Object.defineProperties,pA=Object.getOwnPropertyDescriptors,yl=Object.getOwnPropertySymbols,aw=Object.prototype.hasOwnProperty,iw=Object.prototype.propertyIsEnumerable,lw=(Wt,jt,ge)=>jt in Wt?fA(Wt,jt,{enumerable:!0,configurable:!0,writable:!0,value:ge}):Wt[jt]=ge,at=(Wt,jt)=>{for(var ge in jt||(jt={}))aw.call(jt,ge)&&lw(Wt,ge,jt[ge]);if(yl)for(var ge of yl(jt))iw.call(jt,ge)&&lw(Wt,ge,jt[ge]);return Wt},Rt=(Wt,jt)=>gA(Wt,pA(jt)),dw=(Wt,jt)=>{var ge={};for(var We in Wt)aw.call(Wt,We)&&jt.indexOf(We)<0&&(ge[We]=Wt[We]);if(null!=Wt&&yl)for(var We of yl(Wt))jt.indexOf(We)<0&&iw.call(Wt,We)&&(ge[We]=Wt[We]);return ge};!function(){"use strict";var Wt=function(t){if(null===t)return"null";if(void 0===t)return"undefined";var e=typeof t;return"object"===e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e},jt=function(t){return{eq:t}},ge=jt(function(t,e){return t===e}),We=function(t){return jt(function(e,n){if(e.length!==n.length)return!1;for(var r=e.length,o=0;o<r;o++)if(!t.eq(e[o],n[o]))return!1;return!0})},Om=function(t){return jt(function(e,n){var l,c,u,r=Object.keys(e),o=Object.keys(n);if(!(l=ge,c=We(l),u=function(c){return Array.prototype.slice.call(c).sort(void 0)},jt(function(f,m){return c.eq(u(f),u(m))})).eq(r,o))return!1;for(var s=r.length,a=0;a<s;a++){var i=r[a];if(!t.eq(e[i],n[i]))return!1}return!0})},Cl=jt(function(t,e){if(t===e)return!0;var n=Wt(t);return n===Wt(e)&&(-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(n)?t===e:"array"===n?We(Cl).eq(t,e):"object"===n&&Om(Cl).eq(t,e))});const cw=Object.getPrototypeOf,Tm=(t,e,n)=>{var r;return!!n(t,e.prototype)||(null===(r=t.constructor)||void 0===r?void 0:r.name)===e.name},wl=t=>e=>(n=>{const r=typeof n;return null===n?"null":"object"===r&&Array.isArray(n)?"array":"object"===r&&Tm(n,String,(o,s)=>s.isPrototypeOf(o))?"string":r})(e)===t,xl=t=>e=>typeof e===t,Bm=t=>e=>t===e,ma=(t,e)=>Te(t)&&Tm(t,e,(n,r)=>cw(n)===r),st=wl("string"),Te=wl("object"),Dm=t=>ma(t,Object),Kt=wl("array"),$o=Bm(null),ur=xl("boolean"),we=Bm(void 0),xe=t=>null==t,lt=t=>!xe(t),xt=xl("function"),mn=xl("number"),Wr=(t,e)=>{if(Kt(t)){for(let n=0,r=t.length;n<r;++n)if(!e(t[n]))return!1;return!0}return!1},pt=()=>{},mr=(t,e)=>(...n)=>t(e.apply(null,n)),Pm=(t,e)=>n=>t(e(n)),q=t=>()=>t,pe=t=>t,uw=(t,e)=>t===e;function Y(t,...e){return(...n)=>{const r=e.concat(n);return t.apply(null,r)}}const kl=t=>e=>!t(e),Sl=t=>t(),qo=t=>{t()},Dt=q(!1),Vt=q(!0);class C{constructor(e,n){this.tag=e,this.value=n}static some(e){return new C(!0,e)}static none(){return C.singletonNone}fold(e,n){return this.tag?n(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?C.some(e(this.value)):C.none()}bind(e){return this.tag?e(this.value):C.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:C.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return lt(e)?C.some(e):C.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}C.singletonNone=new C(!1);const El=Array.prototype.slice,mw=Array.prototype.indexOf,fw=Array.prototype.push,Lm=(t,e)=>mw.call(t,e),Ot=(t,e)=>Lm(t,e)>-1,It=(t,e)=>{for(let n=0,r=t.length;n<r;n++)if(e(t[n],n))return!0;return!1},yt=(t,e)=>{const n=t.length,r=new Array(n);for(let o=0;o<n;o++)r[o]=e(t[o],o);return r},H=(t,e)=>{for(let n=0,r=t.length;n<r;n++)e(t[n],n)},Mm=(t,e)=>{for(let n=t.length-1;n>=0;n--)e(t[n],n)},Wo=(t,e)=>{const n=[],r=[];for(let o=0,s=t.length;o<s;o++){const a=t[o];(e(a,o)?n:r).push(a)}return{pass:n,fail:r}},dt=(t,e)=>{const n=[];for(let r=0,o=t.length;r<o;r++){const s=t[r];e(s,r)&&n.push(s)}return n},fa=(t,e,n)=>(Mm(t,(r,o)=>{n=e(n,r,o)}),n),Be=(t,e,n)=>(H(t,(r,o)=>{n=e(n,r,o)}),n),Im=(t,e,n)=>{for(let r=0,o=t.length;r<o;r++){const s=t[r];if(e(s,r))return C.some(s);if(n(s,r))break}return C.none()},Gt=(t,e)=>Im(t,e,Dt),Ko=(t,e)=>{for(let n=0,r=t.length;n<r;n++)if(e(t[n],n))return C.some(n);return C.none()},Fm=t=>{const e=[];for(let n=0,r=t.length;n<r;++n){if(!Kt(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);fw.apply(e,t[n])}return e},Dn=(t,e)=>Fm(yt(t,e)),Kr=(t,e)=>{for(let n=0,r=t.length;n<r;++n)if(!0!==e(t[n],n))return!1;return!0},Go=t=>{const e=El.call(t,0);return e.reverse(),e},_l=(t,e)=>dt(t,n=>!Ot(e,n)),Nl=(t,e)=>{const n={};for(let r=0,o=t.length;r<o;r++){const s=t[r];n[String(s)]=e(s,r)}return n},Yo=(t,e)=>{const n=El.call(t,0);return n.sort(e),n},Rl=(t,e)=>e>=0&&e<t.length?C.some(t[e]):C.none(),De=t=>Rl(t,0),Gr=t=>Rl(t,t.length-1),ke=xt(Array.from)?Array.from:t=>El.call(t),Yr=(t,e)=>{for(let n=0;n<t.length;n++){const r=e(t[n],n);if(r.isSome())return r}return C.none()},Ke=Object.keys,gw=Object.hasOwnProperty,At=(t,e)=>{const n=Ke(t);for(let r=0,o=n.length;r<o;r++){const s=n[r];e(t[s],s)}},Xo=(t,e)=>pw(t,(n,r)=>({k:r,v:e(n,r)})),pw=(t,e)=>{const n={};return At(t,(r,o)=>{const s=e(r,o);n[s.k]=s.v}),n},Al=t=>(e,n)=>{t[n]=e},Um=(t,e,n,r)=>(At(t,(o,s)=>{(e(o,s)?n:r)(o,s)}),{}),Qo=(t,e)=>{const n={};return Um(t,e,Al(n),pt),n},Ol=(t,e)=>{const n=[];return At(t,(r,o)=>{n.push(e(r,o))}),n},Tl=t=>Ol(t,pe),Nt=(t,e)=>gt(t,e)?C.from(t[e]):C.none(),gt=(t,e)=>gw.call(t,e),Xr=(t,e)=>gt(t,e)&&null!=t[e],zm=t=>{const e={};return H(t,n=>{e[n]={}}),Ke(e)},Bl=Array.isArray,Jo=(t,e,n)=>{let r,o;if(!t)return!1;if(n=n||t,void 0!==t.length){for(r=0,o=t.length;r<o;r++)if(!1===e.call(n,t[r],r,t))return!1}else for(r in t)if(gt(t,r)&&!1===e.call(n,t[r],r,t))return!1;return!0},Dl=(t,e)=>{const n=[];return Jo(t,(r,o)=>{n.push(e(r,o,t))}),n},Qr=(t,e)=>{const n=[];return Jo(t,(r,o)=>{e&&!e(r,o,t)||n.push(r)}),n},jm=(t,e)=>{if(t)for(let n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},ga=(t,e,n,r)=>{let o=we(n)?t[0]:n;for(let s=0;s<t.length;s++)o=e.call(r,o,t[s],s);return o},Vm=(t,e,n)=>{let r,o;for(r=0,o=t.length;r<o;r++)if(e.call(n,t[r],r,t))return r;return-1},fr=t=>t[t.length-1],gr=t=>{let e,n=!1;return(...r)=>(n||(n=!0,e=t.apply(null,r)),e)},Hm=()=>Pl(0,0),Pl=(t,e)=>({major:t,minor:e}),Zo={nu:Pl,detect:(t,e)=>{const n=String(e).toLowerCase();return 0===t.length?Hm():((r,o)=>{const s=((i,l)=>{for(let d=0;d<i.length;d++){const c=i[d];if(c.test(l))return c}})(r,o);if(!s)return{major:0,minor:0};const a=i=>Number(o.replace(s,"$"+i));return Pl(a(1),a(2))})(t,n)},unknown:Hm},$m=(t,e)=>{const n=String(e).toLowerCase();return Gt(t,r=>r.search(n))},qm=(t,e,n)=>""===e||t.length>=e.length&&t.substr(n,n+e.length)===e,de=(t,e)=>-1!==t.indexOf(e),ne=(t,e)=>qm(t,e,0),Wm=(t,e)=>qm(t,e,t.length-e.length),Ll=t=>e=>e.replace(t,""),Jr=Ll(/^\s+|\s+$/g),hw=Ll(/^\s+/g),Km=Ll(/\s+$/g),Pn=t=>t.length>0,pa=t=>!Pn(t),bw=(t,e=10)=>{const n=parseInt(t,e);return isNaN(n)?C.none():C.some(n)},Ml=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ln=t=>e=>de(e,t),vw=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:t=>de(t,"edge/")&&de(t,"chrome")&&de(t,"safari")&&de(t,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ml],search:t=>de(t,"chrome")&&!de(t,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:t=>de(t,"msie")||de(t,"trident")},{name:"Opera",versionRegexes:[Ml,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Ln("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ln("firefox")},{name:"Safari",versionRegexes:[Ml,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:t=>(de(t,"safari")||de(t,"mobile/"))&&de(t,"applewebkit")}],yw=[{name:"Windows",search:Ln("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:t=>de(t,"iphone")||de(t,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ln("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:Ln("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ln("linux"),versionRegexes:[]},{name:"Solaris",search:Ln("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ln("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Ln("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Gm={browsers:q(vw),oses:q(yw)},Xm="Chromium",Jm="Firefox",tf=t=>{const e=t.current,r=o=>()=>e===o;return{current:e,version:t.version,isEdge:r("Edge"),isChromium:r(Xm),isIE:r("IE"),isOpera:r("Opera"),isFirefox:r(Jm),isSafari:r("Safari")}},Cw=()=>tf({current:void 0,version:Zo.unknown()}),ww=tf,ef=(q("Edge"),q(Xm),q("IE"),q("Opera"),q(Jm),q("Safari"),"Windows"),nf="Android",sf="Solaris",af="FreeBSD",lf="ChromeOS",df=t=>{const e=t.current,r=o=>()=>e===o;return{current:e,version:t.version,isWindows:r(ef),isiOS:r("iOS"),isAndroid:r(nf),isMacOS:r("macOS"),isLinux:r("Linux"),isSolaris:r(sf),isFreeBSD:r(af),isChromeOS:r(lf)}},xw=()=>df({current:void 0,version:Zo.unknown()}),kw=df,Sw=(q(ef),q("iOS"),q(nf),q("Linux"),q("macOS"),q(sf),q(af),q(lf),t=>window.matchMedia(t).matches);let Ew=gr(()=>((t,e,n)=>{const r=Gm.browsers(),o=Gm.oses(),s=e.bind(l=>{return d=r,Yr(l.brands,u=>{const f=u.brand.toLowerCase();return Gt(d,m=>{var g;return f===(null===(g=m.brand)||void 0===g?void 0:g.toLowerCase())}).map(m=>({current:m.name,version:Zo.nu(parseInt(u.version,10),0)}))});var d}).orThunk(()=>{return $m(r,d=t).map(c=>{const u=Zo.detect(c.versionRegexes,d);return{current:c.name,version:u}});var d}).fold(Cw,ww),a=(l=o,d=t,$m(l,d).map(c=>{const u=Zo.detect(c.versionRegexes,d);return{current:c.name,version:u}})).fold(xw,kw),i=((l,d,c,u)=>{const f=l.isiOS()&&!0===/ipad/i.test(c),m=l.isiOS()&&!f,g=l.isiOS()||l.isAndroid(),p=g||u("(pointer:coarse)"),b=f||!m&&g&&u("(min-device-width:768px)"),h=m||g&&!b,v=d.isSafari()&&l.isiOS()&&!1===/safari/i.test(c),y=!h&&!b&&!v;return{isiPad:q(f),isiPhone:q(m),isTablet:q(b),isPhone:q(h),isTouch:q(p),isAndroid:l.isAndroid,isiOS:l.isiOS,isWebView:q(v),isDesktop:q(y)}})(a,s,t,n);var l,d;return{browser:s,os:a,deviceType:i}})(navigator.userAgent,C.from(navigator.userAgentData),Sw));const pr=()=>Ew(),_w=navigator.userAgent,Il=pr(),fn=Il.browser,gn=Il.os,hr=Il.deviceType,Nw=-1!==_w.indexOf("Windows Phone"),Ct={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:fn.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!fn.isIE(),windowsPhone:Nw,browser:{current:fn.current,version:fn.version,isChromium:fn.isChromium,isEdge:fn.isEdge,isFirefox:fn.isFirefox,isIE:fn.isIE,isOpera:fn.isOpera,isSafari:fn.isSafari},os:{current:gn.current,version:gn.version,isAndroid:gn.isAndroid,isChromeOS:gn.isChromeOS,isFreeBSD:gn.isFreeBSD,isiOS:gn.isiOS,isLinux:gn.isLinux,isMacOS:gn.isMacOS,isSolaris:gn.isSolaris,isWindows:gn.isWindows},deviceType:{isDesktop:hr.isDesktop,isiPad:hr.isiPad,isiPhone:hr.isiPhone,isPhone:hr.isPhone,isTablet:hr.isTablet,isTouch:hr.isTouch,isWebView:hr.isWebView}},Rw=/^\s*|\s*$/g,cf=t=>null==t?"":(""+t).replace(Rw,""),uf=(t,e)=>e?!("array"!==e||!Bl(t))||typeof t===e:void 0!==t,mf=function(t,e,n,r){r=r||this,t&&(n&&(t=t[n]),Jo(t,(o,s)=>{if(!1===e.call(r,o,s,n))return!1;mf(o,e,n,r)}))},z={trim:cf,isArray:Bl,is:uf,toArray:t=>{if(Bl(t))return t;{const e=[];for(let n=0,r=t.length;n<r;n++)e[n]=t[n];return e}},makeMap:(t,e,n)=>{let r;for(e=e||",","string"==typeof(t=t||[])&&(t=t.split(e)),n=n||{},r=t.length;r--;)n[t[r]]={};return n},each:Jo,map:Dl,grep:Qr,inArray:jm,hasOwn:gt,extend:(t,...e)=>{for(let n=0;n<e.length;n++){const r=e[n];for(const o in r)if(gt(r,o)){const s=r[o];void 0!==s&&(t[o]=s)}}return t},walk:mf,resolve:(t,e)=>{let n,r;for(e=e||window,n=0,r=(t=t.split(".")).length;n<r&&(e=e[t[n]]);n++);return e},explode:(t,e)=>!t||uf(t,"array")?t:Dl(t.split(e||","),cf),_addCacheSuffix:t=>{const e=Ct.cacheSuffix;return e&&(t+=(-1===t.indexOf("?")?"?":"&")+e),t}},Zr=(t,e,n=uw)=>t.exists(r=>n(r,e)),Se=(t,e,n)=>t.isSome()&&e.isSome()?C.some(n(t.getOrDie(),e.getOrDie())):C.none(),Fl=(t,e)=>t?C.some(e):C.none();"undefined"!=typeof window||Function("return this;")();const Tt=t=>t.dom.nodeName.toLowerCase(),ff=t=>t.dom.nodeType,ha=t=>e=>ff(e)===t,Ge=ha(1),Le=ha(3),Aw=ha(9),Ow=ha(11),gf=t=>e=>Ge(e)&&Tt(e)===t,pf=(t,e,n)=>{if(!(st(n)||ur(n)||mn(n)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",n,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,n+"")},re=(t,e,n)=>{pf(t.dom,e,n)},pn=(t,e)=>{const n=t.dom;At(e,(r,o)=>{pf(n,o,r)})},Me=(t,e)=>{const n=t.dom.getAttribute(e);return null===n?void 0:n},to=(t,e)=>C.from(Me(t,e)),ts=(t,e)=>{const n=t.dom;return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},oe=(t,e)=>{t.dom.removeAttribute(e)},hf=t=>Be(t.dom.attributes,(e,n)=>(e[n.name]=n.value,e),{}),Ul=(t,e)=>{const n=Me(t,e);return void 0===n||""===n?[]:n.split(" ")},es=t=>void 0!==t.dom.classList,bf=t=>Ul(t,"class"),vf=(t,e)=>((n,r,o)=>{const s=Ul(n,r).concat([o]);return re(n,r,s.join(" ")),!0})(t,"class",e),yf=(t,e)=>((n,r,o)=>{const s=dt(Ul(n,r),a=>a!==o);return s.length>0?re(n,r,s.join(" ")):oe(n,r),!1})(t,"class",e),ns=(t,e)=>{es(t)?t.dom.classList.add(e):vf(t,e)},Cf=t=>{0===(es(t)?t.dom.classList:bf(t)).length&&oe(t,"class")},ba=(t,e)=>{es(t)?t.dom.classList.remove(e):yf(t,e),Cf(t)},zl=(t,e)=>es(t)&&t.dom.classList.contains(e),rs=t=>void 0!==t.style&&xt(t.style.getPropertyValue),os=t=>{if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}},ss=(t,e)=>{const n=(e||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||n.childNodes.length>1){const r="HTML does not have a single root node";throw console.error(r,t),new Error(r)}return os(n.childNodes[0])},Ut=(t,e)=>{const n=(e||document).createElement(t);return os(n)},as=(t,e)=>{const n=(e||document).createTextNode(t);return os(n)},N=os,wf=(t,e)=>{const n=[],r=s=>(n.push(s),e(s));let o=e(t);do{o=o.bind(r)}while(o.isSome());return n},hn=(t,e)=>{const n=t.dom;if(1!==n.nodeType)return!1;{const r=n;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}},xf=t=>1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount,kt=(t,e)=>t.dom===e.dom,Mn=(t,e)=>{const n=t.dom,r=e.dom;return n!==r&&n.contains(r)},kf=t=>N(t.dom.ownerDocument),Wn=t=>Aw(t)?t:kf(t),Sf=t=>N(Wn(t).dom.defaultView),Ye=t=>C.from(t.dom.parentNode).map(N),br=t=>C.from(t.dom.previousSibling).map(N),is=t=>C.from(t.dom.nextSibling).map(N),Ef=t=>Go(wf(t,br)),_f=t=>wf(t,is),se=t=>yt(t.dom.childNodes,N),va=(t,e)=>C.from(t.dom.childNodes[e]).map(N),Nf=t=>va(t,0),jl=t=>va(t,t.dom.childNodes.length-1),Rf=t=>t.dom.childNodes.length,Af=t=>Ow(t)&&lt(t.dom.host),Of=xt(Element.prototype.attachShadow)&&xt(Node.prototype.getRootNode),Bw=q(Of),vr=Of?t=>N(t.dom.getRootNode()):Wn,Vl=t=>Af(t)?t:(e=>{const n=e.dom.head;if(null==n)throw new Error("Head is not available yet");return N(n)})(Wn(t)),Dw=t=>N(t.dom.host),Tf=t=>{if(Bw()&&lt(t.target)){const e=N(t.target);if(Ge(e)&&Pw(e)&&t.composed&&t.composedPath){const n=t.composedPath();if(n)return De(n)}}return C.from(t.target)},Pw=t=>lt(t.dom.shadowRoot),eo=t=>{const e=Le(t)?t.dom.parentNode:t.dom;if(null==e||null===e.ownerDocument)return!1;const n=e.ownerDocument;return(r=>{const o=vr(r);return Af(o)?C.some(o):C.none()})(N(e)).fold(()=>n.body.contains(e),Pm(eo,Dw))},Bf=(t,e,n)=>{if(!st(n))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",n,":: Element ",t),new Error("CSS value must be a string: "+n);rs(t)&&t.style.setProperty(e,n)},Df=(t,e,n)=>{Bf(t.dom,e,n)},ya=(t,e)=>{const n=t.dom;At(e,(r,o)=>{Bf(n,o,r)})},bn=(t,e)=>{const n=t.dom,r=window.getComputedStyle(n).getPropertyValue(e);return""!==r||eo(t)?r:Pf(n,e)},Pf=(t,e)=>rs(t)?t.style.getPropertyValue(e):"",Ca=(t,e)=>{const r=Pf(t.dom,e);return C.from(r).filter(o=>o.length>0)},Lf=t=>{const e={},n=t.dom;if(rs(n))for(let r=0;r<n.style.length;r++){const o=n.style.item(r);e[o]=n.style[o]}return e},Mf=(t,e)=>{var n,r;r=e,rs(n=t.dom)&&n.style.removeProperty(r),Zr(to(t,"style").map(Jr),"")&&oe(t,"style")},Xe=(t,e)=>{Ye(t).each(n=>{n.dom.insertBefore(e.dom,t.dom)})},Kn=(t,e)=>{is(t).fold(()=>{Ye(t).each(n=>{Ht(n,e)})},n=>{Xe(n,e)})},If=(t,e)=>{Nf(t).fold(()=>{Ht(t,e)},n=>{t.dom.insertBefore(e.dom,n.dom)})},Ht=(t,e)=>{t.dom.appendChild(e.dom)},yr=(t,e)=>{H(e,n=>{Ht(t,n)})},ls=t=>{t.dom.textContent="",H(se(t),e=>{Mt(e)})},Mt=t=>{const e=t.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},Cr=t=>{const e=se(t);var n,r;e.length>0&&(n=t,H(r=e,(o,s)=>{Kn(0===s?n:r[s-1],o)})),Mt(t)},Ff=t=>t.dom.innerHTML,Hl=(t,e)=>{const n=kf(t).dom,r=N(n.createDocumentFragment()),o=((s,a)=>{const i=(a||document).createElement("div");return i.innerHTML=s,se(N(i))})(e,n);yr(r,o),ls(t),Ht(t,r)},Mw=(t,e,n,r)=>{t.dom.removeEventListener(e,n,r)},Uf=(t,e)=>({left:t,top:e,translate:(n,r)=>Uf(t+n,e+r)}),no=Uf,wa=(t,e)=>void 0!==t?t:void 0!==e?e:0,$l=t=>{const e=t.dom,n=e.ownerDocument.body;return n===e?no(n.offsetLeft,n.offsetTop):eo(t)?(r=>{const o=r.getBoundingClientRect();return no(o.left,o.top)})(e):no(0,0)},ql=t=>{const e=void 0!==t?t.dom:document;return no(e.body.scrollLeft||e.documentElement.scrollLeft,e.body.scrollTop||e.documentElement.scrollTop)},zf=(t,e,n)=>{const r=(void 0!==n?n.dom:document).defaultView;r&&r.scrollTo(t,e)},jf=(t,e)=>{pr().browser.isSafari()&&xt(t.dom.scrollIntoViewIfNeeded)?t.dom.scrollIntoViewIfNeeded(!1):t.dom.scrollIntoView(e)},Vf=(t,e,n,r)=>({x:t,y:e,width:n,height:r,right:t+n,bottom:e+r}),Hf=t=>{const e=void 0===t?window:t,r=ql(N(e.document));return(o=>{const s=void 0===o?window:o;return pr().browser.isFirefox()?C.none():C.from(s.visualViewport)})(e).fold(()=>{const o=e.document.documentElement;return Vf(r.left,r.top,o.clientWidth,o.clientHeight)},o=>Vf(Math.max(o.pageLeft,r.left),Math.max(o.pageTop,r.top),o.width,o.height))},wr=t=>e=>!!e&&e.nodeType===t,xa=t=>!!t&&!Object.getPrototypeOf(t),rt=wr(1),Qe=t=>{const e=t.map(n=>n.toLowerCase());return n=>{if(n&&n.nodeName){const r=n.nodeName.toLowerCase();return Ot(e,r)}return!1}},ka=(t,e)=>{const n=e.toLowerCase().split(" ");return r=>{if(rt(r))for(let o=0;o<n.length;o++){const s=r.ownerDocument.defaultView.getComputedStyle(r,null);if((s?s.getPropertyValue(t):null)===n[o])return!0}return!1}},$f=t=>e=>rt(e)&&e.hasAttribute(t),xr=t=>rt(t)&&t.hasAttribute("data-mce-bogus"),ds=t=>rt(t)&&"TABLE"===t.tagName,qf=t=>e=>!(!rt(e)||e.contentEditable!==t&&e.getAttribute("data-mce-contenteditable")!==t),Wl=Qe(["textarea","input"]),G=wr(3),Iw=wr(4),Fw=wr(7),Kl=wr(8),Gl=wr(9),Yl=wr(11),Ft=Qe(["br"]),Wf=Qe(["img"]),vn=qf("true"),Bt=qf("false"),Sa=Qe(["td","th"]),yn=Qe(["video","audio","object","embed"]),Uw=pr().browser,Kf=t=>Gt(t,Ge),Gf=(t,e)=>t.children&&Ot(t.children,e);var Yf=(t,e,n,r,o)=>t(n,r)?C.some(n):xt(o)&&o(n)?C.none():e(n,r,o);const ro=(t,e,n)=>{let r=t.dom;const o=xt(n)?n:Dt;for(;r.parentNode;){r=r.parentNode;const s=N(r);if(e(s))return C.some(s);if(o(s))break}return C.none()},oo=(t,e,n)=>Yf((r,o)=>o(r),ro,t,e,n),cs=(t,e,n)=>ro(t,r=>hn(r,e),n),us=(t,e)=>((n,r)=>{const o=void 0===r?document:r.dom;return xf(o)?C.none():C.from(o.querySelector(n)).map(N)})(e,t),kr=(t,e,n)=>Yf((r,o)=>hn(r,o),cs,t,e,n),Xf=(t,e={})=>{let n=0;const r={},o=N(t),s=Wn(o),a=e.maxLoadTime||5e3,i=d=>new Promise((c,u)=>{let f;const m=z._addCacheSuffix(d),g=Nt(r,m).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0}));r[m]=g,g.count++;const p=(S,k)=>{H(S,qo),g.status=k,g.passed=[],g.failed=[],f&&(f.onload=null,f.onerror=null,f=null)},b=()=>p(g.passed,2),h=()=>p(g.failed,3),v=()=>{var S;S=v,(()=>{const k=t.styleSheets;let D=k.length;for(;D--;){const B=k[D].ownerNode;if(B&&B.id===f.id)return b(),!0}return!1})()||(Date.now()-w<a?setTimeout(S):h())};if(c&&g.passed.push(c),u&&g.failed.push(u),1===g.status)return;if(2===g.status)return void b();if(3===g.status)return void h();g.status=1;const y=Ut("link",s.dom);pn(y,{rel:"stylesheet",type:"text/css",id:g.id});const w=Date.now();var x;e.contentCssCors&&re(y,"crossOrigin","anonymous"),e.referrerPolicy&&re(y,"referrerpolicy",e.referrerPolicy),f=y.dom,f.onload=v,f.onerror=h,x=y,Ht(Vl(o),x),re(y,"href",m)}),l=d=>{const c=z._addCacheSuffix(d);Nt(r,c).each(u=>{0==--u.count&&(delete r[c],(f=>{const m=Vl(o);us(m,"#"+f).each(Mt)})(u.id))})};return{load:i,loadAll:d=>Promise.allSettled(yt(d,c=>i(c).then(q(c)))).then(c=>{const u=Wo(c,f=>"fulfilled"===f.status);return u.fail.length>0?Promise.reject(yt(u.fail,f=>f.reason)):yt(u.pass,f=>f.value)}),unload:l,unloadAll:d=>{H(d,c=>{l(c)})},_setReferrerPolicy:d=>{e.referrerPolicy=d}}},Qf=(()=>{const t=new WeakMap;return{forElement:(e,n)=>{const r=vr(e).dom;return C.from(t.get(r)).getOrThunk(()=>{const o=Xf(r,n);return t.set(r,o),o})}}})();class zt{constructor(e,n){this.node=e,this.rootNode=n,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(e){return this.node=this.findSibling(this.node,"firstChild","nextSibling",e),this.node}prev(e){return this.node=this.findSibling(this.node,"lastChild","previousSibling",e),this.node}prev2(e){return this.node=this.findPreviousNode(this.node,e),this.node}findSibling(e,n,r,o){let s,a;if(e){if(!o&&e[n])return e[n];if(e!==this.rootNode){if(s=e[r],s)return s;for(a=e.parentNode;a&&a!==this.rootNode;a=a.parentNode)if(s=a[r],s)return s}}}findPreviousNode(e,n){let r,o,s;if(e){if(r=e.previousSibling,this.rootNode&&r===this.rootNode)return;if(r){if(!n)for(s=r.lastChild;s;s=s.lastChild)if(!s.lastChild)return s;return r}if(o=e.parentNode,o&&o!==this.rootNode)return o}}}const zw=["pre"].concat(["h1","h2","h3","h4","h5","h6"]),Gn=t=>{let e;return n=>(e=e||Nl(t,Vt),gt(e,Tt(n)))},en=Gn(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),Xl=t=>Ge(t)&&!en(t),so=t=>Ge(t)&&"br"===Tt(t),jw=Gn(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),Ql=Gn(["ul","ol","dl"]),ms=Gn(["li","dd","dt"]),Vw=Gn(["thead","tbody","tfoot"]),Ea=Gn(["td","th"]),_a=Gn(["pre","script","textarea","style"]),Hw=Gn(zw),$w=t=>Hw(t)||Xl(t),Jf=(t,e,n)=>cs(t,e,n).isSome(),ae="\xa0",Zf=t=>"\ufeff"===t,ie="\ufeff",Ra=Zf,Yn=t=>t.replace(/\uFEFF/g,""),qw=rt,ao=G,io=t=>(ao(t)&&(t=t.parentNode),qw(t)&&t.hasAttribute("data-mce-caret")),lo=t=>ao(t)&&Ra(t.data),Ie=t=>io(t)||lo(t),tg=t=>t.firstChild!==t.lastChild||!Ft(t.firstChild),Jl=t=>{const e=t.container();return!!G(e)&&(e.data.charAt(t.offset())===ie||t.isAtStart()&&lo(e.previousSibling))},Zl=t=>{const e=t.container();return!!G(e)&&(e.data.charAt(t.offset()-1)===ie||t.isAtEnd()&&lo(e.nextSibling))},Aa=t=>ao(t)&&t.data[0]===ie,Oa=t=>ao(t)&&t.data[t.data.length-1]===ie,td=t=>t&&t.hasAttribute("data-mce-caret")?((e=>{const n=e.getElementsByTagName("br"),r=n[n.length-1];xr(r)&&r.parentNode.removeChild(r)})(t),t.removeAttribute("data-mce-caret"),t.removeAttribute("data-mce-bogus"),t.removeAttribute("style"),t.removeAttribute("data-mce-style"),t.removeAttribute("_moz_abspos"),t):null,eg=t=>io(t.startContainer),ng=vn,Ww=Bt,Kw=Ft,Gw=G,Yw=Qe(["script","style","textarea"]),rg=Qe(["img","input","textarea","hr","iframe","video","audio","object","embed"]),Xw=Qe(["table"]),Qw=Ie,Je=t=>!Qw(t)&&(Gw(t)?!Yw(t.parentNode):rg(t)||Kw(t)||Xw(t)||ed(t)),ed=t=>{return!1===(rt(e=t)&&"true"===e.getAttribute("unselectable"))&&Ww(t);var e},og=(t,e)=>Je(t)&&((n,r)=>{for(n=n.parentNode;n&&n!==r;n=n.parentNode){if(ed(n))return!1;if(ng(n))return!0}return!0})(t,e),Jw=/^[ \t\r\n]*$/,Sr=t=>Jw.test(t),sg=t=>"\n"===t||"\r"===t,ag=(t,e=4,n=!0,r=!0)=>{const o=(l=e)<=0?"":new Array(l+1).join(" "),s=t.replace(/\t/g,o);var l;return Be(s,(i,l)=>{return-1!==" \f\t\v".indexOf(l)||l===ae?i.pcIsSpace||""===i.str&&n||i.str.length===s.length-1&&r||(c=i.str.length+1)<(d=s).length&&c>=0&&sg(d[c])?{pcIsSpace:!1,str:i.str+ae}:{pcIsSpace:!0,str:i.str+" "}:{pcIsSpace:sg(l),str:i.str+l};var d,c},{pcIsSpace:!1,str:""}).str},Ta=(t,e)=>{return Je(t)&&!1===(r=e,G(n=t)&&Sr(n.data)&&!1===((o,s)=>{const a=N(s),i=N(o);return Jf(i,"pre,code",Y(kt,a))})(n,r))||(n=>rt(n)&&"A"===n.nodeName&&!n.hasAttribute("href")&&(n.hasAttribute("name")||n.hasAttribute("id")))(t)||Zw(t);var n,r},Zw=$f("data-mce-bookmark"),tx=$f("data-mce-bogus"),ex=t=>rt(t)&&"all"===t.getAttribute("data-mce-bogus"),Yt=(t,e=!0)=>((n,r)=>{let o=0;if(Ta(n,n))return!1;{let s=n.firstChild;if(!s)return!0;const a=new zt(s,n);do{if(r){if(ex(s)){s=a.next(!0);continue}if(tx(s)){s=a.next();continue}}if(Ft(s))o++,s=a.next();else{if(Ta(s,n))return!1;s=a.next()}}while(s);return o<=1}})(t.dom,e),ig=(t,e)=>lt(t)&&(Ta(t,e)||Xl(N(t))),lg=t=>"span"===t.nodeName.toLowerCase()&&"bookmark"===t.getAttribute("data-mce-type"),nd=(t,e,n)=>{const r=n||e;if(rt(e)&&lg(e))return e;const o=e.childNodes;for(let s=o.length-1;s>=0;s--)nd(t,o[s],r);if(rt(e)){const s=e.childNodes;1===s.length&&lg(s[0])&&e.parentNode.insertBefore(s[0],e)}return Yl(s=e)||Gl(s)||Ta(e,r)||(s=>!!rt(s)&&s.childNodes.length>0)(e)||((s,a)=>G(s)&&s.data.length>0&&((i,l)=>{const d=new zt(i,l).prev(!1),c=new zt(i,l).next(!1),u=we(d)||ig(d,l),f=we(c)||ig(c,l);return u&&f})(s,a))(e,r)||t.remove(e),e;var s},nx=z.makeMap,Ba=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Da=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rx=/[<>&\"\']/g,ox=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,sx={128:"\u20ac",130:"\u201a",131:"\u0192",132:"\u201e",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02c6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017d",145:"\u2018",146:"\u2019",147:"\u201c",148:"\u201d",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02dc",153:"\u2122",154:"\u0161",155:"\u203a",156:"\u0153",158:"\u017e",159:"\u0178"},Er={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},ax={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},dg=(t,e)=>{let n,r,o;const s={};if(t){for(t=t.split(","),e=e||10,n=0;n<t.length;n+=2)r=String.fromCharCode(parseInt(t[n],e)),Er[r]||(o="&"+t[n+1]+";",s[r]=o,s[o]=r);return s}},rd=dg("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),cg=(t,e)=>t.replace(e?Ba:Da,n=>Er[n]||n),ug=(t,e)=>t.replace(e?Ba:Da,n=>n.length>1?"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";":Er[n]||"&#"+n.charCodeAt(0)+";"),od=(t,e,n)=>(n=n||rd,t.replace(e?Ba:Da,r=>Er[r]||n[r]||r)),Xn={encodeRaw:cg,encodeAllRaw:t=>(""+t).replace(rx,e=>Er[e]||e),encodeNumeric:ug,encodeNamed:od,getEncodeFunc:(t,e)=>{const n=dg(e)||rd,r=nx(t.replace(/\+/g,","));return r.named&&r.numeric?(o,s)=>o.replace(s?Ba:Da,a=>void 0!==Er[a]?Er[a]:void 0!==n[a]?n[a]:a.length>1?"&#"+(1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320)+65536)+";":"&#"+a.charCodeAt(0)+";"):r.named?e?(o,s)=>od(o,s,n):od:r.numeric?ug:cg},decode:t=>t.replace(ox,(e,n)=>n?(n="x"===n.charAt(0).toLowerCase()?parseInt(n.substr(1),16):parseInt(n,10))>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(1023&n))):sx[n]||String.fromCharCode(n):ax[e]||rd[e]||(r=>{const o=Ut("div").dom;return o.innerHTML=r,o.textContent||o.innerText||r})(e))},Qn={},ix={},co=z.makeMap,le=z.each,sd=z.extend,mg=z.explode,lx=z.inArray,Jt=(t,e)=>(t=z.trim(t))?t.split(e||" "):[],fg=(t,e)=>{const n=co(t," ",co(t.toUpperCase()," "));return sd(n,e)},gg=t=>fg("td th li dt dd figcaption caption details summary",t.getTextBlockElements()),ad=(t,e)=>{let n;return t&&(n={},"string"==typeof t&&(t={"*":t}),le(t,(r,o)=>{n[o]=n[o.toUpperCase()]="map"===e?co(r,/[, ]/):mg(r,/[, ]/)})),n},Jn=t=>{var e;const n={},r={};let o=[];const s={},a={},i=(A,R,U)=>{let $=t[A];return $?$=co($,/[, ]/,co($.toUpperCase(),/[, ]/)):($=Qn[A],$||($=fg(R,U),Qn[A]=$)),$},l=null!==(e=(t=t||{}).schema)&&void 0!==e?e:"html5",d=(A=>{const R={};let U,$,j,W,Q,ht;const K=(_t,Ce="",Zt="")=>{const te=Jt(Zt),me=Jt(_t);let $e=me.length;for(;$e--;){const ee=Jt([U,Ce].join(" "));R[me[$e]]={attributes:Nl(ee,()=>({})),attributesOrder:ee,children:Nl(te,q(ix))}}},ct=(_t,Ce)=>{const Zt=Jt(_t),te=Jt(Ce);let me=Zt.length;for(;me--;){const $e=R[Zt[me]];for(let ee=0,tn=te.length;ee<tn;ee++)$e.attributes[te[ee]]={},$e.attributesOrder.push(te[ee])}};return Qn[A]?Qn[A]:(U="id accesskey class dir lang style tabindex title role",$="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",j="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==A&&(U+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",$+=" article aside details dialog figure main header footer hgroup section nav",j+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==A&&(U+=" xml:lang",ht="acronym applet basefont big font strike tt",j=[j,ht].join(" "),le(Jt(ht),_t=>{K(_t,"",j)}),Q="center dir isindex noframes",$=[$,Q].join(" "),W=[$,j].join(" "),le(Jt(Q),_t=>{K(_t,"",W)})),W=W||[$,j].join(" "),K("html","manifest","head body"),K("head","","base command link meta noscript script style title"),K("title hr noscript br"),K("base","href target"),K("link","href rel media hreflang type sizes hreflang"),K("meta","name http-equiv content charset"),K("style","media type scoped"),K("script","src async defer type charset"),K("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",W),K("address dt dd div caption","",W),K("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",j),K("blockquote","cite",W),K("ol","reversed start type","li"),K("ul","","li"),K("li","value",W),K("dl","","dt dd"),K("a","href target rel media hreflang type",j),K("q","cite",j),K("ins del","cite datetime",W),K("img","src sizes srcset alt usemap ismap width height"),K("iframe","src name width height",W),K("embed","src type width height"),K("object","data type typemustmatch name usemap form width height",[W,"param"].join(" ")),K("param","name value"),K("map","name",[W,"area"].join(" ")),K("area","alt coords shape href target rel media hreflang type"),K("table","border","caption colgroup thead tfoot tbody tr"+("html4"===A?" col":"")),K("colgroup","span","col"),K("col","span"),K("tbody thead tfoot","","tr"),K("tr","","td th"),K("td","colspan rowspan headers",W),K("th","colspan rowspan headers scope abbr",W),K("form","accept-charset action autocomplete enctype method name novalidate target",W),K("fieldset","disabled form name",[W,"legend"].join(" ")),K("label","form for",j),K("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),K("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===A?W:j),K("select","disabled form multiple name required size","option optgroup"),K("optgroup","disabled label","option"),K("option","disabled label selected value"),K("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),K("menu","type label",[W,"li"].join(" ")),K("noscript","",W),"html4"!==A&&(K("wbr"),K("ruby","",[j,"rt rp"].join(" ")),K("figcaption","",W),K("mark rt rp summary bdi","",j),K("canvas","width height",W),K("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[W,"track source"].join(" ")),K("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[W,"track source"].join(" ")),K("picture","","img source"),K("source","src srcset type media sizes"),K("track","kind src srclang label default"),K("datalist","",[j,"option"].join(" ")),K("article section nav aside main header footer","",W),K("hgroup","","h1 h2 h3 h4 h5 h6"),K("figure","",[W,"figcaption"].join(" ")),K("time","datetime",j),K("dialog","open",W),K("command","type label icon disabled checked radiogroup command"),K("output","for form name",j),K("progress","value max",j),K("meter","value min max low high optimum",j),K("details","open",[W,"summary"].join(" ")),K("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==A&&(ct("script","language xml:space"),ct("style","xml:space"),ct("object","declare classid code codebase codetype archive standby align border hspace vspace"),ct("embed","align name hspace vspace"),ct("param","valuetype type"),ct("a","charset name rev shape coords"),ct("br","clear"),ct("applet","codebase archive code object alt name width height align hspace vspace"),ct("img","name longdesc align border hspace vspace"),ct("iframe","longdesc frameborder marginwidth marginheight scrolling align"),ct("font basefont","size color face"),ct("input","usemap align"),ct("select"),ct("textarea"),ct("h1 h2 h3 h4 h5 h6 div p legend caption","align"),ct("ul","type compact"),ct("li","type"),ct("ol dl menu dir","compact"),ct("pre","width xml:space"),ct("hr","align noshade size width"),ct("isindex","prompt"),ct("table","summary width frame rules cellspacing cellpadding align bgcolor"),ct("col","width align char charoff valign"),ct("colgroup","width align char charoff valign"),ct("thead","align char charoff valign"),ct("tr","align char charoff valign bgcolor"),ct("th","axis align char charoff valign nowrap bgcolor width height"),ct("form","accept"),ct("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),ct("tfoot","align char charoff valign"),ct("tbody","align char charoff valign"),ct("area","nohref"),ct("body","background bgcolor text link vlink alink")),"html4"!==A&&(ct("input button select textarea","autofocus"),ct("input textarea","placeholder"),ct("a","download"),ct("link script img","crossorigin"),ct("img","loading"),ct("iframe","sandbox seamless allowfullscreen loading")),"html4"!==A&&H([R.video,R.audio],_t=>{delete _t.children.audio,delete _t.children.video}),le(Jt("a form meter progress dfn"),_t=>{R[_t]&&delete R[_t].children[_t]}),delete R.caption.children.table,delete R.script,Qn[A]=R,R)})(l);!1===t.verify_html&&(t.valid_elements="*[*]");const c=ad(t.valid_styles),u=ad(t.invalid_styles,"map"),f=ad(t.valid_classes,"map"),m=i("whitespace_elements","pre script noscript style textarea video audio iframe object code"),g=i("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),p=i("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),b=i("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),h="td th iframe video audio object script code",v=i("non_empty_elements",h+" pre",p),y=i("move_caret_before_on_enter_elements",h+" table",p),w=i("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),x=i("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",w),S=i("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp");le("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),A=>{a[A]=new RegExp("</"+A+"[^>]*>","gi")});const k=A=>new RegExp("^"+A.replace(/([?+*])/g,".$1")+"$"),D=A=>{let R,U,$,j,W,Q,ht,K,ct,_t,Ce,Zt,te,me,$e,ee,tn,qe;const fl=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,gl=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,la=/[*?+]/;if(A){const Vo=Jt(A,",");for(n["@"]&&(ee=n["@"].attributes,tn=n["@"].attributesOrder),R=0,U=Vo.length;R<U;R++)if(W=fl.exec(Vo[R]),W){if(me=W[1],ct=W[2],$e=W[3],K=W[5],Zt={},te=[],Q={attributes:Zt,attributesOrder:te},"#"===me&&(Q.paddEmpty=!0),"-"===me&&(Q.removeEmpty=!0),"!"===W[4]&&(Q.removeEmptyAttrs=!0),ee&&(At(ee,(pl,da)=>{Zt[da]=pl}),te.push.apply(te,tn)),K)for(K=Jt(K,"|"),$=0,j=K.length;$<j;$++)if(W=gl.exec(K[$]),W){if(ht={},Ce=W[1],_t=W[2].replace(/[\\:]:/g,":"),me=W[3],qe=W[4],"!"===Ce&&(Q.attributesRequired=Q.attributesRequired||[],Q.attributesRequired.push(_t),ht.required=!0),"-"===Ce){delete Zt[_t],te.splice(lx(te,_t),1);continue}me&&("="===me&&(Q.attributesDefault=Q.attributesDefault||[],Q.attributesDefault.push({name:_t,value:qe}),ht.defaultValue=qe),"~"===me&&(Q.attributesForced=Q.attributesForced||[],Q.attributesForced.push({name:_t,value:qe}),ht.forcedValue=qe),"<"===me&&(ht.validValues=co(qe,"?"))),la.test(_t)?(Q.attributePatterns=Q.attributePatterns||[],ht.pattern=k(_t),Q.attributePatterns.push(ht)):(Zt[_t]||te.push(_t),Zt[_t]=ht)}ee||"@"!==ct||(ee=Zt,tn=te),$e&&(Q.outputName=ct,n[$e]=Q),la.test(ct)?(Q.pattern=k(ct),o.push(Q)):n[ct]=Q}}},B=A=>{o=[],H(Ke(n),R=>{delete n[R]}),D(A),le(d,(R,U)=>{r[U]=R.children})},M=A=>{const R=/^(~)?(.+)$/;A&&(Qn.text_block_elements=Qn.block_elements=null,le(Jt(A,","),U=>{const $=R.exec(U),j="~"===$[1],W=j?"span":"div",Q=$[2];if(r[Q]=r[W],s[Q]=W,v[Q.toUpperCase()]={},v[Q]={},j||(x[Q.toUpperCase()]={},x[Q]={}),!n[Q]){let ht=n[W];ht=sd({},ht),delete ht.removeEmptyAttrs,delete ht.removeEmpty,n[Q]=ht}le(r,(ht,K)=>{ht[W]&&(r[K]=ht=sd({},r[K]),ht[Q]=ht[W])})}))},O=A=>{const R=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;Qn[l]=null,A&&le(Jt(A,","),U=>{const $=R.exec(U);let j,W;$&&(W=$[1],j=W?r[$[2]]:r[$[2]]={"#comment":{}},j=r[$[2]],le(Jt($[3],"|"),Q=>{"-"===W?delete j[Q]:j[Q]={}}))})},P=A=>{let R,U=n[A];if(U)return U;for(R=o.length;R--;)if(U=o[R],U.pattern.test(A))return U};t.valid_elements?B(t.valid_elements):(le(d,(A,R)=>{n[R]={attributes:A.attributes,attributesOrder:A.attributesOrder},r[R]=A.children}),le(Jt("strong/b em/i"),A=>{const R=Jt(A,"/");n[R[1]].outputName=R[0]}),le(S,(A,R)=>{n[R]&&(t.padd_empty_block_inline_children&&(n[R].paddInEmptyBlock=!0),n[R].removeEmpty=!0)}),le(Jt("ol ul blockquote a table tbody"),A=>{n[A]&&(n[A].removeEmpty=!0)}),le(Jt("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),A=>{n[A].paddEmpty=!0}),le(Jt("span"),A=>{n[A].removeEmptyAttrs=!0})),M(t.custom_elements),O(t.valid_children),D(t.extended_valid_elements),O("+ol[ul|ol],+ul[ul|ol]"),le({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(A,R)=>{n[R]&&(n[R].parentsRequired=Jt(A))}),t.invalid_elements&&le(mg(t.invalid_elements),A=>{n[A]&&delete n[A]}),P("span")||D("span[!data-mce-type|*]");const L=q(c),F=q(u),V=q(f),nt=q(b),tt=q(x),it=q(w),bt=q(S),St=q(Object.seal(p)),et=q(g),ft=q(v),ut=q(y),vt=q(m),E=q(Object.seal(a)),_=q(s);return{type:l,children:r,elements:n,getValidStyles:L,getValidClasses:V,getBlockElements:tt,getInvalidStyles:F,getVoidElements:St,getTextBlockElements:it,getTextInlineElements:bt,getBoolAttrs:nt,getElementRule:P,getSelfClosingElements:et,getNonEmptyElements:ft,getMoveCaretBeforeOnEnterElements:ut,getWhitespaceElements:vt,getSpecialElements:E,isValidChild:(A,R)=>{const U=r[A.toLowerCase()];return!(!U||!U[R.toLowerCase()])},isValid:(A,R)=>{let U,$;const j=P(A);if(j){if(!R||j.attributes[R])return!0;if(U=j.attributePatterns,U)for($=U.length;$--;)if(U[$].pattern.test(R))return!0}return!1},getCustomElements:_,addValidElements:D,setValidElements:B,addCustomElements:M,addValidChildren:O}},id=(t,e)=>{const n=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,r=/\s*([^:]+):\s*([^;]+);?/g,o=/\s+$/;let s;const a={};let i,l;t=t||{},e&&(i=e.getValidStyles(),l=e.getInvalidStyles());const d="\\\" \\' \\; \\: ; : \ufeff".split(" ");for(s=0;s<d.length;s++)a[d[s]]="\ufeff"+s,a["\ufeff"+s]=d[s];const c={parse:u=>{const f={};let m,g,p,b;const h=t.url_converter,v=t.url_converter_scope||c,y=(L,F,V)=>{const nt=f[L+"-top"+F];if(!nt)return;const tt=f[L+"-right"+F];if(!tt)return;const it=f[L+"-bottom"+F];if(!it)return;const bt=f[L+"-left"+F];if(!bt)return;const St=[nt,tt,it,bt];for(s=St.length-1;s--&&St[s]===St[s+1];);s>-1&&V||(f[L+F]=-1===s?St[0]:St.join(" "),delete f[L+"-top"+F],delete f[L+"-right"+F],delete f[L+"-bottom"+F],delete f[L+"-left"+F])},w=L=>{let F,V=f[L];if(V){for(V=V.split(" "),F=V.length;F--;)if(V[F]!==V[0])return!1;return f[L]=V[0],!0}},x=L=>(b=!0,a[L]),S=(L,F)=>(b&&(L=L.replace(/\uFEFF[0-9]/g,V=>a[V])),F||(L=L.replace(/\\([\'\";:])/g,"$1")),L),k=L=>String.fromCharCode(parseInt(L.slice(1),16)),D=L=>L.replace(/\\[0-9a-f]+/gi,k),B=(L,F,V,nt,tt,it)=>{if(tt=tt||it)return"'"+(tt=S(tt)).replace(/\'/g,"\\'")+"'";if(F=S(F||V||nt),!t.allow_script_urls){const bt=F.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(bt)||!t.allow_svg_data_urls&&/^data:image\/svg/i.test(bt))return""}return h&&(F=h.call(v,F,"style")),"url('"+F.replace(/\'/g,"\\'")+"')"};if(u){for(u=(u=u.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,x).replace(/\"[^\"]+\"|\'[^\']+\'/g,L=>L.replace(/[;:]/g,x));m=r.exec(u);)if(r.lastIndex=m.index+m[0].length,g=m[1].replace(o,"").toLowerCase(),p=m[2].replace(o,""),g&&p){if(g=D(g),p=D(p),-1!==g.indexOf("\ufeff")||-1!==g.indexOf('"')||!t.allow_script_urls&&("behavior"===g||/expression\s*\(|\/\*|\*\//.test(p)))continue;"font-weight"===g&&"700"===p?p="bold":"color"!==g&&"background-color"!==g||(p=p.toLowerCase()),p=p.replace(n,B),f[g]=b?S(p,!0):p}y("border","",!0),y("border","-width"),y("border","-color"),y("border","-style"),y("padding",""),y("margin",""),O="border-style",P="border-color",w(M="border-width")&&w(O)&&w(P)&&(f.border=f[M]+" "+f[O]+" "+f[P],delete f[M],delete f[O],delete f[P]),"medium none"===f.border&&delete f.border,"none"===f["border-image"]&&delete f["border-image"]}var M,O,P;return f},serialize:(u,f)=>{let m="";const g=p=>{let b;const h=i[p];if(h)for(let v=0,y=h.length;v<y;v++)b=u[p=h[v]],b&&(m+=(m.length>0?" ":"")+p+": "+b+";")};return f&&i?(g("*"),g(f)):At(u,(p,b)=>{!p||l&&!((h,v)=>{let y=l["*"];return!(y&&y[h]||(y=l[v],y&&y[h]))})(b,f)||(m+=(m.length>0?" ":"")+b+": "+p+";")}),m}};return c},dx={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},pg=(t,e)=>{const n=null!=e?e:{};for(const r in t)gt(dx,r)||(n[r]=t[r]);return lt(n.composedPath)&&(n.composedPath=()=>t.composedPath()),n},ld=(t,e,n,r)=>{var o;const s=pg(e,r);return s.type=t,xe(s.target)&&(s.target=null!==(o=s.srcElement)&&void 0!==o?o:n),(xe((a=e).preventDefault)||(i=a)instanceof Event||xt(i.initEvent))&&(s.preventDefault=()=>{s.defaultPrevented=!0,s.isDefaultPrevented=Vt,xt(e.preventDefault)&&e.preventDefault()},s.stopPropagation=()=>{s.cancelBubble=!0,s.isPropagationStopped=Vt,xt(e.stopPropagation)&&e.stopPropagation()},s.stopImmediatePropagation=()=>{s.isImmediatePropagationStopped=Vt,s.stopPropagation()},(a=>a.isDefaultPrevented===Vt||a.isDefaultPrevented===Dt)(s)||(s.isDefaultPrevented=!0===s.defaultPrevented?Vt:Dt,s.isPropagationStopped=!0===s.cancelBubble?Vt:Dt,s.isImmediatePropagationStopped=Dt)),s;var a,i},cx=/^(?:mouse|contextmenu)|click/,dd=(t,e,n,r)=>{t.addEventListener?t.addEventListener(e,n,r||!1):t.attachEvent&&t.attachEvent("on"+e,n)},Pa=(t,e,n,r)=>{t.removeEventListener?t.removeEventListener(e,n,r||!1):t.detachEvent&&t.detachEvent("on"+e,n)},uo=(t,e)=>{const n=ld(t.type,t,document,e);if(lt(r=t)&&cx.test(r.type)&&we(t.pageX)&&!we(t.clientX)){const r=n.target.ownerDocument||document,o=r.documentElement,s=r.body,a=n;a.pageX=t.clientX+(o&&o.scrollLeft||s&&s.scrollLeft||0)-(o&&o.clientLeft||s&&s.clientLeft||0),a.pageY=t.clientY+(o&&o.scrollTop||s&&s.scrollTop||0)-(o&&o.clientTop||s&&s.clientTop||0)}var r;return n},ux=(t,e,n)=>{const r=t.document,o={type:"ready"};if(n.domLoaded)return void e(o);const s=()=>{Pa(t,"DOMContentLoaded",s),Pa(t,"load",s),n.domLoaded||(n.domLoaded=!0,e(o)),t=null};"complete"===r.readyState||"interactive"===r.readyState&&r.body?s():dd(t,"DOMContentLoaded",s),n.domLoaded||dd(t,"load",s)};class _r{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando="mce-data-"+(+new Date).toString(32),this.hasMouseEnterLeave="onmouseenter"in document.documentElement,this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(e,n,r,o){const s=this;let a,i,l,d,c,u,f;const m=window,g=b=>{s.executeHandlers(uo(b||m.event),a)};if(!e||3===e.nodeType||8===e.nodeType)return;e[s.expando]?a=e[s.expando]:(a=s.count++,e[s.expando]=a,s.events[a]={}),o=o||e;const p=n.split(" ");for(l=p.length;l--;)d=p[l],u=g,c=f=!1,"DOMContentLoaded"===d&&(d="ready"),s.domLoaded&&"ready"===d&&"complete"===e.readyState?r.call(o,uo({type:d})):(s.hasMouseEnterLeave||(c=s.mouseEnterLeave[d],c&&(u=b=>{const h=b.currentTarget;let v=b.relatedTarget;if(v&&h.contains)v=h.contains(v);else for(;v&&v!==h;)v=v.parentNode;v||((b=uo(b||m.event)).type="mouseout"===b.type?"mouseleave":"mouseenter",b.target=h,s.executeHandlers(b,a))})),s.hasFocusIn||"focusin"!==d&&"focusout"!==d||(f=!0,c="focusin"===d?"focus":"blur",u=b=>{(b=uo(b||m.event)).type="focus"===b.type?"focusin":"focusout",s.executeHandlers(b,a)}),i=s.events[a][d],i?"ready"===d&&s.domLoaded?r(uo({type:d})):i.push({func:r,scope:o}):(s.events[a][d]=i=[{func:r,scope:o}],i.fakeName=c,i.capture=f,i.nativeHandler=u,"ready"===d?ux(e,u,s):dd(e,c||d,u,f)));return e=i=null,r}unbind(e,n,r){let o,s,a,i,l;if(!e||3===e.nodeType||8===e.nodeType)return this;const d=e[this.expando];if(d){if(l=this.events[d],n){const c=n.split(" ");for(s=c.length;s--;)if(i=c[s],o=l[i],o){if(r)for(a=o.length;a--;)if(o[a].func===r){const u=o.nativeHandler,f=o.fakeName,m=o.capture;o=o.slice(0,a).concat(o.slice(a+1)),o.nativeHandler=u,o.fakeName=f,o.capture=m,l[i]=o}r&&0!==o.length||(delete l[i],Pa(e,o.fakeName||i,o.nativeHandler,o.capture))}}else At(l,(c,u)=>{Pa(e,c.fakeName||u,c.nativeHandler,c.capture)}),l={};for(i in l)if(gt(l,i))return this;delete this.events[d];try{delete e[this.expando]}catch(c){e[this.expando]=null}}return this}fire(e,n,r){return this.dispatch(e,n,r)}dispatch(e,n,r){let o;if(!e||3===e.nodeType||8===e.nodeType)return this;const s=uo({type:n,target:e},r);do{o=e[this.expando],o&&this.executeHandlers(s,o),e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow}while(e&&!s.isPropagationStopped());return this}clean(e){let n,r;if(!e||3===e.nodeType||8===e.nodeType)return this;if(e[this.expando]&&this.unbind(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName)for(this.unbind(e),r=e.getElementsByTagName("*"),n=r.length;n--;)(e=r[n])[this.expando]&&this.unbind(e);return this}destroy(){this.events={}}cancel(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1}executeHandlers(e,n){const r=this.events[n],o=r&&r[e.type];if(o)for(let s=0,a=o.length;s<a;s++){const i=o[s];if(i&&!1===i.func.call(i.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return}}}_r.Event=new _r;const cd=z.each,mx=z.grep,ud="data-mce-style",fs=(t,e,n)=>{xe(n)||""===n?oe(t,e):re(t,e,n)},mo=(t,e)=>{let n,r,o=0;if(t)for(n=t.nodeType,t=t.previousSibling;t;t=t.previousSibling)r=t.nodeType,(!e||3!==r||r!==n&&t.nodeValue.length)&&(o++,n=r);return o},gx=z.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),hg=t=>t.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),Et=(t,e={})=>{const n={},r=window,o={};let s=0;const a=Qf.forElement(N(t),{contentCssCors:e.contentCssCors,referrerPolicy:e.referrerPolicy}),i=[],l=e.schema?e.schema:Jn({}),d=id({url_converter:e.url_converter,url_converter_scope:e.url_converter_scope},e.schema),c=e.ownEvents?new _r:_r.Event,u=l.getBlockElements(),f=E=>E&&t&&st(E)?t.getElementById(E):E,m=E=>{const _=f(E);return lt(_)?N(_):null},g=(E,_,A)=>{let R;const U=m(E);if(lt(U)&&Ge(U)){const $=vt[_];R=$&&$.get?$.get(U.dom,_):Me(U,_)}return lt(R)?R:null!=A?A:""},p=E=>{const _=f(E);return xe(_)?[]:_.attributes},b=(E,_,A)=>{B(E,R=>{if(rt(R)){const U=N(R);""===A&&(A=null);const $=Me(U,_),j=vt[_];j&&j.set?j.set(U.dom,A,_):fs(U,_,A),$!==A&&e.onSetAttrib&&e.onSetAttrib({attrElm:U,attrName:_,attrValue:A})}})},h=()=>e.root_element||t.body,v=(E,_)=>((A,R,U)=>{let $=0,j=0;const W=A.ownerDocument;if(U=U||A,R){if(U===A&&R.getBoundingClientRect&&"static"===bn(N(A),"position")){const ht=R.getBoundingClientRect();return $=ht.left+(W.documentElement.scrollLeft||A.scrollLeft)-W.documentElement.clientLeft,j=ht.top+(W.documentElement.scrollTop||A.scrollTop)-W.documentElement.clientTop,{x:$,y:j}}let Q=R;for(;Q&&Q!==U&&Q.nodeType&&!Gf(Q,U);)$+=Q.offsetLeft||0,j+=Q.offsetTop||0,Q=Q.offsetParent;for(Q=R.parentNode;Q&&Q!==U&&Q.nodeType&&!Gf(Q,U);)$-=Q.scrollLeft||0,j-=Q.scrollTop||0,Q=Q.parentNode;j+=(ht=N(R),Uw.isFirefox()&&"table"===Tt(ht)?Kf(se(ht)).filter(K=>"caption"===Tt(K)).bind(K=>Kf(_f(K)).map(ct=>ct.dom.offsetTop<=K.dom.offsetTop?-K.dom.offsetHeight:0)).getOr(0):0)}var ht;return{x:$,y:j}})(t.body,f(E),_),y=(E,_,A)=>{const R=($,j)=>st($)?$:mn($)?gt(gx,j)?$+"":$+"px":Xo($,R),U=($,j,W)=>{const Q=hg(j);xe(W)||""===W?Mf($,Q):Df($,Q,R(W,Q))};B(E,$=>{const j=N($);st(_)?U(j,_,A):At(_,(W,Q)=>{U(j,Q,W)}),e.update_styles&&((t,e)=>{const n=Me(e,"style"),r=t.serialize(t.parse(n),Tt(e));fs(e,ud,r)})(d,j)})},w=(E,_,A)=>{const R=f(E);if(!xe(R)&&rt(R))return A?bn(N(R),hg(_)):("float"===(_=_.replace(/-(\D)/g,(U,$)=>$.toUpperCase()))&&(_="cssFloat"),R.style?R.style[_]:void 0)},x=E=>{let _,A;const R=f(E);return _=w(R,"width"),A=w(R,"height"),-1===_.indexOf("px")&&(_=0),-1===A.indexOf("px")&&(A=0),{w:parseInt(_,10)||R.offsetWidth||R.clientWidth,h:parseInt(A,10)||R.offsetHeight||R.clientHeight}},S=(E,_)=>{if(!E)return!1;const A=Kt(E)?E:[E];return It(A,R=>hn(N(R),_))},k=(E,_,A,R)=>{const U=[];let $,j=f(E);for(R=void 0===R,A=A||("BODY"!==h().nodeName?h().parentNode:null),st(_)&&($=_,_="*"===_?rt:W=>S(W,$));j&&!(j===A||xe(j.nodeType)||Gl(j)||Yl(j));){if(!_||_(j)){if(!R)return[j];U.push(j)}j=j.parentNode}return R?U:null},D=(E,_,A)=>{let R=_;if(E)for(st(_)&&(R=U=>S(U,_)),E=E[A];E;E=E[A])if(xt(R)&&R(E))return E;return null},B=function(E,_,A){const R=null!=A?A:this,U=st(E)?f(E):E;if(!U)return!1;if(Kt(U)&&(U.length||0===U.length)){const $=[];return cd(U,(j,W)=>{j&&$.push(_.call(R,st(j)?f(j):j,W))}),$}return _.call(R,U)},M=(E,_)=>{B(E,A=>{At(_,(R,U)=>{b(A,U,R)})})},O=(E,_)=>{B(E,A=>{const R=N(A);Hl(R,_)})},P=(E,_,A,R,U)=>B(E,$=>{const j=st(_)?t.createElement(_):_;return lt(A)&&M(j,A),R&&(!st(R)&&R.nodeType?j.appendChild(R):st(R)&&O(j,R)),U?j:$.appendChild(j)}),L=(E,_,A)=>P(t.createElement(E),E,_,A,!0),F=Xn.encodeAllRaw,V=(E,_)=>B(E,A=>{const R=N(A);return _&&H(se(R),U=>{Le(U)&&0===U.dom.length?Mt(U):Xe(R,U)}),Mt(R),R.dom}),nt=(E,_,A)=>{B(E,R=>{if(rt(R)){const U=N(R),$=_.split(" ");H($,j=>{var W,Q,K,ct;lt(A)?(A?ns:ba)(U,j):(Q=j,es(W=U)?W.dom.classList.toggle(Q):(ct=Q,Ot(bf(K=W),ct)?yf(K,ct):vf(K,ct)),Cf(W))})}})},tt=(E,_,A)=>B(_,R=>(Kt(R)&&(E=E.cloneNode(!0)),A&&cd(mx(R.childNodes),U=>{E.appendChild(U)}),R.parentNode.replaceChild(E,R))),it=E=>{if(rt(E)){const _="a"===E.nodeName.toLowerCase()&&!g(E,"href")&&g(E,"id");if(g(E,"name")||g(E,"data-mce-bookmark")||_)return!0}return!1},bt=()=>t.createRange(),St=(E,_,A,R)=>{if(Kt(E)){let U=E.length;const $=[];for(;U--;)$[U]=St(E[U],_,A,R);return $}return!e.collect||E!==t&&E!==r||i.push([E,_,A,R]),c.bind(E,_,A,R||ut)},et=(E,_,A)=>{if(Kt(E)){let R=E.length;const U=[];for(;R--;)U[R]=et(E[R],_,A);return U}if(i.length>0&&(E===t||E===r)){let R=i.length;for(;R--;){const U=i[R];E!==U[0]||_&&_!==U[1]||A&&A!==U[2]||c.unbind(U[0],U[1],U[2])}}return c.unbind(E,_,A)},ft=E=>{if(E&&rt(E)){const _=E.getAttribute("data-mce-contenteditable");return _&&"inherit"!==_?_:"inherit"!==E.contentEditable?E.contentEditable:null}return null},ut={doc:t,settings:e,win:r,files:o,stdMode:!0,boxModel:!0,styleSheetLoader:a,boundEvents:i,styles:d,schema:l,events:c,isBlock:E=>st(E)?gt(u,E):rt(E)&&gt(u,E.nodeName),root:null,clone:(E,_)=>E.cloneNode(_),getRoot:h,getViewPort:E=>{const _=Hf(E);return{x:_.x,y:_.y,w:_.width,h:_.height}},getRect:E=>{const _=f(E),A=v(_),R=x(_);return{x:A.x,y:A.y,w:R.w,h:R.h}},getSize:x,getParent:(E,_,A)=>{const R=k(E,_,A,!1);return R&&R.length>0?R[0]:null},getParents:k,get:f,getNext:(E,_)=>D(E,_,"nextSibling"),getPrev:(E,_)=>D(E,_,"previousSibling"),select:(E,_)=>{var A,R;const U=null!==(R=null!==(A=f(_))&&void 0!==A?A:e.root_element)&&void 0!==R?R:t;return ke(U.querySelectorAll(E))},is:S,add:P,create:L,createHTML:(E,_,A="")=>{let R,U="";for(R in U+="<"+E,_)Xr(_,R)&&(U+=" "+R+'="'+F(_[R])+'"');return pa(A)&&gt(l.getVoidElements(),E)?U+" />":U+">"+A+"</"+E+">"},createFragment:E=>{let _;const A=t.createElement("div"),R=t.createDocumentFragment();for(R.appendChild(A),E&&(A.innerHTML=E);_=A.firstChild;)R.appendChild(_);return R.removeChild(A),R},remove:V,setStyle:y,getStyle:w,setStyles:(E,_)=>{y(E,_)},removeAllAttribs:E=>B(E,_=>{const A=_.attributes;for(let R=A.length-1;R>=0;R--)_.removeAttributeNode(A.item(R))}),setAttrib:b,setAttribs:M,getAttrib:g,getPos:v,parseStyle:E=>d.parse(E),serializeStyle:(E,_)=>d.serialize(E,_),addStyle:E=>{let _,A;if(ut!==Et.DOM&&t===document){if(n[E])return;n[E]=!0}A=t.getElementById("mceDefaultStyles"),A||(A=t.createElement("style"),A.id="mceDefaultStyles",A.type="text/css",_=t.getElementsByTagName("head")[0],_.firstChild?_.insertBefore(A,_.firstChild):_.appendChild(A)),A.styleSheet?A.styleSheet.cssText+=E:A.appendChild(t.createTextNode(E))},loadCSS:E=>{E||(E=""),H(E.split(","),_=>{o[_]=!0,a.load(_).catch(pt)})},addClass:(E,_)=>{nt(E,_,!0)},removeClass:(E,_)=>{nt(E,_,!1)},hasClass:(E,_)=>{const A=m(E),R=_.split(" ");return Kr(R,U=>zl(A,U))},toggleClass:nt,show:E=>{B(E,_=>Mf(N(_),"display"))},hide:E=>{B(E,_=>Df(N(_),"display","none"))},isHidden:E=>{const _=m(E);return Zr(Ca(_,"display"),"none")},uniqueId:E=>(E||"mce_")+s++,setHTML:O,getOuterHTML:E=>{const _=m(E);return rt(_.dom)?_.dom.outerHTML:(A=>{const R=Ut("div"),U=N(A.dom.cloneNode(!0));return Ht(R,U),Ff(R)})(_)},setOuterHTML:(E,_)=>{B(E,A=>{rt(A)&&(A.outerHTML=_)})},decode:Xn.decode,encode:F,insertAfter:(E,_)=>{const A=f(_);return B(E,R=>{const U=A.parentNode,$=A.nextSibling;return $?U.insertBefore(R,$):U.appendChild(R),R})},replace:tt,rename:(E,_)=>{let A;return E.nodeName!==_.toUpperCase()&&(A=L(_),cd(p(E),R=>{b(A,R.nodeName,g(E,R.nodeName))}),tt(A,E,!0)),A||E},findCommonAncestor:(E,_)=>{let A,R=E;for(;R;){for(A=_;A&&R!==A;)A=A.parentNode;if(R===A)break;R=R.parentNode}return!R&&E.ownerDocument?E.ownerDocument.documentElement:R},run:B,getAttribs:p,isEmpty:(E,_)=>{let A,R,U=0;if(it(E))return!1;if(E=E.firstChild){const $=new zt(E,E.parentNode),j=l?l.getWhitespaceElements():{};_=_||(l?l.getNonEmptyElements():null);do{if(A=E.nodeType,rt(E)){const W=E.getAttribute("data-mce-bogus");if(W){E=$.next("all"===W);continue}if(R=E.nodeName.toLowerCase(),_&&_[R]){if("br"===R){U++,E=$.next();continue}return!1}if(it(E))return!1}if(8===A||3===A&&!Sr(E.nodeValue)||3===A&&E.parentNode&&j[E.parentNode.nodeName]&&Sr(E.nodeValue))return!1;E=$.next()}while(E)}return U<=1},createRng:bt,nodeIndex:mo,split:(E,_,A)=>{let R,U,$,j=bt();if(E&&_)return j.setStart(E.parentNode,mo(E)),j.setEnd(_.parentNode,mo(_)),R=j.extractContents(),j=bt(),j.setStart(_.parentNode,mo(_)+1),j.setEnd(E.parentNode,mo(E)+1),U=j.extractContents(),$=E.parentNode,$.insertBefore(nd(ut,R),E),$.insertBefore(A||_,E),$.insertBefore(nd(ut,U),E),V(E),A||_},bind:St,unbind:et,fire:(E,_,A)=>c.dispatch(E,_,A),dispatch:(E,_,A)=>c.dispatch(E,_,A),getContentEditable:ft,getContentEditableParent:E=>{const _=h();let A=null;for(;E&&E!==_&&(A=ft(E),null===A);E=E.parentNode);return A},destroy:()=>{if(i.length>0){let E=i.length;for(;E--;){const _=i[E];c.unbind(_[0],_[1],_[2])}}At(o,(E,_)=>{a.unload(_),delete o[_]})},isChildOf:(E,_)=>E===_||_.contains(E),dumpRng:E=>"startContainer: "+E.startContainer.nodeName+", startOffset: "+E.startOffset+", endContainer: "+E.endContainer.nodeName+", endOffset: "+E.endOffset},vt=((E,_,A)=>{const R=_.keep_values,$={style:{set:(j,W)=>{const Q=N(j);Te(W)?ya(Q,W):(R&&fs(Q,ud,W),oe(Q,"style"),st(W)&&ya(Q,E.parse(W)))},get:j=>{const W=N(j),Q=Me(W,ud)||Me(W,"style");return E.serialize(E.parse(Q),Tt(W))}}};return R&&($.href=$.src={set:(j,W,Q)=>{const ht=N(j);xt(_.url_converter)&&lt(W)&&(W=_.url_converter.call(_.url_converter_scope||A(),W,Q,j[0])),fs(ht,"data-mce-"+Q,W),fs(ht,Q,W)},get:(j,W)=>{const Q=N(j);return Me(Q,"data-mce-"+W)||Me(Q,W)}}),$})(d,e,q(ut));return ut};Et.DOM=Et(document),Et.nodeIndex=mo;const px=Et.DOM;class In{constructor(e={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=e}_setReferrerPolicy(e){this.settings.referrerPolicy=e}loadScript(e){return new Promise((n,r)=>{const o=px;let s;const a=()=>{o.remove(i),s&&(s.onerror=s.onload=s=null)},i=o.uniqueId();s=document.createElement("script"),s.id=i,s.type="text/javascript",s.src=z._addCacheSuffix(e),this.settings.referrerPolicy&&o.setAttrib(s,"referrerpolicy",this.settings.referrerPolicy),s.onload=()=>{a(),n()},s.onerror=()=>{a(),r("Failed to load script: "+e)},(document.getElementsByTagName("head")[0]||document.body).appendChild(s)})}isDone(e){return 2===this.states[e]}markDone(e){this.states[e]=2}add(e){const n=this;return n.queue.push(e),void 0===n.states[e]&&(n.states[e]=0),new Promise((r,o)=>{n.scriptLoadedCallbacks[e]||(n.scriptLoadedCallbacks[e]=[]),n.scriptLoadedCallbacks[e].push({resolve:r,reject:o})})}load(e){return this.add(e)}remove(e){delete this.states[e],delete this.scriptLoadedCallbacks[e]}loadQueue(){const e=this.queue;return this.queue=[],this.loadScripts(e)}loadScripts(e){const n=this,r=(l,d)=>{Nt(n.scriptLoadedCallbacks,d).each(c=>{H(c,u=>u[l](d))}),delete n.scriptLoadedCallbacks[d]},o=l=>{const d=dt(l,c=>"rejected"===c.status);return d.length>0?Promise.reject(Dn(d,({reason:c})=>Kt(c)?c:[c])):Promise.resolve()},s=l=>Promise.allSettled(yt(l,d=>2===n.states[d]?(r("resolve",d),Promise.resolve()):3===n.states[d]?(r("reject",d),Promise.reject(d)):(n.states[d]=1,n.loadScript(d).then(()=>{n.states[d]=2,r("resolve",d);const c=n.queue;if(c.length>0)return n.queue=[],s(c).then(o)},()=>(n.states[d]=3,r("reject",d),Promise.reject(d)))))),a=l=>(n.loading=!0,s(l).then(d=>{n.loading=!1;const c=n.queueLoadedCallbacks.shift();return C.from(c).each(qo),o(d)})),i=zm(e);return n.loading?new Promise((l,d)=>{n.queueLoadedCallbacks.push(()=>a(i).then(l,d))}):a(i)}}In.ScriptLoader=new In;const Xt=t=>{let e=t;return{get:()=>e,set:n=>{e=n}}},gs={},md=Xt("en"),bg=()=>Nt(gs,md.get()),nn={getData:()=>Xo(gs,t=>at({},t)),setCode:t=>{t&&md.set(t)},getCode:()=>md.get(),add:(t,e)=>{let n=gs[t];n||(gs[t]=n={}),At(e,(r,o)=>{n[o.toLowerCase()]=r})},translate:t=>{const e=bg().getOr({}),n=i=>xt(i)?Object.prototype.toString.call(i):r(i)?"":""+i,r=i=>""===i||null==i,o=i=>{const l=n(i);return Nt(e,l.toLowerCase()).map(n).getOr(l)},s=i=>i.replace(/{context:\w+}$/,"");if(r(t))return"";if(Te(a=t)&&gt(a,"raw"))return n(t.raw);var a,i;if(Kt(i=t)&&i.length>1){const i=t.slice(1);return s(o(t[0]).replace(/\{([0-9]+)\}/g,(l,d)=>gt(i,d)?n(i[d]):l))}return s(o(t))},isRtl:()=>bg().bind(t=>Nt(t,"_dir")).exists(t=>"rtl"===t),hasCode:t=>gt(gs,t)},ce=()=>{const t=[],e={},n={},r=[],o=(l,d)=>{const c=dt(r,u=>u.name===l&&u.state===d);H(c,u=>u.resolve())},s=l=>gt(e,l),a=(l,d)=>{const c=nn.getCode();!c||d&&-1===(","+(d||"")+",").indexOf(","+c+",")||In.ScriptLoader.add(e[l]+"/langs/"+c+".js")},i=(l,d="added")=>"added"===d&&gt(n,l)||"loaded"===d&&s(l)?Promise.resolve():new Promise(c=>{r.push({name:l,state:d,resolve:c})});return{items:t,urls:e,lookup:n,get:l=>{if(n[l])return n[l].instance},requireLangPack:(l,d)=>{!1!==ce.languageLoad&&(s(l)?a(l,d):i(l,"loaded").then(()=>a(l,d)))},add:(l,d)=>(t.push(d),n[l]={instance:d},o(l,"added"),d),remove:l=>{delete e[l],delete n[l]},createUrl:(l,d)=>st(d)?st(l)?{prefix:"",resource:d,suffix:""}:{prefix:l.prefix,resource:d,suffix:l.suffix}:d,load:(l,d)=>{if(e[l])return Promise.resolve();let c=st(d)?d:d.prefix+d.resource+d.suffix;0!==c.indexOf("/")&&-1===c.indexOf("://")&&(c=ce.baseURL+"/"+c),e[l]=c.substring(0,c.lastIndexOf("/"));const u=()=>(o(l,"loaded"),Promise.resolve());return n[l]?u():In.ScriptLoader.add(c).then(u)},waitFor:i}};ce.languageLoad=!0,ce.baseURL="",ce.PluginManager=ce(),ce.ThemeManager=ce(),ce.ModelManager=ce();const Zn=()=>{const t=(e=>{const n=Xt(C.none()),r=()=>n.get().each(e);return{clear:()=>{r(),n.set(C.none())},isSet:()=>n.get().isSome(),get:()=>n.get(),set:o=>{r(),n.set(C.some(o))}}})(pt);return Rt(at({},t),{on:e=>t.get().each(e)})},La=(t,e)=>{let n=null;return{cancel:()=>{$o(n)||(clearTimeout(n),n=null)},throttle:(...r)=>{$o(n)&&(n=setTimeout(()=>{n=null,t.apply(null,r)},e))}}},fd=(t,e)=>{let n=null;const r=()=>{$o(n)||(clearTimeout(n),n=null)};return{cancel:r,throttle:(...o)=>{r(),n=setTimeout(()=>{n=null,t.apply(null,o)},e)}}},vg=(t,e)=>{let n=[];return H(se(t),r=>{e(r)&&(n=n.concat([r])),n=n.concat(vg(r,e))}),n},Ee=(t,e)=>((n,r)=>{const o=void 0===r?document:r.dom;return xf(o)?[]:yt(o.querySelectorAll(n),N)})(e,t),ps=q("mce-annotation"),Nr=q("data-mce-annotation"),fo=q("data-mce-annotation-uid"),hs=q("data-mce-annotation-active"),bs=q("data-mce-annotation-classes"),vs=q("data-mce-annotation-attrs"),yg=t=>e=>kt(e,t),Cg=(t,e)=>{const n=t.selection.getRng(),r=N(n.startContainer),o=N(t.getBody()),s=e.fold(()=>"."+ps(),d=>`[${Nr()}="${d}"]`),a=va(r,n.startOffset).getOr(r),i=kr(a,s,yg(o)),l=(d,c)=>ts(d,c)?C.some(Me(d,c)):C.none();return i.bind(d=>l(d,`${fo()}`).bind(c=>l(d,`${Nr()}`).map(u=>{const f=xg(t,c);return{uid:c,name:u,elements:f}})))},wg=(t,e)=>ts(t,"data-mce-bogus")||Jf(t,'[data-mce-bogus="all"]',yg(e)),xg=(t,e)=>{const n=N(t.getBody()),r=Ee(n,`[${fo()}="${e}"]`);return dt(r,o=>!wg(o,n))},kg=(t,e)=>{const n=N(t.getBody()),r=Ee(n,`[${Nr()}="${e}"]`),o={};return H(r,s=>{if(!wg(s,n)){const a=Me(s,fo()),i=Nt(o,a).getOr([]);o[a]=i.concat([s])}}),o};let Sg=0;const Eg=t=>{const e=(new Date).getTime(),n=Math.floor(1e9*Math.random());return Sg++,t+"_"+n+Sg+String(e)},_g=(t,e)=>N(t.dom.cloneNode(e)),go=t=>_g(t,!1),Ng=t=>_g(t,!0),Rg=(t,e,n=Dt)=>{const r=new zt(t,e),o=s=>{let a;do{a=r[s]()}while(a&&!G(a)&&!n(a));return C.from(a).filter(G)};return{current:()=>C.from(r.current()).filter(G),next:()=>o("next"),prev:()=>o("prev"),prev2:()=>o("prev2")}},Rr=(t,e)=>{const n=e||(o=>t.isBlock(o)||Ft(o)||Bt(o)),r=(o,s,a,i)=>{if(G(o)){const l=i(o,s,o.data);if(-1!==l)return C.some({container:o,offset:l})}return a().bind(l=>r(l.container,l.offset,a,i))};return{backwards:(o,s,a,i)=>{const l=Rg(o,i,n);return r(o,s,()=>l.prev().map(d=>({container:d,offset:d.length})),a).getOrNull()},forwards:(o,s,a,i)=>{const l=Rg(o,i,n);return r(o,s,()=>l.next().map(d=>({container:d,offset:0})),a).getOrNull()}}},po=Math.round,Ar=t=>t?{left:po(t.left),top:po(t.top),bottom:po(t.bottom),right:po(t.right),width:po(t.width),height:po(t.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},Ag=(t,e)=>(t=Ar(t),e||(t.left=t.left+t.width),t.right=t.left,t.width=0,t),Og=(t,e,n)=>t>=0&&t<=Math.min(e.height,n.height)/2,ys=(t,e)=>{const n=Math.min(e.height/2,t.height/2);return t.bottom-n<e.top||!(t.top>e.bottom)&&Og(e.top-t.bottom,t,e)},Cs=(t,e)=>t.top>e.bottom||!(t.bottom<e.top)&&Og(e.bottom-t.top,t,e),Tg=(t,e,n)=>{const r=Math.max(Math.min(e,t.left+t.width),t.left),o=Math.max(Math.min(n,t.top+t.height),t.top);return Math.sqrt((e-r)*(e-r)+(n-o)*(n-o))},Ma=t=>{const e=t.startContainer,n=t.startOffset;return e===t.endContainer&&e.hasChildNodes()&&t.endOffset===n+1?e.childNodes[n]:null},tr=(t,e)=>{if(rt(t)&&t.hasChildNodes()){const n=t.childNodes;return n[(a=n.length-1,Math.min(Math.max(e,0),a))]}var a;return t},hx=new RegExp("[\u0300-\u036f\u0483-\u0487\u0488-\u0489\u0591-\u05bd\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05c7\u0610-\u061a\u064b-\u065f\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7-\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08e3-\u0902\u093a\u093c\u0941-\u0948\u094d\u0951-\u0957\u0962-\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2-\u09e3\u0a01-\u0a02\u0a3c\u0a41-\u0a42\u0a47-\u0a48\u0a4b-\u0a4d\u0a51\u0a70-\u0a71\u0a75\u0a81-\u0a82\u0abc\u0ac1-\u0ac5\u0ac7-\u0ac8\u0acd\u0ae2-\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62-\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c00\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55-\u0c56\u0c62-\u0c63\u0c81\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc-\u0ccd\u0cd5-\u0cd6\u0ce2-\u0ce3\u0d01\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62-\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb-\u0ebc\u0ec8-\u0ecd\u0f18-\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86-\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039-\u103a\u103d-\u103e\u1058-\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085-\u1086\u108d\u109d\u135d-\u135f\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17b4-\u17b5\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927-\u1928\u1932\u1939-\u193b\u1a17-\u1a18\u1a1b\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1ab0-\u1abd\u1abe\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80-\u1b81\u1ba2-\u1ba5\u1ba8-\u1ba9\u1bab-\u1bad\u1be6\u1be8-\u1be9\u1bed\u1bef-\u1bf1\u1c2c-\u1c33\u1c36-\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1cf4\u1cf8-\u1cf9\u1dc0-\u1df5\u1dfc-\u1dff\u200c-\u200d\u20d0-\u20dc\u20dd-\u20e0\u20e1\u20e2-\u20e4\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302d\u302e-\u302f\u3099-\u309a\ua66f\ua670-\ua672\ua674-\ua67d\ua69e-\ua69f\ua6f0-\ua6f1\ua802\ua806\ua80b\ua825-\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\ua9e5\uaa29-\uaa2e\uaa31-\uaa32\uaa35-\uaa36\uaa43\uaa4c\uaa7c\uaab0\uaab2-\uaab4\uaab7-\uaab8\uaabe-\uaabf\uaac1\uaaec-\uaaed\uaaf6\uabe5\uabe8\uabed\ufb1e\ufe00-\ufe0f\ufe20-\ufe2f\uff9e-\uff9f]"),Bg=t=>"string"==typeof t&&t.charCodeAt(0)>=768&&hx.test(t),Dg=rt,bx=Je,Pg=ka("display","block table"),vx=ka("float","left right"),ws=((...t)=>e=>{for(let n=0;n<t.length;n++)if(!t[n](e))return!1;return!0})(Dg,bx,kl(vx)),yx=kl(ka("white-space","pre pre-line pre-wrap")),xs=G,gd=Ft,Lg=Et.nodeIndex,Ia=(t,e)=>e<0&&rt(t)&&t.hasChildNodes()?void 0:tr(t,e),pd=t=>"createRange"in t?t.createRange():Et.DOM.createRng(),hd=t=>t&&/[\r\n\t ]/.test(t),Mg=t=>!!t.setStart&&!!t.setEnd,bd=t=>{const e=t.startContainer,n=t.startOffset;if(hd(t.toString())&&yx(e.parentNode)&&G(e)){const r=e.data;if(hd(r[n-1])||hd(r[n+1]))return!0}return!1},Ig=t=>0===t.left&&0===t.right&&0===t.top&&0===t.bottom,er=t=>{let e;const n=t.getClientRects();return e=Ar(n.length>0?n[0]:t.getBoundingClientRect()),!Mg(t)&&gd(t)&&Ig(e)?(r=>{const o=r.ownerDocument,s=pd(o),a=o.createTextNode(ae),i=r.parentNode;i.insertBefore(a,r),s.setStart(a,0),s.setEnd(a,1);const l=Ar(s.getBoundingClientRect());return i.removeChild(a),l})(t):Ig(e)&&Mg(t)?(r=>{const s=r.endContainer,a=r.startOffset,i=r.endOffset;if(r.startContainer===s&&G(s)&&0===a&&1===i){const l=r.cloneRange();return l.setEndAfter(s),er(l)}return null})(t):e},Or=(t,e)=>{const n=Ag(t,e);return n.width=1,n.right=n.left+1,n},I=(t,e,n)=>{const r=()=>(n||(n=(o=>{const s=[],a=c=>{var u,f;0!==c.height&&(s.length>0&&(u=c).left===(f=s[s.length-1]).left&&u.top===f.top&&u.bottom===f.bottom&&u.right===f.right||s.push(c))},i=(c,u)=>{const f=pd(c.ownerDocument);if(u<c.data.length){if(Bg(c.data[u]))return s;if(Bg(c.data[u-1])&&(f.setStart(c,u),f.setEnd(c,u+1),!bd(f)))return a(Or(er(f),!1)),s}u>0&&(f.setStart(c,u-1),f.setEnd(c,u),bd(f)||a(Or(er(f),!1))),u<c.data.length&&(f.setStart(c,u),f.setEnd(c,u+1),bd(f)||a(Or(er(f),!0)))},l=o.container(),d=o.offset();if(xs(l))return i(l,d),s;if(Dg(l))if(o.isAtEnd()){const c=Ia(l,d);xs(c)&&i(c,c.data.length),ws(c)&&!gd(c)&&a(Or(er(c),!1))}else{const c=Ia(l,d);if(xs(c)&&i(c,0),ws(c)&&o.isAtEnd())return a(Or(er(c),!1)),s;const u=Ia(o.container(),o.offset()-1);ws(u)&&!gd(u)&&(Pg(u)||Pg(c)||!ws(c))&&a(Or(er(u),!1)),ws(c)&&a(Or(er(c),!0))}return s})(I(t,e))),n);return{container:q(t),offset:q(e),toRange:()=>{const o=pd(t.ownerDocument);return o.setStart(t,e),o.setEnd(t,e),o},getClientRects:r,isVisible:()=>r().length>0,isAtStart:()=>(xs(t),0===e),isAtEnd:()=>xs(t)?e>=t.data.length:e>=t.childNodes.length,isEqual:o=>o&&t===o.container()&&e===o.offset(),getNode:o=>Ia(t,o?e-1:e)}};I.fromRangeStart=t=>I(t.startContainer,t.startOffset),I.fromRangeEnd=t=>I(t.endContainer,t.endOffset),I.after=t=>I(t.parentNode,Lg(t)+1),I.before=t=>I(t.parentNode,Lg(t)),I.isAbove=(t,e)=>Se(De(e.getClientRects()),Gr(t.getClientRects()),ys).getOr(!1),I.isBelow=(t,e)=>Se(Gr(e.getClientRects()),De(t.getClientRects()),Cs).getOr(!1),I.isAtStart=t=>!!t&&t.isAtStart(),I.isAtEnd=t=>!!t&&t.isAtEnd(),I.isTextPosition=t=>!!t&&G(t.container()),I.isElementPosition=t=>!1===I.isTextPosition(t);const Fa=(t,e)=>{G(e)&&0===e.data.length&&t.remove(e)},vd=(t,e,n)=>{var r,s;Yl(n)?((r,o,s)=>{const a=C.from(s.firstChild),i=C.from(s.lastChild);o.insertNode(s),a.each(l=>Fa(r,l.previousSibling)),i.each(l=>Fa(r,l.nextSibling))})(t,e,n):(r=t,e.insertNode(s=n),Fa(r,s.previousSibling),Fa(r,s.nextSibling))},rn=G,Fg=xr,Ug=Et.nodeIndex,zg=t=>{const e=t.parentNode;return Fg(e)?zg(e):e},yd=t=>t?ga(t.childNodes,(e,n)=>(Fg(n)&&"BR"!==n.nodeName?e=e.concat(yd(n)):e.push(n),e),[]):[],jg=t=>e=>t===e,Vg=t=>{let e;return e=rn(t)?"text()":t.nodeName.toLowerCase(),e+"["+(n=>{let r,o;r=yd(zg(n)),o=Vm(r,jg(n),n),r=r.slice(0,o+1);const s=ga(r,(a,i,l)=>(rn(i)&&rn(r[l-1])&&a++,a),0);return r=Qr(r,Qe([n.nodeName])),o=Vm(r,jg(n),n),o-s})(t)+"]"},Hg=(t,e)=>{let n,r,o,s,a,i=[];return n=e.container(),r=e.offset(),rn(n)?o=((l,d)=>{for(;(l=l.previousSibling)&&rn(l);)d+=l.data.length;return d})(n,r):(s=n.childNodes,r>=s.length?(o="after",r=s.length-1):o="before",n=s[r]),i.push(Vg(n)),a=((l,d,c)=>{const u=[];for(d=d.parentNode;d!==l;d=d.parentNode)u.push(d);return u})(t,n),a=Qr(a,kl(xr)),i=i.concat(Dl(a,l=>Vg(l))),i.reverse().join("/")+","+o},$g=(t,e)=>{let n;if(!e)return null;const r=e.split(","),o=r[0].split("/");n=r.length>1?r[1]:"before";const s=ga(o,(a,i)=>{const l=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(i);return l?("text()"===l[1]&&(l[1]="#text"),((d,c,u)=>{let f=yd(d);return f=Qr(f,(m,g)=>!rn(m)||!rn(f[g-1])),f=Qr(f,Qe([c])),f[u]})(a,l[1],parseInt(l[2],10))):null},t);return s?rn(s)?((a,i)=>{let l,d=a,c=0;for(;rn(d);){if(l=d.data.length,i>=c&&i<=c+l){a=d,i-=c;break}if(!rn(d.nextSibling)){a=d,i=l;break}c+=l,d=d.nextSibling}return rn(a)&&i>a.data.length&&(i=a.data.length),I(a,i)})(s,parseInt(n,10)):(n="after"===n?Ug(s)+1:Ug(s),I(s.parentNode,n)):null},Ua=Bt,qg=(t,e,n,r,o)=>{let s=r[o?"startContainer":"endContainer"],a=r[o?"startOffset":"endOffset"];const i=[];let l,d=0;const c=t.getRoot();for(G(s)?i.push(n?((u,f,m)=>{let g,p;for(p=u(f.data.slice(0,m)).length,g=f.previousSibling;g&&G(g);g=g.previousSibling)p+=u(g.data).length;return p})(e,s,a):a):(l=s.childNodes,a>=l.length&&l.length&&(d=1,a=Math.max(0,l.length-1)),i.push(t.nodeIndex(l[a],n)+d));s&&s!==c;s=s.parentNode)i.push(t.nodeIndex(s,n));return i},Cd=(t,e,n)=>{let r=0;return z.each(t.select(e),o=>{if("all"!==o.getAttribute("data-mce-bogus"))return o!==n&&void r++}),r},Wg=(t,e)=>{let n,r;const o=e?"start":"end";if(n=t[o+"Container"],r=t[o+"Offset"],rt(n)&&"TR"===n.nodeName){const s=n.childNodes;n=s[Math.min(e?r:r-1,s.length-1)],n&&(r=e?0:n.childNodes.length,t["set"+(e?"Start":"End")](n,r))}},Kg=t=>(Wg(t,!0),Wg(t,!1),t),Gg=(t,e)=>{let n;return rt(t)&&(t=tr(t,e),Ua(t))?t:Ie(t)&&(G(t)&&io(t)&&(t=t.parentNode),n=t.previousSibling,Ua(n)||(n=t.nextSibling,Ua(n)))?n:void 0},Yg=(t,e,n)=>{const r=n.getNode();let o=r?r.nodeName:null;const s=n.getRng();if(Ua(r)||"IMG"===o)return{name:o,index:Cd(n.dom,o,r)};const a=Gg((i=s).startContainer,i.startOffset)||Gg(i.endContainer,i.endOffset);var i;return a?(o=a.tagName,{name:o,index:Cd(n.dom,o,a)}):((i,l,d,c)=>{const u=l.dom,f=qg(u,i,d,c,!0),m=l.isForward(),g=eg(c)?{isFakeCaret:!0}:{};return l.isCollapsed()?at({start:f,forward:m},g):at({start:f,end:qg(u,i,d,c,!1),forward:m},g)})(t,n,e,s)},Xg=(t,e,n)=>{const r={"data-mce-type":"bookmark",id:e,style:"overflow:hidden;line-height:0px"};return n?t.create("span",r,"&#xFEFF;"):t.create("span",r)},Qg=(t,e)=>{const n=t.dom;let r=t.getRng();const o=n.uniqueId(),s=t.isCollapsed(),a=t.getNode(),i=a.nodeName,l=t.isForward();if("IMG"===i)return{name:i,index:Cd(n,i,a)};const d=Kg(r.cloneRange());if(!s){d.collapse(!1);const u=Xg(n,o+"_end",e);vd(n,d,u)}r=Kg(r),r.collapse(!0);const c=Xg(n,o+"_start",e);return vd(n,r,c),t.moveToBookmark({id:o,keep:!0,forward:l}),{id:o,forward:l}},Jg=Y(Yg,pe,!0),Zg=t=>{const e=s=>s(t),n=q(t),r=()=>o,o={tag:!0,inner:t,fold:(s,a)=>a(t),isValue:Vt,isError:Dt,map:s=>he.value(s(t)),mapError:r,bind:e,exists:e,forall:e,getOr:n,or:r,getOrThunk:n,orThunk:r,getOrDie:n,each:s=>{s(t)},toOptional:()=>C.some(t)};return o},tp=t=>{const e=()=>n,n={tag:!1,inner:t,fold:(o,s)=>o(t),isValue:Dt,isError:Vt,map:e,mapError:o=>he.error(o(t)),bind:e,exists:Dt,forall:Vt,getOr:pe,or:pe,getOrThunk:Sl,orThunk:Sl,getOrDie:(r=String(t),()=>{throw new Error(r)}),each:pt,toOptional:C.none};var r;return n},he={value:Zg,error:tp,fromOption:(t,e)=>t.fold(()=>tp(e),Zg)},Cn=t=>{if(!Kt(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");const e=[],n={};return H(t,(r,o)=>{const s=Ke(r);if(1!==s.length)throw new Error("one and only one name per case");const a=s[0],i=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!Kt(i))throw new Error("case arguments must be an array");e.push(a),n[a]=(...l)=>{const d=l.length;if(d!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+d);return{fold:(...c)=>{if(c.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+c.length);return c[o].apply(null,l)},match:c=>{const u=Ke(c);if(e.length!==u.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+u.join(","));if(!Kr(e,f=>Ot(u,f)))throw new Error("Not all branches were specified when using match. Specified: "+u.join(", ")+"\nRequired: "+e.join(", "));return c[a].apply(null,l)},log:c=>{console.log(c,{constructors:e,constructor:a,params:l})}}}}),n};Cn([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const Cx=t=>"inline-command"===t.type||"inline-format"===t.type,wx=t=>"block-command"===t.type||"block-format"===t.type,xx=t=>{const e=r=>he.error({message:r,pattern:t}),n=(r,o,s)=>{if(void 0!==t.format){let a;if(Kt(t.format)){if(!Kr(t.format,st))return e(r+" pattern has non-string items in the `format` array");a=t.format}else{if(!st(t.format))return e(r+" pattern has non-string `format` parameter");a=[t.format]}return he.value(o(a))}return void 0!==t.cmd?st(t.cmd)?he.value(s(t.cmd,t.value)):e(r+" pattern has non-string `cmd` parameter"):e(r+" pattern is missing both `format` and `cmd` parameters")};if(!Te(t))return e("Raw pattern is not an object");if(!st(t.start))return e("Raw pattern is missing `start` parameter");if(void 0!==t.end){if(!st(t.end))return e("Inline pattern has non-string `end` parameter");if(0===t.start.length&&0===t.end.length)return e("Inline pattern has empty `start` and `end` parameters");let r=t.start,o=t.end;return 0===o.length&&(o=r,r=""),n("Inline",s=>({type:"inline-format",start:r,end:o,format:s}),(s,a)=>({type:"inline-command",start:r,end:o,cmd:s,value:a}))}return void 0!==t.replacement?st(t.replacement)?0===t.start.length?e("Replacement pattern has empty `start` parameter"):he.value({type:"inline-command",start:"",end:t.start,cmd:"mceInsertContent",value:t.replacement}):e("Replacement pattern has non-string `replacement` parameter"):0===t.start.length?e("Block pattern has empty `start` parameter"):n("Block",r=>({type:"block-format",start:t.start,format:r[0]}),(r,o)=>({type:"block-command",start:t.start,cmd:r,value:o}))},kx=t=>{return e=dt(t,wx),Yo(e,(n,r)=>n.start.length===r.start.length?0:n.start.length>r.start.length?-1:1);var e},ep=t=>dt(t,Cx),Sx=t=>{const e=(n=>{const r=[],o=[];return H(n,s=>{s.fold(a=>{r.push(a)},a=>{o.push(a)})}),{errors:r,values:o}})(yt(t,xx));return H(e.errors,n=>console.error(n.message,n.pattern)),e.values},wd=pr().deviceType,Ex=wd.isTouch(),_x=Et.DOM,np=t=>ma(t,RegExp),X=t=>e=>e.options.get(t),xd=t=>st(t)||Te(t),rp=(t,e="")=>n=>{const r=st(n);if(r){if(-1!==n.indexOf("=")){const o=(s=>{const a=s.indexOf("=")>0?s.split(/[;,](?![^=;,]*(?:[;,]|$))/):s.split(",");return Be(a,(i,l)=>{const d=l.split("="),c=d[0],u=d.length>1?d[1]:c;return i[Jr(c)]=Jr(u),i},{})})(n);return{value:Nt(o,t.id).getOr(e),valid:r}}return{value:n,valid:r}}return{valid:!1,message:"Must be a string."}},Nx=X("iframe_attrs"),Rx=X("doctype"),op=X("document_base_url"),Ax=X("body_id"),Ox=X("body_class"),sp=X("content_security_policy"),Tx=X("br_in_pre"),_e=X("forced_root_block"),Tr=X("forced_root_block_attrs"),Bx=X("newline_behavior"),Dx=X("br_newline_selector"),Px=X("no_newline_selector"),Lx=X("keep_styles"),Mx=X("end_container_on_empty_block"),ap=X("automatic_uploads"),ip=X("images_reuse_filename"),Ix=X("images_replace_blob_uris"),lp=X("icons"),Fx=X("icons_url"),Ux=X("images_upload_url"),zx=X("images_upload_base_path"),jx=X("images_upload_credentials"),Vx=X("images_upload_handler"),Hx=X("content_css_cors"),kd=X("referrer_policy"),dp=X("language"),$x=X("language_url"),cp=X("indent_use_margin"),qx=X("indentation"),Wx=X("content_css"),Kx=X("content_style"),up=X("font_css"),Gx=X("directionality"),Yx=X("inline_boundaries_selector"),mp=X("object_resizing"),Xx=X("resize_img_proportional"),Qx=X("placeholder"),fp=X("event_root"),Jx=X("service_message"),ho=X("theme"),Zx=X("theme_url"),Sd=X("model"),tk=X("model_url"),ks=X("inline_boundaries"),ek=X("formats"),nk=X("preview_styles"),rk=X("format_empty_lines"),ok=X("custom_ui_selector"),Ed=X("inline"),sk=X("hidden_input"),ak=X("submit_patch"),ik=X("add_form_submit_trigger"),lk=X("add_unload_trigger"),dk=X("custom_undo_redo_levels"),ck=X("disable_nodechange"),gp=X("readonly"),uk=X("content_css_cors"),za=X("plugins"),mk=X("external_plugins"),fk=X("block_unsupported_drop"),gk=X("visual"),pk=X("visual_table_class"),pp=X("visual_anchor_class"),hk=X("iframe_aria_text"),bk=X("setup"),vk=X("init_instance_callback"),yk=X("urlconverter_callback"),Ck=X("auto_focus"),wk=X("browser_spellcheck"),xk=X("protect"),kk=X("paste_block_drop"),ja=X("paste_data_images"),Sk=X("paste_preprocess"),Ek=X("paste_postprocess"),_k=X("paste_webkit_styles"),Nk=X("paste_remove_styles_if_webkit"),Rk=X("paste_merge_formats"),Ak=X("smart_paste"),Ok=X("paste_as_text"),Tk=X("paste_tab_spaces"),Bk=X("allow_html_data_urls"),hp=X("text_patterns"),bp=X("noneditable_class"),Dk=X("editable_class"),Pk=X("noneditable_regexp"),vp=t=>z.explode(t.options.get("images_file_types")),Lk=X("table_tab_navigation"),Mk=rt,yp=G,Cp=t=>{const e=t.parentNode;e&&e.removeChild(t)},wp=t=>{const e=Yn(t);return{count:t.length-e.length,text:e}},xp=t=>{let e;for(;-1!==(e=t.data.lastIndexOf(ie));)t.deleteData(e,1)},kp=(t,e)=>(Br(t),e),Br=t=>{Mk(t)&&Ie(t)&&(tg(t)?t.removeAttribute("data-mce-caret"):Cp(t)),yp(t)&&(xp(t),0===t.data.length&&Cp(t))},Fk=Bt,Uk=yn,zk=Sa,Sp=(t,e,n)=>{const r=Ag(e.getBoundingClientRect(),n);let o,s;if("BODY"===t.tagName){const i=t.ownerDocument.documentElement;o=t.scrollLeft||i.scrollLeft,s=t.scrollTop||i.scrollTop}else{const i=t.getBoundingClientRect();o=t.scrollLeft-i.left,s=t.scrollTop-i.top}r.left+=o,r.right+=o,r.top+=s,r.bottom+=s,r.width=1;let a=e.offsetWidth-e.clientWidth;return a>0&&(n&&(a*=-1),r.left+=a,r.right+=a),r},Ep=()=>Ct.browser.isFirefox(),Ss=t=>Fk(t)||Uk(t),Es=t=>Ss(t)||ds(t)&&Ep(),Vk=vn,_d=Bt,Hk=yn,_p=ka("display","block table table-cell table-caption list-item"),Np=Ie,Rp=io,Ap=rt,$k=Je,bo=t=>t>0,Dr=t=>t<0,Va=(t,e)=>{let n;for(;n=t(e);)if(!Rp(n))return n;return null},_s=(t,e,n,r,o)=>{const s=new zt(t,r),a=_d(t)||Rp(t);if(Dr(e)){if(a&&n(t=Va(s.prev.bind(s),!0)))return t;for(;t=Va(s.prev.bind(s),o);)if(n(t))return t}if(bo(e)){if(a&&n(t=Va(s.next.bind(s),!0)))return t;for(;t=Va(s.next.bind(s),o);)if(n(t))return t}return null},nr=(t,e)=>{for(;t&&t!==e;){if(_p(t))return t;t=t.parentNode}return null},wn=(t,e,n)=>nr(t.container(),n)===nr(e.container(),n),Nd=(t,e)=>{if(!e)return null;const n=e.container(),r=e.offset();return Ap(n)?n.childNodes[r+t]:null},Op=(t,e)=>{const n=e.ownerDocument.createRange();return t?(n.setStartBefore(e),n.setEndBefore(e)):(n.setStartAfter(e),n.setEndAfter(e)),n},qk=(t,e,n)=>nr(e,t)===nr(n,t),Tp=(t,e,n)=>{const r=t?"previousSibling":"nextSibling";for(;n&&n!==e;){let o=n[r];if(Np(o)&&(o=o[r]),_d(o)||Hk(o)){if(qk(e,o,n))return o;break}if($k(o))break;n=n.parentNode}return null},Ns=Y(Op,!0),Rs=Y(Op,!1),Rd=(t,e,n)=>{let r;const o=Y(Tp,!0,e),s=Y(Tp,!1,e);let a=n.startContainer;const i=n.startOffset;if(io(a)){Ap(a)||(a=a.parentNode);const l=a.getAttribute("data-mce-caret");if("before"===l&&(r=a.nextSibling,Es(r)))return Ns(r);if("after"===l&&(r=a.previousSibling,Es(r)))return Rs(r)}if(!n.collapsed)return n;if(G(a)){if(Np(a)){if(1===t){if(r=s(a),r)return Ns(r);if(r=o(a),r)return Rs(r)}if(-1===t){if(r=o(a),r)return Rs(r);if(r=s(a),r)return Ns(r)}return n}if(Oa(a)&&i>=a.data.length-1)return 1===t&&(r=s(a),r)?Ns(r):n;if(Aa(a)&&i<=1)return-1===t&&(r=o(a),r)?Rs(r):n;if(i===a.data.length)return r=s(a),r?Ns(r):n;if(0===i)return r=o(a),r?Rs(r):n}return n},Bp=(t,e)=>C.from(Nd(t?0:-1,e)).filter(_d),As=(t,e,n)=>{const r=Rd(t,e,n);return-1===t?I.fromRangeStart(r):I.fromRangeEnd(r)},Ha=t=>C.from(t.getNode()).map(N),Ad=(t,e)=>{for(;e=t(e);)if(e.isVisible())return e;return e},$a=(t,e)=>{const n=wn(t,e);return!(n||!Ft(t.getNode()))||n};var $t,t;(t=$t||($t={}))[t.Backwards=-1]="Backwards",t[t.Forwards=1]="Forwards";const Wk=Bt,xn=G,Dp=rt,Od=Ft,vo=Je,Pp=t=>{return rg(t)||!!ed(e=t)&&!0!==Be(ke(e.getElementsByTagName("*")),(n,r)=>n||ng(r),!1);var e},qa=og,Lp=(t,e)=>t.hasChildNodes()&&e<t.childNodes.length?t.childNodes[e]:null,Mp=(t,e)=>{if(bo(t)){if(vo(e.previousSibling)&&!xn(e.previousSibling))return I.before(e);if(xn(e))return I(e,0)}if(Dr(t)){if(vo(e.nextSibling)&&!xn(e.nextSibling))return I.after(e);if(xn(e))return I(e,e.data.length)}return Dr(t)?Od(e)?I.before(e):I.after(e):I.before(e)},Td=(t,e,n)=>{let r,o,s,a;if(!Dp(n)||!e)return null;if(e.isEqual(I.after(n))&&n.lastChild){if(a=I.after(n.lastChild),Dr(t)&&vo(n.lastChild)&&Dp(n.lastChild))return Od(n.lastChild)?I.before(n.lastChild):a}else a=e;const i=a.container();let l=a.offset();if(xn(i)){if(Dr(t)&&l>0)return I(i,--l);if(bo(t)&&l<i.length)return I(i,++l);r=i}else{if(Dr(t)&&l>0&&(o=Lp(i,l-1),vo(o)))return!Pp(o)&&(s=_s(o,t,qa,o),s)?xn(s)?I(s,s.data.length):I.after(s):xn(o)?I(o,o.data.length):I.before(o);if(bo(t)&&l<i.childNodes.length&&(o=Lp(i,l),vo(o)))return Od(o)?((c,u)=>{const f=u.nextSibling;return f&&vo(f)?xn(f)?I(f,0):I.before(f):Td($t.Forwards,I.after(u),c)})(n,o):!Pp(o)&&(s=_s(o,t,qa,o),s)?xn(s)?I(s,0):I.before(s):xn(o)?I(o,0):I.after(o);r=o||a.getNode()}if((bo(t)&&a.isAtEnd()||Dr(t)&&a.isAtStart())&&(r=_s(r,t,Vt,n,!0),qa(r,n)))return Mp(t,r);o=_s(r,t,qa,n);const d=fr(dt(((c,u)=>{const f=[];for(;c&&c!==u;)f.push(c),c=c.parentNode;return f})(i,n),Wk));return!d||o&&d.contains(o)?o?Mp(t,o):null:(a=bo(t)?I.after(d):I.before(d),a)},kn=t=>({next:e=>Td($t.Forwards,e,t),prev:e=>Td($t.Backwards,e,t)}),Ip=t=>I.isTextPosition(t)?0===t.offset():Je(t.getNode()),Fp=t=>{if(I.isTextPosition(t)){const e=t.container();return t.offset()===e.data.length}return Je(t.getNode(!0))},Up=(t,e)=>!I.isTextPosition(t)&&!I.isTextPosition(e)&&t.getNode()===e.getNode(!0),Fe=(t,e,n)=>{const r=kn(e);return C.from(t?r.next(n):r.prev(n))},Wa=(t,e,n)=>Fe(t,e,n).bind(r=>{return wn(n,r,e)&&(s=n,a=r,t?!Up(s,a)&&(I.isTextPosition(i=s)||!Ft(i.getNode()))&&Fp(s)&&Ip(a):!Up(a,s)&&Ip(s)&&Fp(a))?Fe(t,e,r):C.some(r);var s,a,i}),zp=(t,e,n,r)=>Wa(t,e,n).bind(o=>r(o)?zp(t,e,o,r):C.some(o)),yo=(t,e)=>{const n=t?e.firstChild:e.lastChild;return G(n)?C.some(I(n,t?0:n.data.length)):n?Je(n)?C.some(t?I.before(n):Ft(r=n)?I.before(r):I.after(r)):((o,s,a)=>{const i=o?I.before(a):I.after(a);return Fe(o,s,i)})(t,e,n):C.none();var r},Ue=Y(Fe,!0),on=Y(Fe,!1),be=Y(yo,!0),Sn=Y(yo,!1),jp="_mce_caret",En=t=>rt(t)&&t.id===jp,Pr=(t,e)=>{for(;e&&e!==t;){if(e.id===jp)return e;e=e.parentNode}return null},Vp=t=>gt(t,"name"),Hp=t=>z.isArray(t.start),Ka=t=>!(!Vp(t)&&ur(t.forward))||t.forward,$p=(t,e)=>(rt(e)&&t.isBlock(e)&&!e.innerHTML&&(e.innerHTML='<br data-mce-bogus="1" />'),e),Kk=(t,e)=>Sn(t).fold(Dt,n=>(e.setStart(n.container(),n.offset()),e.setEnd(n.container(),n.offset()),!0)),qp=(t,e,n)=>!(!1!==e.hasChildNodes()||!Pr(t,e)||(((r,o)=>{const s=r.ownerDocument.createTextNode(ie);r.appendChild(s),o.setStart(s,0),o.setEnd(s,0)})(e,n),0)),Wp=(t,e,n,r)=>{const o=n[e?"start":"end"];let s,a,i,l;const d=t.getRoot();if(o){for(i=o[0],a=d,s=o.length-1;s>=1;s--){if(l=a.childNodes,qp(d,a,r))return!0;if(o[s]>l.length-1)return!!qp(d,a,r)||Kk(a,r);a=l[o[s]]}3===a.nodeType&&(i=Math.min(o[0],a.nodeValue.length)),1===a.nodeType&&(i=Math.min(o[0],a.childNodes.length)),e?r.setStart(a,i):r.setEnd(a,i)}return!0},Bd=t=>G(t)&&t.data.length>0,Kp=(t,e,n)=>{let r,o,s,a,i=t.get(n.id+"_"+e);const l=n.keep;let d,c;if(i){if(r=i.parentNode,"start"===e?(l?i.hasChildNodes()?(r=i.firstChild,o=1):Bd(i.nextSibling)?(r=i.nextSibling,o=0):Bd(i.previousSibling)?(r=i.previousSibling,o=i.previousSibling.data.length):(r=i.parentNode,o=t.nodeIndex(i)+1):o=t.nodeIndex(i),d=r,c=o):(l?i.hasChildNodes()?(r=i.firstChild,o=1):Bd(i.previousSibling)?(r=i.previousSibling,o=i.previousSibling.data.length):(r=i.parentNode,o=t.nodeIndex(i)):o=t.nodeIndex(i),d=r,c=o),!l){for(a=i.previousSibling,s=i.nextSibling,z.each(z.grep(i.childNodes),u=>{G(u)&&(u.nodeValue=u.nodeValue.replace(/\uFEFF/g,""))});i=t.get(n.id+"_"+e);)t.remove(i,!0);a&&s&&a.nodeType===s.nodeType&&G(a)&&!Ct.browser.isOpera()&&(o=a.nodeValue.length,a.appendData(s.nodeValue),t.remove(s),d=a,c=o)}return C.some(I(d,c))}return C.none()},Gk=(t,e,n)=>{return r=t,2===(o=e)?Yg(Yn,n,r):3===o?(a=>{const i=a.getRng();return{start:Hg(a.dom.getRoot(),I.fromRangeStart(i)),end:Hg(a.dom.getRoot(),I.fromRangeEnd(i)),forward:a.isForward()}})(r):o?{rng:(a=r).getRng(),forward:a.isForward()}:Qg(r,!1);var r,o,a},Yk=(t,e)=>{((n,r)=>{const o=n.dom;if(r){if(Hp(r))return((s,a)=>{const i=s.createRng();return Wp(s,!0,a,i)&&Wp(s,!1,a,i)?C.some({range:i,forward:Ka(a)}):C.none()})(o,r);if(st(r.start))return C.some(((s,a)=>{const i=s.createRng(),l=$g(s.getRoot(),a.start);i.setStart(l.container(),l.offset());const d=$g(s.getRoot(),a.end);return i.setEnd(d.container(),d.offset()),{range:i,forward:Ka(a)}})(o,r));if(gt(r,"id"))return((s,a)=>{const i=Kp(s,"start",a),l=Kp(s,"end",a);return Se(i,l.or(i),(d,c)=>{const u=s.createRng();return u.setStart($p(s,d.container()),d.offset()),u.setEnd($p(s,c.container()),c.offset()),{range:u,forward:Ka(a)}})})(o,r);if(Vp(r))return((s,a)=>C.from(s.select(a.name)[a.index]).map(i=>{const l=s.createRng();return l.selectNode(i),{range:l,forward:!0}}))(o,r);if((s=>gt(s,"rng"))(r))return C.some({range:r.rng,forward:Ka(r)})}return C.none()})(t,e).each(({range:n,forward:r})=>{t.setRng(n,r)})},ze=t=>rt(t)&&"SPAN"===t.tagName&&"bookmark"===t.getAttribute("data-mce-type"),Ga=t=>"\xa0"===t,Os=t=>""!==t&&-1!==" \f\n\r\t\v".indexOf(t),Dd=t=>!Os(t)&&!Ga(t)&&!Zf(t),Pd=t=>{const e=t.toString(16);return(1===e.length?"0"+e:e).toUpperCase()},Xk=t=>({value:Pd(t.red)+Pd(t.green)+Pd(t.blue)}),Qk=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,Jk=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,Gp=(t,e,n,r)=>({red:t,green:e,blue:n,alpha:r}),Yp=(t,e,n,r)=>{const o=parseInt(t,10),s=parseInt(e,10),a=parseInt(n,10),i=parseFloat(r);return Gp(o,s,a,i)},Ya=t=>(e=>{if("transparent"===e)return C.some(Gp(0,0,0,0));const n=Qk.exec(e);if(null!==n)return C.some(Yp(n[1],n[2],n[3],"1"));const r=Jk.exec(e);return null!==r?C.some(Yp(r[1],r[2],r[3],r[4])):C.none()})(t).map(Xk).map(e=>"#"+e.value).getOr(t),Xa=t=>!!t.nodeType,Xp=(t,e,n)=>{const r=n.startOffset;let o=n.startContainer;var s;if((o!==n.endContainer||!(s=o.childNodes[r])||!/^(IMG)$/.test(s.nodeName))&&rt(o)){const a=o.childNodes;let i;r<a.length?(o=a[r],i=new zt(o,t.getParent(o,t.isBlock))):(o=a[a.length-1],i=new zt(o,t.getParent(o,t.isBlock)),i.next(!0));for(let l=i.current();l;l=i.next())if(G(l)&&!Md(l))return n.setStart(l,0),void e.setRng(n)}},Qp=(t,e,n)=>{if(t){const r=e?"nextSibling":"previousSibling";for(t=n?t:t[r];t;t=t[r])if(rt(t)||!Md(t))return t}},Ld=(t,e)=>(Xa(e)&&(e=e.nodeName),!!t.schema.getTextBlockElements()[e.toLowerCase()]),Co=(t,e,n)=>t.schema.isValidChild(e,n),Md=(t,e=!1)=>{if(lt(t)&&G(t)){const n=e?t.data.replace(/ /g,"\xa0"):t.data;return Sr(n)}return!1},Fn=(t,e)=>(xt(t)?t=t(e):lt(e)&&(t=t.replace(/%(\w+)/g,(n,r)=>e[r]||n)),t),Id=(t,e)=>(t=""+((t=t||"").nodeName||t),e=""+((e=e||"").nodeName||e),t.toLowerCase()===e.toLowerCase()),Fd=(t,e)=>("color"!==e&&"backgroundColor"!==e||(t=Ya(t)),"fontWeight"===e&&700===t&&(t="bold"),"fontFamily"===e&&(t=t.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+t),Qa=(t,e,n)=>Fd(t.getStyle(e,n),n),Jp=(t,e)=>{let n;return t.getParent(e,r=>(n=t.getStyle(r,"text-decoration"),n&&"none"!==n)),n},Ja=(t,e,n)=>t.getParents(e,n,t.getRoot()),_n=t=>Xr(t,"block"),Pe=t=>Xr(t,"selector"),Qt=t=>Xr(t,"inline"),Ud=t=>Pe(t)&&!1!==t.expand&&!Qt(t),wo=ze,Zp=Ja,th=Md,Zk=Ld,eh=(t,e)=>{let n=e;for(;n;){if(rt(n)&&t.getContentEditable(n))return"false"===t.getContentEditable(n)?n:e;n=n.parentNode}return e},nh=(t,e,n,r)=>{const o=e.data;for(let s=n;t?s>=0:s<o.length;t?s--:s++)if(r(o.charAt(s)))return t?s+1:s;return-1},tS=(t,e,n)=>nh(t,e,n,r=>Ga(r)||Os(r)),eS=(t,e,n)=>nh(t,e,n,Dd),rh=(t,e,n,r,o,s)=>{let a;const i=t.getParent(n,t.isBlock)||e,l=(d,c,u)=>{const f=Rr(t);return C.from((o?f.backwards:f.forwards)(d,c,(g,p)=>wo(g.parentNode)?-1:(a=g,u(o,g,p)),i))};return l(n,r,tS).bind(d=>s?l(d.container,d.offset+(o?-1:0),eS):C.some(d)).orThunk(()=>a?C.some({container:a,offset:o?0:a.length}):C.none())},oh=(t,e,n,r,o)=>{G(r)&&pa(r.data)&&r[o]&&(r=r[o]);const s=Zp(t,r);for(let a=0;a<s.length;a++)for(let i=0;i<e.length;i++){const l=e[i];if((!lt(l.collapsed)||l.collapsed===n.collapsed)&&Pe(l)&&t.is(s[a],l.selector))return s[a]}return r},sh=(t,e,n,r)=>{let o=n;const s=t.dom,a=s.getRoot(),i=e[0];if(_n(i)&&(o=i.wrapper?null:s.getParent(n,i.block,a)),!o){const l=s.getParent(n,"LI,TD,TH");o=s.getParent(G(n)?n.parentNode:n,d=>d!==a&&Zk(t,d),l)}if(o&&_n(i)&&i.wrapper&&(o=Zp(s,o,"ul,ol").reverse()[0]||o),!o)for(o=n;o[r]&&!s.isBlock(o[r])&&(o=o[r],!Id(o,"br")););return o||n},ah=(t,e,n,r)=>{const o=n.parentNode;return!lt(n[r])&&(!(o!==e&&!xe(o)&&!t.isBlock(o))||ah(t,e,o,r))},Za=(t,e,n,r,o)=>{let s=n;const a=o?"previousSibling":"nextSibling",i=t.getRoot();if(G(n)&&!th(n)&&(o?r>0:r<n.data.length))return n;for(;;){if(!e[0].block_expand&&t.isBlock(s))return s;for(let d=s[a];d;d=d[a]){const c=G(d)&&!ah(t,i,d,a);if(!wo(d)&&(!Ft(l=d)||!l.getAttribute("data-mce-bogus")||l.nextSibling)&&!th(d,c))return s}if(s===i||s.parentNode===i){n=s;break}s=s.parentNode}var l;return n},ih=t=>wo(t.parentNode)||wo(t),xo=(t,e,n,r=!1)=>{let{startContainer:o,startOffset:s,endContainer:a,endOffset:i}=e;const l=t.dom,d=n[0];return rt(o)&&o.hasChildNodes()&&(o=tr(o,s),G(o)&&(s=0)),rt(a)&&a.hasChildNodes()&&(a=tr(a,e.collapsed?i:i-1),G(a)&&(i=a.nodeValue.length)),o=eh(l,o),a=eh(l,a),ih(o)&&(o=wo(o)?o:o.parentNode,o=e.collapsed?o.previousSibling||o:o.nextSibling||o,G(o)&&(s=e.collapsed?o.length:0)),ih(a)&&(a=wo(a)?a:a.parentNode,a=e.collapsed?a.nextSibling||a:a.previousSibling||a,G(a)&&(i=e.collapsed?0:a.length)),e.collapsed&&(rh(l,t.getBody(),o,s,!0,r).each(({container:c,offset:u})=>{o=c,s=u}),rh(l,t.getBody(),a,i,!1,r).each(({container:c,offset:u})=>{a=c,i=u})),(Qt(d)||d.block_expand)&&(Qt(d)&&G(o)&&0!==s||(o=Za(l,n,o,s,!0)),Qt(d)&&G(a)&&i!==a.nodeValue.length||(a=Za(l,n,a,i,!1))),Ud(d)&&(o=oh(l,n,e,o,"previousSibling"),a=oh(l,n,e,a,"nextSibling")),(_n(d)||Pe(d))&&(o=sh(t,n,o,"previousSibling"),a=sh(t,n,a,"nextSibling"),_n(d)&&(l.isBlock(o)||(o=Za(l,n,o,s,!0)),l.isBlock(a)||(a=Za(l,n,a,i,!1)))),rt(o)&&(s=l.nodeIndex(o),o=o.parentNode),rt(a)&&(i=l.nodeIndex(a)+1,a=a.parentNode),{startContainer:o,startOffset:s,endContainer:a,endOffset:i}},Ts=(t,e,n)=>{const r=e.startOffset,o=tr(e.startContainer,r),s=e.endOffset,a=tr(e.endContainer,s-1),i=p=>{const b=p[0];G(b)&&b===o&&r>=b.data.length&&p.splice(0,1);const h=p[p.length-1];return 0===s&&p.length>0&&h===a&&G(h)&&p.splice(p.length-1,1),p},l=(p,b,h)=>{const v=[];for(;p&&p!==h;p=p[b])v.push(p);return v},d=(p,b)=>t.getParent(p,h=>h.parentNode===b,b),c=(p,b,h)=>{const v=h?"nextSibling":"previousSibling";for(let y=p,w=y.parentNode;y&&y!==b;y=w){w=y.parentNode;const x=l(y===p?y:y[v],v);x.length&&(h||x.reverse(),n(i(x)))}};if(o===a)return n(i([o]));const u=t.findCommonAncestor(o,a);if(t.isChildOf(o,a))return c(o,u,!0);if(t.isChildOf(a,o))return c(a,u);const f=d(o,u)||o,m=d(a,u)||a;c(o,f,!0);const g=l(f===o?f:f.nextSibling,"nextSibling",m===a?m.nextSibling:m);g.length&&n(i(g)),c(a,m)},zd=t=>{const e=[];if(t)for(let n=0;n<t.rangeCount;n++)e.push(t.getRangeAt(n));return e},lh=(t,e)=>{const n=Ee(e,"td[data-mce-selected],th[data-mce-selected]");return n.length>0?n:dt(Dn(t,s=>{const a=Ma(s);return a?[N(a)]:[]}),Ea)},ko=t=>lh(zd(t.selection.getSel()),N(t.getBody())),Bs=(t,e)=>cs(t,"table",e),dh=t=>Nf(t).fold(q([t]),e=>[t].concat(dh(e))),jd=t=>jl(t).fold(q([t]),e=>"br"===Tt(e)?br(e).map(n=>[t].concat(jd(n))).getOr([]):[t].concat(jd(e))),Vd=(t,e)=>Se((n=>{const r=n.startContainer,o=n.startOffset;return G(r)?0===o?C.some(N(r)):C.none():C.from(r.childNodes[o]).map(N)})(e),(n=>{const r=n.endContainer,o=n.endOffset;return G(r)?o===r.data.length?C.some(N(r)):C.none():C.from(r.childNodes[o-1]).map(N)})(e),(n,r)=>{const o=Gt(dh(t),Y(kt,n)),s=Gt(jd(t),Y(kt,r));return o.isSome()&&s.isSome()}).getOr(!1),Hd=(t,e,n,r)=>{const o=n,s=new zt(n,o),a=Qo(t.schema.getMoveCaretBeforeOnEnterElements(),(i,l)=>!Ot(["td","th","table"],l.toLowerCase()));do{if(G(n)&&0!==z.trim(n.nodeValue).length)return void(r?e.setStart(n,0):e.setEnd(n,n.nodeValue.length));if(a[n.nodeName])return void(r?e.setStartBefore(n):"BR"===n.nodeName?e.setEndBefore(n):e.setEndAfter(n))}while(n=r?s.next():s.prev());"BODY"===o.nodeName&&(r?e.setStart(o,0):e.setEnd(o,o.childNodes.length))},ti=t=>{const e=t.selection.getSel();return e&&e.rangeCount>0},$d=(t,e)=>{const n=ko(t);n.length>0?H(n,r=>{const o=r.dom,s=t.dom.createRng();s.setStartBefore(o),s.setEndAfter(o),e(s,!0)}):e(t.selection.getRng(),!1)},qd=(t,e,n)=>{const r=Qg(t,e);n(r),t.moveToBookmark(r)},ch=((t,e)=>{const n=r=>t(r)?C.from(r.dom.nodeValue):C.none();return{get:r=>{if(!t(r))throw new Error("Can only get text value of a text node");return n(r).getOr("")},getOption:n,set:(r,o)=>{if(!t(r))throw new Error("Can only set raw text value of a text node");r.dom.nodeValue=o}}})(Le),Wd=t=>ch.get(t),uh=t=>ch.getOption(t),nS=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],mh=(t,e,n,r,o,s)=>{const c=n,{uid:a=e}=c,i=dw(c,["uid"]);ns(t,ps()),re(t,`${fo()}`,a),re(t,`${Nr()}`,r);const{attributes:l={},classes:d=[]}=o(a,i);if(pn(t,l),u=t,H(d,m=>{ns(u,m)}),s){d.length>0&&re(t,`${bs()}`,d.join(","));const u=Ke(l);u.length>0&&re(t,`${vs()}`,u.join(","))}var u},fh=(t,e,n,r,o)=>{const s=Ut("span",t);return mh(s,e,n,r,o,!1),s},gh=t=>{const e=(()=>{const s={};return{register:(a,i)=>{s[a]={name:a,settings:i}},lookup:a=>Nt(s,a).map(i=>i.settings),getNames:()=>Ke(s)}})();((s,a)=>{const i=Nr(),l=c=>C.from(c.attr(i)).bind(a.lookup),d=c=>{var u,f;c.attr(fo(),null),c.attr(Nr(),null),c.attr(hs(),null);const m=C.from(c.attr(vs())).map(h=>h.split(",")).getOr([]),g=C.from(c.attr(bs())).map(h=>h.split(",")).getOr([]);H(m,h=>c.attr(h,null));const p=null!==(f=null===(u=c.attr("class"))||void 0===u?void 0:u.split(" "))&&void 0!==f?f:[],b=_l(p,[ps()].concat(g));c.attr("class",b.length>0?b.join(" "):null),c.attr(bs(),null),c.attr(vs(),null)};s.serializer.addTempAttr(hs()),s.serializer.addAttributeFilter(i,c=>{for(const u of c)l(u).each(f=>{!1===f.persistent&&("span"===u.name?u.unwrap():d(u))})})})(t,e);const n=((s,a)=>{const i=Xt({}),l=()=>({listeners:[],previous:Zn()}),d=(m,g)=>{c(m,p=>(g(p),p))},c=(m,g)=>{const p=i.get(),b=g(Nt(p,m).getOrThunk(l));p[m]=b,i.set(p)},u=(m,g)=>{H(xg(s,m),p=>{g?re(p,hs(),"true"):oe(p,hs())})},f=fd(()=>{const m=Yo(a.getNames());H(m,g=>{c(g,p=>{const b=p.previous.get();return Cg(s,C.some(g)).fold(()=>{b.each(h=>{var v;d(v=g,y=>{H(y.listeners,w=>w(!1,v))}),p.previous.clear(),u(h,!1)})},({uid:h,name:v,elements:y})=>{var w,x,S;Zr(b,h)||(b.each(w=>u(w,!1)),x=h,S=y,d(w=v,k=>{H(k.listeners,D=>D(!0,w,{uid:x,nodes:yt(S,B=>B.dom)}))}),p.previous.set(h),u(h,!0))}),{previous:p.previous,listeners:p.listeners}})})},30);return s.on("remove",()=>{f.cancel()}),s.on("NodeChange",()=>{f.throttle()}),{addListener:(m,g)=>{c(m,p=>({previous:p.previous,listeners:p.listeners.concat([g])}))}}})(t,e),r=gf("span"),o=s=>{H(s,a=>{r(a)?Cr(a):(i=>{ba(i,ps()),oe(i,`${fo()}`),oe(i,`${Nr()}`),oe(i,`${hs()}`);const l=to(i,`${vs()}`).map(u=>u.split(",")).getOr([]),d=to(i,`${bs()}`).map(u=>u.split(",")).getOr([]);var c;H(l,u=>oe(i,u)),c=i,H(d,u=>{ba(c,u)}),oe(i,`${bs()}`),oe(i,`${vs()}`)})(a)})};return{register:(s,a)=>{e.register(s,a)},annotate:(s,a)=>{e.lookup(s).each(i=>{var l,d,c,u;d=s,c=i,u=a,(l=t).undoManager.transact(()=>{const f=l.selection,m=f.getRng(),g=ko(l).length>0,p=Eg("mce-annotation");if(m.collapsed&&!g&&((b,h)=>{const v=xo(b,h,[{inline:"span"}]);h.setStart(v.startContainer,v.startOffset),h.setEnd(v.endContainer,v.endOffset),b.selection.setRng(h)})(l,m),f.getRng().collapsed&&!g){const b=fh(l.getDoc(),p,u,d,c.decorate);Hl(b,ae),f.getRng().insertNode(b.dom),f.select(b.dom)}else qd(f,!1,()=>{$d(l,b=>{((t,e,n,r,o,s)=>{const a=[],i=fh(t.getDoc(),n,s,r,o),l=Zn(),d=()=>{l.clear()},c=f=>{H(f,u)},u=f=>{switch(m=t,g=f,p="span",b=Tt(f),Ye(g).fold(()=>"skipping",h=>{return"br"===b||Le(v=g)&&Wd(v)===ie?"valid":(v=>Ge(v)&&zl(v,ps()))(g)?"existing":En(g.dom)?"caret":It(nS,v=>hn(g,v))?"valid-block":Co(m,p,b)&&Co(m,Tt(h),p)?"valid":"invalid-child";var v})){case"invalid-child":{d();const m=se(f);c(m),d();break}case"valid-block":d(),mh(f,n,s,r,o,!0);break;case"valid":{const m=l.get().getOrThunk(()=>{const g=go(i);return a.push(g),l.set(g),g});((g,p)=>{Xe(g,p),Ht(p,g)})(f,m);break}}var m,g,p,b};Ts(t.dom,e,f=>{d(),(m=>{const g=yt(m,N);c(g)})(f)})})(l,b,p,d,c.decorate,u)})})})})},annotationChanged:(s,a)=>{n.addListener(s,a)},remove:s=>{const a=t.selection.getBookmark();Cg(t,C.some(s)).each(({elements:i})=>{o(i)}),t.selection.moveToBookmark(a)},removeAll:s=>{const a=t.selection.getBookmark();At(kg(t,s),(i,l)=>{o(i)}),t.selection.moveToBookmark(a)},getAll:s=>{const a=kg(t,s);return Xo(a,i=>yt(i,l=>l.dom))}}},Ds=t=>({getBookmark:Y(Gk,t),moveToBookmark:Y(Yk,t)});Ds.isBookmarkNode=ze;const ph=(t,e,n)=>!n.collapsed&&It(n.getClientRects(),r=>{return a=e,(s=t)>=(o=r).left&&s<=o.right&&a>=o.top&&a<=o.bottom;var o,s,a}),hh=(t,e,n)=>t.dispatch(e,n),bh=(t,e,n,r)=>t.dispatch("FormatApply",{format:e,node:n,vars:r}),Kd=(t,e,n,r)=>t.dispatch("FormatRemove",{format:e,node:n,vars:r}),vh=(t,e)=>t.dispatch("SetContent",e),yh=(t,e)=>t.dispatch("GetContent",e),Ch=(t,e)=>t.dispatch("PastePlainTextToggle",{state:e}),J={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:t=>t.shiftKey||t.ctrlKey||t.altKey||J.metaKeyPressed(t),metaKeyPressed:t=>Ct.os.isMacOS()||Ct.os.isiOS()?t.metaKey:t.ctrlKey&&!t.altKey},Ps="data-mce-selected",wh=Math.abs,ei=Math.round,Gd={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},xh=(t,e)=>{const n=e.dom,r=e.getDoc(),o=document,s=e.getBody();let a,i,l,d,c,u,f,m,g,p,b,h,v,y,w;const x=et=>lt(et)&&(Wf(et)||n.is(et,"figure.image")),S=et=>yn(et)||n.hasClass(et,"mce-preview-object"),k=et=>{const ft=et.target;((ut,vt)=>{if("longpress"===(E=ut).type||0===E.type.indexOf("touch")){const E=ut.touches[0];return x(ut.target)&&!ph(E.clientX,E.clientY,vt)}var E;return x(ut.target)&&!ph(ut.clientX,ut.clientY,vt)})(et,e.selection.getRng())&&!et.isDefaultPrevented()&&e.selection.select(ft)},D=et=>n.is(et,"figure.image")?[et.querySelector("img")]:n.hasClass(et,"mce-preview-object")&&lt(et.firstElementChild)?[et,et.firstElementChild]:[et],B=et=>{const ft=mp(e);return!!ft&&"false"!==et.getAttribute("data-mce-resize")&&et!==e.getBody()&&(n.hasClass(et,"mce-preview-object")?hn(N(et.firstElementChild),ft):hn(N(et),ft))},M=(et,ft,ut)=>{if(lt(ut)){const vt=D(et);H(vt,E=>{E.style[ft]||!e.schema.isValid(E.nodeName.toLowerCase(),ft)?n.setStyle(E,ft,ut):n.setAttrib(E,ft,""+ut)})}},O=(et,ft,ut)=>{M(et,"width",ft),M(et,"height",ut)},P=et=>{let ft,ut,vt,E,_;ft=et.screenX-u,ut=et.screenY-f,h=ft*d[2]+m,v=ut*d[3]+g,h=h<5?5:h,v=v<5?5:v,vt=(x(a)||S(a))&&!1!==Xx(e)?!J.modifierPressed(et):J.modifierPressed(et),vt&&(wh(ft)>wh(ut)?(v=ei(h*p),h=ei(v/p)):(h=ei(v/p),v=ei(h*p))),O(i,h,v),E=d.startPos.x+ft,_=d.startPos.y+ut,E=E>0?E:0,_=_>0?_:0,n.setStyles(l,{left:E,top:_,display:"block"}),l.innerHTML=h+" &times; "+v,d[2]<0&&i.clientWidth<=h&&n.setStyle(i,"left",void 0+(m-h)),d[3]<0&&i.clientHeight<=v&&n.setStyle(i,"top",void 0+(g-v)),ft=s.scrollWidth-y,ut=s.scrollHeight-w,ft+ut!==0&&n.setStyles(l,{left:E-ft,top:_-ut}),b||(e.dispatch("ObjectResizeStart",{target:a,width:m,height:g,origin:"corner-"+d.name}),b=!0)},L=()=>{const et=b;b=!1,et&&(M(a,"width",h),M(a,"height",v)),n.unbind(r,"mousemove",P),n.unbind(r,"mouseup",L),o!==r&&(n.unbind(o,"mousemove",P),n.unbind(o,"mouseup",L)),n.remove(i),n.remove(l),n.remove(c),F(a),et&&(e.dispatch("ObjectResized",{target:a,width:h,height:v,origin:"corner-"+d.name}),n.setAttrib(a,"style",n.getAttrib(a,"style"))),e.nodeChanged()},F=et=>{bt();const ft=n.getPos(et,s),ut=ft.x,vt=ft.y,E=et.getBoundingClientRect(),_=E.width||E.right-E.left,A=E.height||E.bottom-E.top;a!==et&&(nt(),a=et,h=v=0);const R=e.dispatch("ObjectSelected",{target:et});B(et)&&!R.isDefaultPrevented()?At(Gd,(U,$)=>{let j;j=n.get("mceResizeHandle"+$),j&&n.remove(j),j=n.add(s,"div",{id:"mceResizeHandle"+$,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+$+"-resize; margin:0; padding:0"}),n.bind(j,"mousedown",W=>{W.stopImmediatePropagation(),W.preventDefault(),(Q=>{const ht=D(a)[0];var K;u=Q.screenX,f=Q.screenY,m=ht.clientWidth,g=ht.clientHeight,p=g/m,d=U,d.name=$,d.startPos={x:_*U[0]+ut,y:A*U[1]+vt},y=s.scrollWidth,w=s.scrollHeight,c=n.add(s,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),n.setStyles(c,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),i=S(K=a)?n.create("img",{src:Ct.transparentSrc}):K.cloneNode(!0),n.addClass(i,"mce-clonedresizable"),n.setAttrib(i,"data-mce-bogus","all"),i.contentEditable="false",n.setStyles(i,{left:ut,top:vt,margin:0}),O(i,_,A),i.removeAttribute(Ps),s.appendChild(i),n.bind(r,"mousemove",P),n.bind(r,"mouseup",L),o!==r&&(n.bind(o,"mousemove",P),n.bind(o,"mouseup",L)),l=n.add(s,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},m+" &times; "+g)})(W)}),U.elm=j,n.setStyles(j,{left:_*U[0]+ut-j.offsetWidth/2,top:A*U[1]+vt-j.offsetHeight/2})}):nt(!1)},V=La(F,0),nt=(et=!0)=>{V.cancel(),bt(),a&&et&&a.removeAttribute(Ps),At(Gd,(ft,ut)=>{const vt=n.get("mceResizeHandle"+ut);vt&&(n.unbind(vt),n.remove(vt))})},tt=(et,ft)=>lt(et)&&n.isChildOf(et,ft),it=et=>{if(b||e.removed||e.composing)return;const ft="mousedown"===et.type?et.target:t.getNode(),ut=kr(N(ft),"table,img,figure.image,hr,video,span.mce-preview-object").map(E=>E.dom).getOrUndefined(),vt=lt(ut)?n.getAttrib(ut,Ps,"1"):"1";if(H(n.select("img[data-mce-selected],hr[data-mce-selected]"),E=>{E.removeAttribute(Ps)}),tt(ut,s)){St();const E=t.getStart(!0);if(tt(E,ut)&&tt(t.getEnd(!0),ut))return n.setAttrib(ut,Ps,vt),void V.throttle(ut)}nt()},bt=()=>{At(Gd,et=>{et.elm&&(n.unbind(et.elm),delete et.elm)})},St=()=>{try{e.getDoc().execCommand("enableObjectResizing",!1,"false")}catch(et){}};return e.on("init",()=>{St(),e.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",it),e.on("keyup compositionend",et=>{a&&"TABLE"===a.nodeName&&it(et)}),e.on("hide blur",nt),e.on("contextmenu longpress",k,!0)}),e.on("remove",bt),{isResizable:B,showResizeRect:F,hideResizeRect:nt,updateResizeRect:it,destroy:()=>{V.cancel(),a=i=c=null}}},kh=(t,e,n)=>{const r=t.document.createRange();var o,s;return o=r,e.fold(s=>{o.setStartBefore(s.dom)},(s,a)=>{o.setStart(s.dom,a)},s=>{o.setStartAfter(s.dom)}),s=r,n.fold(i=>{s.setEndBefore(i.dom)},(i,l)=>{s.setEnd(i.dom,l)},i=>{s.setEndAfter(i.dom)}),r},Yd=(t,e,n,r,o)=>{const s=t.document.createRange();return s.setStart(e.dom,n),s.setEnd(r.dom,o),s},Ls=Cn([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Sh=(t,e,n)=>e(N(n.startContainer),n.startOffset,N(n.endContainer),n.endOffset),Eh=(t,e,n,r)=>({start:t,soffset:e,finish:n,foffset:r}),oS=document.caretPositionFromPoint?(t,e,n)=>{var r,o;return C.from(null===(o=(r=t.dom).caretPositionFromPoint)||void 0===o?void 0:o.call(r,e,n)).bind(s=>{if(null===s.offsetNode)return C.none();const a=t.dom.createRange();return a.setStart(s.offsetNode,s.offset),a.collapse(),C.some(a)})}:document.caretRangeFromPoint?(t,e,n)=>{var r,o;return C.from(null===(o=(r=t.dom).caretRangeFromPoint)||void 0===o?void 0:o.call(r,e,n))}:C.none,Xd=Cn([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Un={before:Xd.before,on:Xd.on,after:Xd.after,cata:(t,e,n,r)=>t.fold(e,n,r),getStart:t=>t.fold(pe,pe,pe)},ni=Cn([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),So={domRange:ni.domRange,relative:ni.relative,exact:ni.exact,exactFromRange:t=>ni.exact(t.start,t.soffset,t.finish,t.foffset),getWin:t=>{const e=t.match({domRange:r=>N(r.startContainer),relative:(r,o)=>Un.getStart(r),exact:(r,o,s,a)=>r});return Sf(e)},range:Eh},ri=(t,e)=>{const n=Tt(t);return"input"===n?Un.after(t):Ot(["br","img"],n)?0===e?Un.before(t):Un.after(t):Un.on(t,e)},sS=(t,e)=>{const n=t.fold(Un.before,ri,Un.after),r=e.fold(Un.before,ri,Un.after);return So.relative(n,r)},_h=(t,e,n,r)=>{const o=ri(t,e),s=ri(n,r);return So.relative(o,s)},Qd=(t,e)=>{const n=(e||document).createDocumentFragment();return H(t,r=>{n.appendChild(r.dom)}),N(n)},Nh=(t,e,n)=>{return(r=n.defaultView,o=t,s=e,((a,i,l)=>{const d=N(a.document);return oS(d,i,l).map(c=>Eh(N(c.startContainer),c.startOffset,N(c.endContainer),c.endOffset))})(r,o,s)).map(a=>{const i=n.createRange();return i.setStart(a.start.dom,a.soffset),i.setEnd(a.finish.dom,a.foffset),i}).getOrUndefined();var r,o,s},Jd=(t,e)=>t&&e&&t.startContainer===e.startContainer&&t.startOffset===e.startOffset&&t.endContainer===e.endContainer&&t.endOffset===e.endOffset,Rh=(t,e,n)=>null!==((r,o,s)=>{for(;r&&r!==o;){if(s(r))return r;r=r.parentNode}return null})(t,e,n),iS=(t,e,n)=>Rh(t,e,r=>r.nodeName===n),Zd=t=>t&&"TABLE"===t.nodeName,lS=t=>t&&/^(TD|TH|CAPTION)$/.test(t.nodeName),dS=(t,e)=>Ie(t)&&!1===Rh(t,e,En),Ah=(t,e,n)=>{const r=new zt(e,t.getParent(e.parentNode,t.isBlock)||t.getRoot());for(;e=r[n?"prev":"next"]();)if(Ft(e))return!0},tc=(t,e,n,r,o)=>{let s;const a=t.getRoot();let i;const l=t.schema.getNonEmptyElements(),d=t.getParent(o.parentNode,t.isBlock)||a;if(r&&Ft(o)&&e&&t.isEmpty(d))return C.some(I(o.parentNode,t.nodeIndex(o)));const c=new zt(o,d);for(;i=c[r?"prev":"next"]();){if("false"===t.getContentEditableParent(i)||dS(i,a))return C.none();if(G(i)&&i.nodeValue.length>0)return!1===iS(i,a,"A")?C.some(I(i,r?i.nodeValue.length:0)):C.none();if(t.isBlock(i)||l[i.nodeName.toLowerCase()])return C.none();s=i}return Kl(s)?C.none():n&&s?C.some(I(s,0)):C.none()},Oh=(t,e,n,r)=>{let o,s;const a=t.getRoot();let i,l,d=!1;o=r[(n?"start":"end")+"Container"],s=r[(n?"start":"end")+"Offset"];const c=rt(o)&&s===o.childNodes.length,u=t.schema.getNonEmptyElements();if(l=n,Ie(o))return C.none();if(rt(o)&&s>o.childNodes.length-1&&(l=!1),Gl(o)&&(o=a,s=0),o===a){if(l&&(i=o.childNodes[s>0?s-1:0],i)&&(Ie(i)||u[i.nodeName]||Zd(i)))return C.none();if(o.hasChildNodes()){if(s=Math.min(!l&&s>0?s-1:s,o.childNodes.length-1),o=o.childNodes[s],s=G(o)&&c?o.data.length:0,!e&&o===a.lastChild&&Zd(o)||((f,m)=>{for(;m&&m!==f;){if(Bt(m))return!0;m=m.parentNode}return!1})(a,o)||Ie(o))return C.none();if(o.hasChildNodes()&&!1===Zd(o)){i=o;const f=new zt(o,a);do{if(Bt(i)||Ie(i)){d=!1;break}if(G(i)&&i.nodeValue.length>0){s=l?0:i.nodeValue.length,o=i,d=!0;break}if(u[i.nodeName.toLowerCase()]&&!lS(i)){s=t.nodeIndex(i),o=i.parentNode,l||s++,d=!0;break}}while(i=l?f.next():f.prev())}}}return e&&(G(o)&&0===s&&tc(t,c,e,!0,o).each(f=>{o=f.container(),s=f.offset(),d=!0}),rt(o)&&(i=o.childNodes[s],i||(i=o.childNodes[s-1]),!i||!Ft(i)||(f=i).previousSibling&&"A"===f.previousSibling.nodeName||Ah(t,i,!1)||Ah(t,i,!0)||tc(t,c,e,!0,i).each(f=>{o=f.container(),s=f.offset(),d=!0}))),l&&!e&&G(o)&&s===o.nodeValue.length&&tc(t,c,e,!1,o).each(f=>{o=f.container(),s=f.offset(),d=!0}),d?C.some(I(o,s)):C.none();var f},oi=(t,e)=>{const n=e.collapsed,r=e.cloneRange(),o=I.fromRangeStart(e);return Oh(t,n,!0,r).each(s=>{n&&I.isAbove(o,s)||r.setStart(s.container(),s.offset())}),n||Oh(t,n,!1,r).each(s=>{r.setEnd(s.container(),s.offset())}),n&&r.collapse(!0),Jd(e,r)?C.none():C.some(r)},si=(t,e)=>t.splitText(e),ai=t=>{let e=t.startContainer,n=t.startOffset,r=t.endContainer,o=t.endOffset;return e===r&&G(e)?n>0&&n<e.nodeValue.length&&(r=si(e,n),e=r.previousSibling,o>n?(o-=n,e=r=si(r,o).previousSibling,o=r.nodeValue.length,n=0):o=0):(G(e)&&n>0&&n<e.nodeValue.length&&(e=si(e,n),n=0),G(r)&&o>0&&o<r.nodeValue.length&&(r=si(r,o).previousSibling,o=r.nodeValue.length)),{startContainer:e,startOffset:n,endContainer:r,endOffset:o}},Eo=t=>({walk:(e,n)=>Ts(t,e,n),split:ai,normalize:e=>oi(t,e).fold(Dt,n=>(e.setStart(n.startContainer,n.startOffset),e.setEnd(n.endContainer,n.endOffset),!0))});Eo.compareRanges=Jd,Eo.getCaretRangeFromPoint=Nh,Eo.getSelectedNode=Ma,Eo.getNode=tr;const cS=((t,e)=>{const n=o=>{const s=(a=>{const i=a.dom;return eo(a)?i.getBoundingClientRect().height:i.offsetHeight})(o);if(s<=0||null===s){const a=bn(o,t);return parseFloat(a)||0}return s},r=(o,s)=>Be(s,(a,i)=>{const l=bn(o,i),d=void 0===l?0:parseInt(l,10);return isNaN(d)?a:a+d},0);return{set:(o,s)=>{if(!mn(s)&&!s.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+s);const a=o.dom;rs(a)&&(a.style[t]=s+"px")},get:n,getOuter:n,aggregate:r,max:(o,s,a)=>{const i=r(o,a);return s>i?s-i:0}}})("height"),Th=()=>N(document),Bh=(t,e)=>t.view(e).fold(q([]),n=>{const r=t.owner(n),o=Bh(t,r);return[n].concat(o)});var uS=Object.freeze({__proto__:null,view:t=>{var e;return(t.dom===document?C.none():C.from(null===(e=t.dom.defaultView)||void 0===e?void 0:e.frameElement)).map(N)},owner:t=>Wn(t)});const ec=t=>"textarea"===Tt(t),Dh=(t,e)=>{const n=(o=>{const s=o.dom.ownerDocument,a=s.body,i=s.defaultView,l=s.documentElement;if(a===o.dom)return no(a.offsetLeft,a.offsetTop);const d=wa(null==i?void 0:i.pageYOffset,l.scrollTop),c=wa(null==i?void 0:i.pageXOffset,l.scrollLeft),u=wa(l.clientTop,a.clientTop),f=wa(l.clientLeft,a.clientLeft);return $l(o).translate(c-f,d-u)})(t),r=cS.get(t);return{element:t,bottom:n.top+r,height:r,pos:n,cleanup:e}},Ph=(t,e,n,r)=>{fS(t,(o,s)=>mS(t,e,n,r),n)},Lh=(t,e,n,r,o)=>{const s={elm:r.element.dom,alignToTop:o};t.dispatch("ScrollIntoView",s).isDefaultPrevented()||(n(e,ql(e).top,r,o),t.dispatch("AfterScrollIntoView",s))},mS=(t,e,n,r)=>{N(t.getBody());const s=N(t.getDoc()),a=((i,l)=>{const d=((u,f)=>{const m=se(u);if(0===m.length||ec(u))return{element:u,offset:f};if(f<m.length&&!ec(m[f]))return{element:m[f],offset:0};{const g=m[m.length-1];return ec(g)?{element:u,offset:f}:"img"===Tt(g)?{element:g,offset:1}:Le(g)?{element:g,offset:Wd(g).length}:{element:g,offset:se(g).length}}})(i,l),c=ss('<span data-mce-bogus="all" style="display: inline-block;">\ufeff</span>');return Xe(d.element,c),Dh(c,()=>Mt(c))})(N(n.startContainer),n.startOffset);Lh(t,s,e,a,r),a.cleanup()},Mh=(t,e,n,r)=>{const o=N(t.getDoc());Lh(t,o,n,Dh(N(e),pt),r)},fS=(t,e,n)=>{const r=n.startContainer,o=n.startOffset,s=n.endContainer,a=n.endOffset;e(N(r),N(s));const i=t.dom.createRng();i.setStart(r,o),i.setEnd(s,a),t.selection.setRng(n)},nc=(t,e,n,r)=>{const o=t.pos;zf(o.left,n?o.top:o.top-e+t.height,r)},Ih=(t,e,n,r,o)=>{const s=n+e,a=r.pos.top,i=r.bottom,l=i-a>=n;a<e?nc(r,n,!1!==o,t):a>s?nc(r,n,l?!1!==o:!0===o,t):i>s&&!l&&nc(r,n,!0===o,t)},Fh=(t,e,n,r)=>{Ih(t,e,t.dom.defaultView.innerHeight,n,r)},Uh=(t,e,n,r)=>{Ih(t,e,t.dom.defaultView.innerHeight,n,r);const s=(i=>{const l=Th(),d=ql(l),c=((m,g)=>{const p=g.owner(m);return Bh(g,p)})(i,uS),u=$l(i),f=fa(c,(m,g)=>{const p=$l(g);return{left:m.left+p.left,top:m.top+p.top}},{left:0,top:0});return no(f.left+u.left+d.left,f.top+u.top+d.top)})(n.element),a=Hf(window);s.top<a.y?jf(n.element,!1!==r):s.top>a.bottom&&jf(n.element,!0===r)},gS=(t,e,n)=>Ph(t,Fh,e,n),pS=(t,e,n)=>Mh(t,e,Fh,n),hS=(t,e,n)=>Ph(t,Uh,e,n),bS=(t,e,n)=>Mh(t,e,Uh,n),Ms=(t,e,n)=>{(t.inline?gS:hS)(t,e,n)},zh=t=>t.dom.focus(),jh=t=>{const e=vr(t).dom;return t.dom===e.activeElement},rc=(t=Th())=>C.from(t.dom.activeElement).map(N),Vh=(t,e)=>{const n=Le(e)?Wd(e).length:se(e).length+1;return t>n?n:t<0?0:t},vS=t=>So.range(t.start,Vh(t.soffset,t.start),t.finish,Vh(t.foffset,t.finish)),Hh=(t,e)=>!xa(e.dom)&&(Mn(t,e)||kt(t,e)),$h=t=>e=>Hh(t,e.start)&&Hh(t,e.finish),yS=t=>So.range(N(t.startContainer),t.startOffset,N(t.endContainer),t.endOffset),CS=t=>{const e=document.createRange();try{return e.setStart(t.start.dom,t.soffset),e.setEnd(t.finish.dom,t.foffset),C.some(e)}catch(n){return C.none()}},oc=t=>{const e=t.inline?(n=N(t.getBody()),(r=>{const o=r.getSelection();return(o&&0!==o.rangeCount?C.from(o.getRangeAt(0)):C.none()).map(yS)})(Sf(n).dom).filter($h(n))):C.none();var n;t.bookmark=e.isSome()?e:t.bookmark},sc=t=>(t.bookmark?t.bookmark:C.none()).bind(e=>{return n=N(t.getBody()),C.from(e).filter($h(n)).map(vS);var n}).bind(CS),qh={isEditorUIElement:t=>{const e=t.className.toString();return-1!==e.indexOf("tox-")||-1!==e.indexOf("mce-")}},je={setEditorTimeout:(t,e,n)=>{return mn(o=n)||(o=0),setTimeout(()=>{t.removed||e()},o);var o},setEditorInterval:(t,e,n)=>{const r=(mn(s=n)||(s=0),setInterval(()=>{t.removed?clearInterval(r):e()},s));var s;return r}};let Is;const ac=Et.DOM,ii=(t,e)=>{const n=ok(t);return null!==ac.getParent(e,o=>qh.isEditorUIElement(o)||!!n&&t.dom.is(o,n))},wS=(t,e)=>{const n=e.editor;(r=>{const o=La(()=>{oc(r)},0);r.on("init",()=>{var s,l;r.inline&&((s,a)=>{const i=()=>{a.throttle()};Et.DOM.bind(document,"mouseup",i),s.on("remove",()=>{Et.DOM.unbind(document,"mouseup",i)})})(r,o),l=o,(s=r).on("mouseup touchend",d=>{l.throttle()}),s.on("keyup NodeChange AfterSetSelectionRange",i=>{(l=>"nodechange"===l.type&&l.selectionChange)(i)||oc(s)})}),r.on("remove",()=>{o.cancel()})})(n),n.on("focusin",()=>{const r=t.focusedEditor;r!==n&&(r&&r.dispatch("blur",{focusedEditor:n}),t.setActive(n),t.focusedEditor=n,n.dispatch("focus",{blurredEditor:r}),n.focus(!0))}),n.on("focusout",()=>{je.setEditorTimeout(n,()=>{const r=t.focusedEditor;ii(n,(o=>{try{const s=vr(N(o.getElement()));return rc(s).fold(()=>document.body,a=>a.dom)}catch(s){return document.body}})(n))||r!==n||(n.dispatch("blur",{focusedEditor:null}),t.focusedEditor=null)})}),Is||(Is=r=>{const o=t.activeEditor;o&&Tf(r).each(s=>{s.ownerDocument===document&&(s===document.body||ii(o,s)||t.focusedEditor!==o||(o.dispatch("blur",{focusedEditor:null}),t.focusedEditor=null))})},ac.bind(document,"focusin",Is))},xS=(t,e)=>{t.focusedEditor===e.editor&&(t.focusedEditor=null),t.activeEditor||(ac.unbind(document,"focusin",Is),Is=null)},Wh=(t,e)=>{var n,r,o;(n=N(t.getBody()),r=e,(o=r,o.collapsed?C.from(tr(o.startContainer,o.startOffset)).map(N):C.none()).bind(o=>Vw(o)?C.some(o):!1===Mn(n,o)?C.some(n):C.none())).bind(n=>be(n.dom)).fold(()=>{t.selection.normalize()},n=>t.selection.setRng(n.toRange()))},ic=t=>{if(t.setActive)try{t.setActive()}catch(e){t.focus()}else t.focus()},Lr=t=>{return t.inline?(e=>{const n=e.getBody();return n&&(r=N(n),jh(r)||(o=r,rc(vr(o)).filter(s=>o.dom.contains(s.dom))).isSome());var r,o})(t):(e=t).iframeElement&&jh(N(e.iframeElement));var e},lc=t=>t.editorManager.setActive(t),Kh=(t,e,n,r,o)=>{const a=n?e.startOffset:e.endOffset;return C.from(n?e.startContainer:e.endContainer).map(N).map(i=>r&&e.collapsed?i:va(i,o(i,a)).getOr(i)).bind(i=>Ge(i)?C.some(i):Ye(i).filter(Ge)).map(i=>i.dom).getOr(t)},Gh=(t,e,n)=>Kh(t,e,!0,n,(r,o)=>Math.min(Rf(r),o)),Yh=(t,e,n)=>Kh(t,e,!1,n,(r,o)=>o>0?o-1:o),Xh=(t,e)=>{const n=t;for(;t&&G(t)&&0===t.length;)t=e?t.nextSibling:t.previousSibling;return t||n},dc=(t,e)=>yt(e,n=>{const r=t.dispatch("GetSelectionRange",{range:n});return r.range!==n?r.range:n}),kS=["img","br"],Qh=t=>uh(t).filter(n=>0!==n.trim().length||n.indexOf(ae)>-1).isSome()||Ot(kS,Tt(t)),Jh="[data-mce-autocompleter]",Zh=t=>us(t,Jh),ES={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},li=(t,e,n)=>{const r=n?"lastChild":"firstChild",o=n?"prev":"next";if(t[r])return t[r];if(t!==e){let s=t[o];if(s)return s;for(let a=t.parent;a&&a!==e;a=a.parent)if(s=a[o],s)return s}},_S=t=>{if(!Sr(t.value))return!1;const e=t.parent;return!e||"span"===e.name&&!e.attr("style")||!/^[ ]+$/.test(t.value)},tb=t=>{const e="a"===t.name&&!t.attr("href")&&t.attr("id");return t.attr("name")||t.attr("id")&&!t.firstChild||t.attr("data-mce-bookmark")||e};class ve{constructor(e,n){this.name=e,this.type=n,1===n&&(this.attributes=[],this.attributes.map={})}static create(e,n){const r=new ve(e,ES[e]||1);return n&&At(n,(o,s)=>{r.attr(s,o)}),r}replace(e){const n=this;return e.parent&&e.remove(),n.insert(e,n),n.remove(),n}attr(e,n){const r=this;let o;if("string"!=typeof e)return null!=e&&At(e,(s,a)=>{r.attr(a,s)}),r;if(o=r.attributes){if(void 0!==n){if(null===n){if(e in o.map){delete o.map[e];let s=o.length;for(;s--;)if(o[s].name===e)return o.splice(s,1),r}return r}if(e in o.map){let s=o.length;for(;s--;)if(o[s].name===e){o[s].value=n;break}}else o.push({name:e,value:n});return o.map[e]=n,r}return o.map[e]}}clone(){const e=this,n=new ve(e.name,e.type);let r;if(r=e.attributes){const o=[];o.map={};for(let s=0,a=r.length;s<a;s++){const i=r[s];"id"!==i.name&&(o[o.length]={name:i.name,value:i.value},o.map[i.name]=i.value)}n.attributes=o}return n.value=e.value,n}wrap(e){const n=this;return n.parent.insert(e,n),e.append(n),n}unwrap(){const e=this;for(let n=e.firstChild;n;){const r=n.next;e.insert(n,e,!0),n=r}e.remove()}remove(){const e=this,n=e.parent,r=e.next,o=e.prev;return n&&(n.firstChild===e?(n.firstChild=r,r&&(r.prev=null)):o.next=r,n.lastChild===e?(n.lastChild=o,o&&(o.next=null)):r.prev=o,e.parent=e.next=e.prev=null),e}append(e){const n=this;e.parent&&e.remove();const r=n.lastChild;return r?(r.next=e,e.prev=r,n.lastChild=e):n.lastChild=n.firstChild=e,e.parent=n,e}insert(e,n,r){e.parent&&e.remove();const o=n.parent||this;return r?(n===o.firstChild?o.firstChild=e:n.prev.next=e,e.prev=n.prev,e.next=n,n.prev=e):(n===o.lastChild?o.lastChild=e:n.next.prev=e,e.next=n.next,e.prev=n,n.next=e),e.parent=o,e}getAll(e){const n=this,r=[];for(let o=n.firstChild;o;o=li(o,n))o.name===e&&r.push(o);return r}children(){const e=[];for(let n=this.firstChild;n;n=n.next)e.push(n);return e}empty(){const e=this;if(e.firstChild){const n=[];for(let o=e.firstChild;o;o=li(o,e))n.push(o);let r=n.length;for(;r--;){const o=n[r];o.parent=o.firstChild=o.lastChild=o.next=o.prev=null}}return e.firstChild=e.lastChild=null,e}isEmpty(e,n={},r){const o=this;let s=o.firstChild;if(tb(o))return!1;if(s)do{if(1===s.type){if(s.attr("data-mce-bogus"))continue;if(e[s.name]||tb(s))return!1}if(8===s.type||3===s.type&&!_S(s)||3===s.type&&s.parent&&n[s.parent.name]&&Sr(s.value)||r&&r(s))return!1}while(s=li(s,o));return!0}walk(e){return li(this,null,e)}}const eb=(t,e,n=0)=>{const r=t.toLowerCase();if(-1!==r.indexOf("[if ",n)&&/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(r.substr(n))){const o=r.indexOf("[endif]",n);return r.indexOf(">",o)}if(e){const o=r.indexOf(">",n);return-1!==o?o:r.length}{const o=/--!?>/g;o.lastIndex=n;const s=o.exec(t);return s?s.index+s[0].length:r.length}},NS=(t,e,n)=>{const r=/<([!?\/])?([A-Za-z0-9\-_:.]+)/g,o=/(?:\s(?:[^'">]+(?:"[^"]*"|'[^']*'))*[^"'>]*(?:"[^">]*|'[^'>]*)?|\s*|\/)>/g,s=t.getVoidElements();let a=1,i=n;for(;0!==a;)for(r.lastIndex=i;;){const l=r.exec(e);if(null===l)return i;if("!"===l[1]){i=ne(l[2],"--")?eb(e,!1,l.index+"!--".length):eb(e,!0,l.index+1);break}{o.lastIndex=r.lastIndex;const d=o.exec(e);if($o(d)||d.index!==r.lastIndex)continue;"/"===l[1]?a-=1:gt(s,l[2])||(a+=1),i=r.lastIndex+d[0].length;break}}return i},nb=(t,e)=>{const n=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,r=t.schema;let o=((i,l)=>{const d=new RegExp(["\\s?("+i.join("|")+')="[^"]+"'].join("|"),"gi");return l.replace(d,"")})(t.getTempAttrs(),e);const s=r.getVoidElements();let a;for(;a=n.exec(o);){const i=n.lastIndex,l=a[0].length;let d;d=s[a[1]]?i:NS(r,o,i),o=o.substring(0,i-l)+o.substring(d),n.lastIndex=i-l}return Yn(o)},RS=nb,AS=z.each,rb=t=>({compare:(e,n)=>{if(e.nodeName!==n.nodeName)return!1;const r=s=>{const a={};return AS(t.getAttribs(s),i=>{const l=i.nodeName.toLowerCase();0!==l.indexOf("_")&&"style"!==l&&0!==l.indexOf("data-")&&(a[l]=t.getAttrib(s,l))}),a},o=(s,a)=>{let i,l;for(l in s)if(gt(s,l)){if(i=a[l],void 0===i||s[l]!==i)return!1;delete a[l]}for(l in a)if(gt(a,l))return!1;return!0};return!(!o(r(e),r(n))||!o(t.parseStyle(t.getAttrib(e,"style")),t.parseStyle(t.getAttrib(n,"style")))||ze(e)||ze(n))}}),ob=z.makeMap,sb=t=>{const e=[],n=(t=t||{}).indent,r=ob(t.indent_before||""),o=ob(t.indent_after||""),s=Xn.getEncodeFunc(t.entity_encoding||"raw",t.entities),a="xhtml"!==t.element_format;return{start:(i,l,d)=>{let c,u,f,m;if(n&&r[i]&&e.length>0&&(m=e[e.length-1],m.length>0&&"\n"!==m&&e.push("\n")),e.push("<",i),l)for(c=0,u=l.length;c<u;c++)f=l[c],e.push(" ",f.name,'="',s(f.value,!0),'"');e[e.length]=!d||a?">":" />",d&&n&&o[i]&&e.length>0&&(m=e[e.length-1],m.length>0&&"\n"!==m&&e.push("\n"))},end:i=>{let l;e.push("</",i,">"),n&&o[i]&&e.length>0&&(l=e[e.length-1],l.length>0&&"\n"!==l&&e.push("\n"))},text:(i,l)=>{i.length>0&&(e[e.length]=l?i:s(i))},cdata:i=>{e.push("<![CDATA[",i,"]]>")},comment:i=>{e.push("\x3c!--",i,"--\x3e")},pi:(i,l)=>{l?e.push("<?",i," ",s(l),"?>"):e.push("<?",i,"?>"),n&&e.push("\n")},doctype:i=>{e.push("<!DOCTYPE",i,">",n?"\n":"")},reset:()=>{e.length=0},getContent:()=>e.join("").replace(/\n$/,"")}},rr=(t,e=Jn())=>{const n=sb(t);return(t=t||{}).validate=!("validate"in t)||t.validate,{serialize:r=>{const o=t.validate,s={3:i=>{n.text(i.value,i.raw)},8:i=>{n.comment(i.value)},7:i=>{n.pi(i.name,i.value)},10:i=>{n.doctype(i.value)},4:i=>{n.cdata(i.value)},11:i=>{if(i=i.firstChild)do{a(i)}while(i=i.next)}};n.reset();const a=i=>{const l=s[i.type];if(l)l(i);else{const d=i.name,c=d in e.getVoidElements();let u=i.attributes;if(o&&u&&u.length>1){const f=[];f.map={};const m=e.getElementRule(i.name);if(m){for(let g=0,p=m.attributesOrder.length;g<p;g++){const b=m.attributesOrder[g];if(b in u.map){const h=u.map[b];f.map[b]=h,f.push({name:b,value:h})}}for(let g=0,p=u.length;g<p;g++){const b=u[g].name;if(!(b in f.map)){const h=u.map[b];f.map[b]=h,f.push({name:b,value:h})}}u=f}}if(n.start(d,u,c),!c){let f=i.firstChild;if(f){"pre"!==d&&"textarea"!==d||3!==f.type||"\n"!==f.value[0]||n.text("\n",!0);do{a(f)}while(f=f.next)}n.end(d)}}};return 1!==r.type||t.inner?3===r.type?s[3](r):s[11](r):a(r),n.getContent()}}},ab=new Set;H(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],t=>{ab.add(t)});const ib=["font","text-decoration","text-emphasis"],cc=(t,e)=>Ke(t.parseStyle(t.getAttrib(e,"style"))),OS=(t,e,n)=>{const r=cc(t,e),o=cc(t,n),s=a=>{var i,l;const d=null!==(i=t.getStyle(e,a))&&void 0!==i?i:"",c=null!==(l=t.getStyle(n,a))&&void 0!==l?l:"";return Pn(d)&&Pn(c)&&d!==c};return It(r,a=>{const i=l=>It(l,d=>d===a);if(!i(o)&&i(ib)){const l=dt(o,d=>It(ib,c=>ne(d,c)));return It(l,s)}return s(a)})},lb=(t,e,n)=>C.from(n.container()).filter(G).exists(r=>{const o=t?0:-1;return e(r.data.charAt(n.offset()+o))}),uc=Y(lb,!0,Os),mc=Y(lb,!1,Os),TS=t=>{const e=t.container();return G(e)&&(0===e.data.length||Ra(e.data)&&Ds.isBookmarkNode(e.parentNode))},or=(t,e)=>n=>C.from(Nd(t?0:-1,n)).filter(e).isSome(),db=t=>Wf(t)&&"block"===bn(N(t),"display"),cb=t=>{return Bt(t)&&!(rt(e=t)&&"all"===e.getAttribute("data-mce-bogus"));var e},BS=or(!0,db),DS=or(!1,db),Fs=or(!0,yn),Us=or(!1,yn),ub=or(!0,ds),mb=or(!1,ds),sr=or(!0,cb),ar=or(!1,cb),Mr=t=>{ls(t),Ht(t,ss('<br data-mce-bogus="1">'))},PS=t=>{jl(t).each(e=>{br(e).each(n=>{en(t)&&so(e)&&en(n)&&Mt(e)})})},fb=(t,e)=>{return o=Dt,Mn(r=e,n=t)?((a,i)=>{const l=xt(i)?i:Dt;let d=a.dom;const c=[];for(;null!=d.parentNode;){const u=d.parentNode,f=N(u);if(c.push(f),!0===l(f))break;d=u}return c})(n,a=>o(a)||kt(a,r)).slice(0,-1):[];var n,r,o},zn=(t,e)=>[t].concat(fb(t,e)),fc=(t,e,n)=>zp(t,e,n,TS),gb=(t,e)=>Gt(zn(N(e.container()),t),en),pb=(t,e,n)=>fc(t,e.dom,n).forall(r=>gb(e,n).fold(()=>!1===wn(r,n,e.dom),o=>!1===wn(r,n,e.dom)&&Mn(o,N(r.container())))),hb=(t,e,n)=>gb(e,n).fold(()=>fc(t,e.dom,n).forall(r=>!1===wn(r,n,e.dom)),r=>fc(t,r.dom,n).isNone()),gc=Y(hb,!1),bb=Y(hb,!0),LS=Y(pb,!1),MS=Y(pb,!0),IS=t=>Ha(t).exists(so),di=(t,e,n)=>{const r=dt(zn(N(n.container()),e),en),o=De(r).getOr(e);return Fe(t,o.dom,n).filter(IS)},pc=(t,e)=>Ha(e).exists(so)||di(!0,t,e).isSome(),hc=(t,e)=>{return(n=e,C.from(n.getNode(!0)).map(N)).exists(so)||di(!1,t,e).isSome();var n},FS=Y(di,!1),US=Y(di,!0),vb=t=>I.isTextPosition(t)&&!t.isAtStart()&&!t.isAtEnd(),yb=(t,e)=>{const n=dt(zn(N(e.container()),t),en);return De(n).getOr(t)},Cb=(t,e)=>vb(e)?mc(e):mc(e)||on(yb(t,e).dom,e).exists(mc),wb=(t,e)=>vb(e)?uc(e):uc(e)||Ue(yb(t,e).dom,e).exists(uc),bc=t=>Ha(t).bind(e=>oo(e,Ge)).exists(e=>{return n=bn(e,"white-space"),Ot(["pre","pre-wrap"],n);var n}),ci=(t,e)=>!bc(e)&&(gc(t,e)||LS(t,e)||hc(t,e)||Cb(t,e)),ui=(t,e)=>!bc(e)&&(bb(t,e)||MS(t,e)||pc(t,e)||wb(t,e)||((n,r)=>{const o=Ue(n.dom,r).getOr(r),s=(a=n.dom,i=>{return l=new zt(i,a).next(),lt(l)&&Bt(l)&&_p(l);var l});var a;return r.isAtEnd()&&(s(r.container())||s(o.container()))})(t,e)),xb=(t,e)=>ci(t,e)||ui(t,(n=>{const r=n.container(),o=n.offset();return G(r)&&o<r.data.length?I(r,o+1):n})(e)),kb=(t,e)=>Ga(t.charAt(e)),zS=t=>{const e=t.container();return G(e)&&de(e.data,ae)},Sb=(t,e,n)=>{if(0===n)return;const r=N(t),o=ro(r,en).getOr(r),s=t.data.slice(e,e+n),a=e+n>=t.data.length&&ui(o,I(t,t.data.length)),i=0===e&&ci(o,I(t,0));t.replaceData(e,n,ag(s,4,i,a))},mi=(t,e)=>{const n=t.data.slice(e),r=n.length-hw(n).length;Sb(t,e,r)},vc=(t,e)=>{const n=t.data.slice(0,e),r=n.length-Km(n).length;Sb(t,e-r,r)},yc=(t,e,n,r=!0)=>{const o=Km(t.data).length,s=r?t:e,a=r?e:t;return r?s.appendData(a.data):s.insertData(0,a.data),Mt(N(a)),n&&mi(s,o),s},VS=(t,e)=>((n,r)=>{const o=n.container(),s=n.offset();return!1===I.isTextPosition(n)&&o===r.parentNode&&s>I.before(r).offset()})(e,t)?I(e.container(),e.offset()-1):e,Eb=t=>{return Je(t.previousSibling)?C.some(G(e=t.previousSibling)?I(e,e.data.length):I.after(e)):t.previousSibling?Sn(t.previousSibling):C.none();var e},_b=t=>{return Je(t.nextSibling)?C.some(G(e=t.nextSibling)?I(e,0):I.before(e)):t.nextSibling?be(t.nextSibling):C.none();var e},Nb=(t,e,n)=>{n.fold(()=>{t.focus()},r=>{t.selection.setRng(r.toRange(),e)})},$S=(t,e)=>e&&gt(t.schema.getBlockElements(),Tt(e)),qS=t=>{if(Yt(t)){const e=ss('<br data-mce-bogus="1">');return ls(t),Ht(t,e),C.some(I.before(e.dom))}return C.none()},Ir=(t,e,n,r=!0)=>{const o=((t,e,n)=>{return(r=t,o=e,s=n,r?(a=o,_b(i=s).orThunk(()=>Eb(i)).orThunk(()=>{return Ue(l=a,I.after(d=i)).fold(()=>on(l,I.before(d)),C.some);var l,d})):((a,i)=>Eb(i).orThunk(()=>_b(i)).orThunk(()=>((l,d)=>{const c=I.before(d.previousSibling?d.previousSibling:d.parentNode);return on(l,c).fold(()=>Ue(l,I.after(d)),C.some)})(a,i)))(o,s)).map(Y(VS,n));var r,o,s,a,i})(e,t.getBody(),n.dom),s=ro(n,Y($S,t),(a=t.getBody(),l=>l.dom===a));var a;const i=((l,d,c)=>{const u=br(l).filter(Le),f=is(l).filter(Le);return Mt(l),(m=u,g=f,p=d,b=(h,v,y)=>{const w=h.dom,x=v.dom,S=w.data.length;return yc(w,x,c),y.container()===x?I(w,S):y},m.isSome()&&g.isSome()&&p.isSome()?C.some(b(m.getOrDie(),g.getOrDie(),p.getOrDie())):C.none()).orThunk(()=>(c&&(u.each(h=>vc(h.dom,h.dom.length)),f.each(h=>mi(h.dom,0))),d));var m,g,p,b})(n,o,(d=n,gt(t.schema.getTextInlineElements(),Tt(d))));var d;t.dom.isEmpty(t.getBody())?(t.setContent(""),t.selection.setCursorLocation()):s.bind(qS).fold(()=>{r&&Nb(t,e,i)},l=>{r&&Nb(t,e,C.some(l))})},WS=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,Fr=(t,e)=>hn(N(e),Yx(t)),ir=(t,e,n)=>{const r=(o=t,s=e,dt(Et.DOM.getParents(n.container(),"*",s),o));var o,s;return C.from(r[r.length-1])},Ve=(t,e)=>{if(!e)return e;const n=e.container(),r=e.offset();return t?lo(n)?G(n.nextSibling)?I(n.nextSibling,0):I.after(n):Jl(e)?I(n,r+1):e:lo(n)?G(n.previousSibling)?I(n.previousSibling,n.previousSibling.data.length):I.before(n):Zl(e)?I(n,r-1):e},Rb=Y(Ve,!0),Ab=Y(Ve,!1),Ob=(t,e)=>{const n=r=>r.stopImmediatePropagation();t.on("beforeinput input",n,!0),t.getDoc().execCommand(e),t.off("beforeinput input",n)},Cc=t=>Ob(t,"Delete"),KS=t=>jw(t)||ms(t),fi=(t,e)=>{return Mn(t,e)?oo(e,KS,(n=t,r=>kt(n,N(r.dom.parentNode)))):C.none();var n},Tb=t=>{t.dom.isEmpty(t.getBody())&&(t.setContent(""),(e=>{const n=e.getBody(),r=n.firstChild&&e.dom.isBlock(n.firstChild)?n.firstChild:n;e.selection.setCursorLocation(r,0)})(t))},Bb=t=>{var e;return(8===ff(e=t)||"#comment"===Tt(e)?br(t):jl(t)).bind(Bb).orThunk(()=>C.some(t))},Db=(t,e,n,r=!0)=>{e.deleteContents();const o=Bb(n).getOr(n),s=N(t.dom.getParent(o.dom,t.dom.isBlock));if(Yt(s)&&(Mr(s),r&&t.selection.setCursorLocation(s.dom,0)),!kt(n,s)){const i=Zr(Ye(s),n)?[]:Ye(a=s).map(se).map(l=>dt(l,d=>!kt(a,d))).getOr([]);H(i.concat(se(n)),l=>{kt(l,s)||Mn(l,s)||!Yt(l)||Mt(l)})}var a},wc=t=>Ee(t,"td,th"),xc=(t,e)=>({start:t,end:e}),zs=Cn([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),gi=(t,e)=>kr(N(t),"td,th",e),Pb=t=>!kt(t.start,t.end),Lb=(t,e)=>Bs(t.start,e).bind(n=>Bs(t.end,e).bind(r=>Fl(kt(n,r),n))),kc=t=>e=>Lb(e,t).map(n=>({rng:e,table:n,cells:wc(n)})),Mb=(t,e,n,r)=>{if(n.collapsed||!t.forall(Pb))return C.none();if(e.isSameTable){const o=t.bind(kc(r));return C.some({start:o,end:o})}{const o=gi(n.startContainer,r),s=gi(n.endContainer,r),a=o.bind((l=r,d=>Bs(d,l).bind(c=>Gr(wc(c)).map(u=>xc(d,u))))).bind(kc(r)),i=s.bind((l=>d=>Bs(d,l).bind(c=>De(wc(c)).map(u=>xc(u,d))))(r)).bind(kc(r));return C.some({start:a,end:i})}var l},Ib=(t,e)=>Ko(t,n=>kt(n,e)),Sc=t=>Se(Ib(t.cells,t.rng.start),Ib(t.cells,t.rng.end),(e,n)=>t.cells.slice(e,n+1)),Fb=(t,e)=>{const{startTable:n,endTable:r}=e,o=t.cloneRange();return n.each(s=>o.setStartAfter(s.dom)),r.each(s=>o.setEndBefore(s.dom)),o},Ub=t=>H(t,e=>{oe(e,"contenteditable"),Mr(e)}),Ec=(t,e,n,r)=>{const o=n.cloneRange();r?(o.setStart(n.startContainer,n.startOffset),o.setEndAfter(e.dom.lastChild)):(o.setStartBefore(e.dom.firstChild),o.setEnd(n.endContainer,n.endOffset)),_c(t,o,e,!1).each(s=>s())},zb=t=>{const e=ko(t),n=N(t.selection.getNode());Sa(n.dom)&&Yt(n)?t.selection.setCursorLocation(n.dom,0):t.selection.collapse(!0),e.length>1&&It(e,r=>kt(r,n))&&re(n,"data-mce-selected","1")},jb=(t,e,n)=>C.some(()=>{const r=t.selection.getRng(),o=n.bind(({rng:s,isStartInTable:a})=>{const i=C.from((d=t).dom.getParent(a?s.endContainer:s.startContainer,d.dom.isBlock)).map(N);var d;s.deleteContents(),((d,c,u)=>{u.each(f=>{c?Mt(f):(Mr(f),d.selection.setCursorLocation(f.dom,0))})})(t,a,i.filter(Yt));const l=a?e[0]:e[e.length-1];return Ec(t,l,r,a),Yt(l)?C.none():C.some(a?e.slice(1):e.slice(0,-1))}).getOr(e);Ub(o),zb(t)}),YS=(t,e,n,r)=>C.some(()=>{const o=t.selection.getRng(),s=e[0],a=n[n.length-1];Ec(t,s,o,!0),Ec(t,a,o,!1);const i=Yt(s)?e:e.slice(1),l=Yt(a)?n:n.slice(0,-1);Ub(i.concat(l)),r.deleteContents(),zb(t)}),_c=(t,e,n,r=!0)=>C.some(()=>{Db(t,e,n,r)}),XS=(t,e)=>C.some(()=>Ir(t,!1,e)),Vb=(t,e)=>Gt(zn(e,t),Ea),Nc=(t,e)=>Gt(zn(e,t),gf("caption")),pi=(t,e)=>C.some(()=>{Mr(e),t.selection.setCursorLocation(e.dom,0)}),Hb=(t,e)=>t?ub(e):mb(e),Rc=(t,e)=>{const n=N(t.selection.getStart(!0)),r=ko(t);return t.selection.isCollapsed()&&0===r.length?((t,e,n)=>{const r=N(t.getBody());return Nc(r,n).fold(()=>((o,s,a,i)=>{const l=I.fromRangeStart(o.selection.getRng());return Vb(a,i).bind(d=>{return Yt(d)?pi(o,d):(u=a,m=d,g=l,Wa(s,o.getBody(),g).bind(p=>Vb(u,N(p.getNode())).bind(b=>kt(b,m)?C.none():C.some(pt))));var u,m,g})})(t,e,r,n).orThunk(()=>Fl(((o,s)=>{const a=I.fromRangeStart(o.selection.getRng());return Hb(s,a)||Fe(s,o.getBody(),a).exists(i=>Hb(s,i))})(t,e),pt)),o=>((s,a,i,l)=>{const d=I.fromRangeStart(s.selection.getRng());return Yt(l)?pi(s,l):(u=i,m=l,g=d,Wa(f=a,(c=s).getBody(),g).fold(()=>C.some(pt),p=>{return h=f,v=g,y=p,be((b=m).dom).bind(w=>Sn(b.dom).map(x=>h?v.isEqual(w)&&y.isEqual(x):v.isEqual(x)&&y.isEqual(w))).getOr(!0)?((b,h)=>pi(b,h))(c,m):((b,h,v)=>Nc(b,N(v.getNode())).fold(()=>C.some(pt),y=>Fl(!kt(y,h),pt)))(u,m,p);var b,h,v,y}));var c,u,f,m,g})(t,e,r,o))})(t,e,n):((o,s,a)=>{const i=N(o.getBody()),l=o.selection.getRng();return 0!==a.length?jb(o,a,C.none()):(d=o,u=l,Nc(c=i,s).fold(()=>{return m=d,((t,e)=>{const n=(s=t,a=>kt(s,a)),r=((s,a)=>{const i=gi(s.startContainer,a),l=gi(s.endContainer,a);return Se(i,l,xc)})(e,n),o=((s,a)=>{const i=m=>Bs(N(m),a),l=i(s.startContainer),d=i(s.endContainer),c=l.isSome(),u=d.isSome(),f=Se(l,d,kt).getOr(!1);return{startTable:l,endTable:d,isStartInTable:c,isEndInTable:u,isSameTable:f,isMultiTable:!f&&c&&u}})(e,n);var s;return((s,a,i)=>s.exists(l=>{return c=i,!Pb(d=l)&&Lb(d,c).exists(u=>{const f=u.dom.rows;return 1===f.length&&1===f[0].cells.length})&&Vd(l.start,a);var d,c}))(r,e,n)?r.map(s=>zs.singleCellTable(e,s.start)):o.isMultiTable?((s,a,i,l)=>Mb(s,a,i,l).bind(({start:d,end:c})=>{const u=d.bind(Sc).getOr([]),f=c.bind(Sc).getOr([]);if(u.length>0&&f.length>0){const m=Fb(i,a);return C.some(zs.multiTable(u,f,m))}return C.none()}))(r,o,e,n):((s,a,i,l)=>Mb(s,a,i,l).bind(({start:d,end:c})=>d.or(c)).bind(d=>{const{isSameTable:c}=a,u=Sc(d).getOr([]);if(c&&d.cells.length===u.length)return C.some(zs.fullTable(d.table));if(u.length>0){if(c)return C.some(zs.partialTable(u,C.none()));{const f=Fb(i,a);return C.some(zs.partialTable(u,C.some(Rt(at({},a),{rng:f}))))}}return C.none()}))(r,o,e,n)})(c,u).bind(b=>b.fold(Y(_c,m),Y(XS,m),Y(jb,m),Y(YS,m)));var m},m=>pi(d,m)));var d,c,u})(t,n,r)},js=(t,e)=>{for(;e&&e!==t;){if(vn(e)||Bt(e))return e;e=e.parentNode}return null},Ac=(t,e)=>{e(t),t.firstChild&&Ac(t.firstChild,e),t.next&&Ac(t.next,e)},$b=(t,e,n,r)=>{const o=n.name;for(let s=0,a=t.length;s<a;s++){const i=t[s];if(i.name===o){const l=r.nodes[o];l?l.nodes.push(n):r.nodes[o]={filter:i,nodes:[n]}}}if(n.attributes)for(let s=0,a=e.length;s<a;s++){const i=e[s],l=i.name;if(l in n.attributes.map){const d=r.attributes[l];d?d.nodes.push(n):r.attributes[l]={filter:i,nodes:[n]}}}},qb=(t,e)=>{const n=r=>{At(r,o=>{const s=dt(o.nodes,a=>lt(a.parent));H(o.filter.callbacks,a=>{a(s,o.filter.name,e)})})};n(t.nodes),n(t.attributes)},Wb=(t,e,n,r={})=>{const o=((s,a,i)=>{const l={nodes:{},attributes:{}};return i.firstChild&&Ac(i.firstChild,d=>{$b(s,a,d,l)}),l})(t,e,n);qb(o,r)},Oc=(t,e,n,r)=>{e.insert&&n[r.name]?r.empty().append(new ve("br",1)):r.empty().append(new ve("#text",3)).value=ae},Kb=(t,e)=>t&&t.firstChild&&t.firstChild===t.lastChild&&t.firstChild.name===e,Vs=(t,e,n,r)=>r.isEmpty(e,n,o=>((s,a)=>{const i=s.getElementRule(a.name);return i&&i.paddEmpty})(t,o)),Tc=(t,e,n=t.parent)=>{if(e.getSpecialElements()[t.name])t.empty().remove();else{const r=t.children();for(const o of r)e.isValidChild(n.name,o.name)||Tc(o,e,n);t.unwrap()}},Bc=(t,e,n=pt)=>{const r=e.getTextBlockElements(),o=e.getNonEmptyElements(),s=e.getWhitespaceElements(),a=z.makeMap("tr,td,th,tbody,thead,tfoot,table"),i=new Set;for(let l=0;l<t.length;l++){const d=t[l];let c,u,f;if(!d.parent||i.has(d))continue;if(r[d.name]&&"li"===d.parent.name){let g=d.next;for(;g&&r[g.name];)g.name="li",i.add(g),d.parent.insert(g,d.parent),g=g.next;d.unwrap();continue}const m=[d];for(c=d.parent;c&&!e.isValidChild(c.name,d.name)&&!a[c.name];c=c.parent)m.push(c);if(c&&m.length>1)if(e.isValidChild(c.name,d.name)){m.reverse(),u=m[0].clone(),n(u);let g=u;for(let p=0;p<m.length-1;p++){e.isValidChild(g.name,m[p].name)?(f=m[p].clone(),n(f),g.append(f)):f=g;for(let b=m[p].firstChild;b&&b!==m[p+1];){const h=b.next;f.append(b),b=h}g=f}Vs(e,o,s,u)?c.insert(d,m[0],!0):(c.insert(u,m[0],!0),c.insert(d,u)),c=m[0],(Vs(e,o,s,c)||Kb(c,"br"))&&c.empty().remove()}else Tc(d,e);else if(d.parent){if("li"===d.name){let g=d.prev;if(g&&("ul"===g.name||"ol"===g.name)){g.append(d);continue}if(g=d.next,g&&("ul"===g.name||"ol"===g.name)){g.insert(d,g.firstChild,!0);continue}const p=new ve("ul",1);n(p),d.wrap(p);continue}if(e.isValidChild(d.parent.name,"div")&&e.isValidChild("div",d.name)){const g=new ve("div",1);n(g),d.wrap(g)}else Tc(d,e)}}},Dc=t=>t.collapsed?t:(e=>{const n=I.fromRangeStart(e),r=I.fromRangeEnd(e),o=e.commonAncestorContainer;return Fe(!1,o,r).map(s=>!wn(n,r,o)&&wn(n,s,o)?((a,i,l,d)=>{const c=document.createRange();return c.setStart(a,i),c.setEnd(l,d),c})(n.container(),n.offset(),s.container(),s.offset()):e).getOr(e)})(t),Pc=(t,e)=>{const n=t.getParent(e,t.isBlock);return n&&"LI"===n.nodeName?n:null},Gb=(t,e)=>{const n=I.after(t),r=kn(e).prev(n);return r?r.toRange():null},eE=["pre"],Lc=Sa,nE=(t,e,n)=>{let r,o,s;const a=t.selection,i=t.dom,l=t.parser,d=n.merge,c=rr({validate:!0},t.schema),u='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';-1===e.indexOf("{$caret}")&&(e+="{$caret}"),e=e.replace(/\{\$caret\}/,u),o=a.getRng();const f=o.startContainer||(o.parentElement?o.parentElement():null),m=t.getBody();var v;f===m&&a.isCollapsed()&&i.isBlock(m.firstChild)&&((v=m.firstChild)&&!t.schema.getVoidElements()[v.nodeName])&&i.isEmpty(m.firstChild)&&(o=i.createRng(),o.setStart(m.firstChild,0),o.setEnd(m.firstChild,0),a.setRng(o)),a.isCollapsed()||(h=>{const v=h.dom,y=Dc(h.selection.getRng());h.selection.setRng(y);const w=v.getParent(y.startContainer,Lc);var S,k;S=y,null!==(k=w)&&k===v.getParent(S.endContainer,Lc)&&Vd(N(k),S)?_c(h,y,N(w)):h.getDoc().execCommand("Delete",!1,null)})(t),r=a.getNode();const g={context:r.nodeName.toLowerCase(),data:n.data,insert:!0},p=l.parse(e,g);if(!0===n.paste&&((t,e)=>{let n=e.firstChild,r=e.lastChild;return n&&"meta"===n.name&&(n=n.next),r&&"mce_marker"===r.attr("id")&&(r=r.prev),((o,s)=>{const a=o.getNonEmptyElements();return s&&(s.isEmpty(a)||(l=s,o.getBlockElements()[l.name]&&(d=l).firstChild&&d.firstChild===d.lastChild&&(d=>"br"===d.name||d.value===ae)(l.firstChild)));var l,d})(t,r)&&(r=r.prev),!(!n||n!==r||"ul"!==n.name&&"ol"!==n.name)})(t.schema,p)&&((h,v)=>!!Pc(h,v))(i,r))return o=((t,e,n,r)=>{const o=((c,u,f)=>{const m=u.serialize(f);return(g=>{const p=g.firstChild,b=g.lastChild;return p&&"META"===p.nodeName&&p.parentNode.removeChild(p),b&&"mce_marker"===b.id&&b.parentNode.removeChild(b),g})(c.createFragment(m))})(e,t,r),s=Pc(e,n.startContainer),a=(t=>{return t.length>0&&(!(n=t[t.length-1]).firstChild||(e=n)&&e.firstChild&&e.firstChild===e.lastChild&&((r=e.firstChild).data===ae||Ft(r)))?t.slice(0,-1):t;var r,e,n})(dt(o.firstChild.childNodes,c=>"LI"===c.nodeName)),l=e.getRoot(),d=c=>{const u=I.fromRangeStart(n),f=kn(e.getRoot()),m=1===c?f.prev(u):f.next(u);return!m||Pc(e,m.getNode())!==s};return d(1)?((c,u,f)=>{const m=c.parentNode;return z.each(u,g=>{m.insertBefore(g,c)}),((g,p)=>{const b=I.before(g),h=kn(p).next(b);return h?h.toRange():null})(c,f)})(s,a,l):d(2)?(c=s,f=l,e.insertAfter((u=a).reverse(),c),Gb(u[0],f)):((c,u,f,m)=>{const g=((b,h)=>{const v=h.cloneRange(),y=h.cloneRange();return v.setStartBefore(b),y.setEndAfter(b),[v.cloneContents(),y.cloneContents()]})(c,m),p=c.parentNode;return p.insertBefore(g[0],c),z.each(u,b=>{p.insertBefore(b,c)}),p.insertBefore(g[1],c),p.removeChild(c),Gb(u[u.length-1],f)})(s,a,l,n);var c,u,f})(c,i,a.getRng(),p),a.setRng(o),e;if(!0===n.paste&&((h,v)=>{const y=h.firstChild,w=Ot(eE,y.name),x=y.name===v.tagName.toLowerCase();return y===("bookmark"===h.lastChild.attr("data-mce-type")?h.lastChild.prev:h.lastChild)&&w&&x})(p,r)&&p.firstChild.unwrap(),(h=>{let v=h;for(;v=v.walk();)1===v.type&&v.attr("data-mce-fragment","1")})(p),s=p.lastChild,"mce_marker"===s.attr("id")){const h=s;for(s=s.prev;s;s=s.walk(!0))if(3===s.type||!i.isBlock(s.name)){t.schema.isValidChild(s.parent.name,"span")&&s.parent.insert(h,s,"br"===s.name);break}}if(t._selectionOverrides.showBlockCaretContainer(r),g.invalid){t.selection.setContent(u),r=a.getNode();const h=t.getBody();for(9===r.nodeType?r=s=h:s=r;s!==h;)r=s,s=s.parentNode;e=r===h?h.innerHTML:i.getOuterHTML(r);const v=l.parse(e);for(let S=v;S;S=S.walk())if("mce_marker"===S.attr("id")){S.replace(p);break}const y=p.children(),w=p.parent.name;p.unwrap();const x=dt(y,S=>!t.schema.isValidChild(w,S.name));Bc(x,t.schema),Wb(l.getNodeFilters(),l.getAttributeFilters(),v),e=c.serialize(v),r===h?i.setHTML(h,e):i.setOuterHTML(r,e)}else e=c.serialize(p),((h,v,y)=>{if("all"===y.getAttribute("data-mce-bogus"))y.parentNode.insertBefore(h.dom.createFragment(v),y);else{const w=y.firstChild,x=y.lastChild;!w||w===x&&"BR"===w.nodeName?h.dom.setHTML(y,v):h.selection.setContent(v,{no_events:!0})}})(t,e,r);var b;return((h,v)=>{const y=h.schema.getTextInlineElements(),w=h.dom;if(v){const x=h.getBody(),S=rb(w);z.each(w.select("*[data-mce-fragment]"),k=>{if(lt(y[k.nodeName.toLowerCase()])&&Kr(cc(w,k),M=>!ab.has(M)))for(let D=k.parentNode;lt(D)&&D!==x&&!OS(w,k,D);D=D.parentNode)if(S.compare(D,k)){w.remove(k,!0);break}})}})(t,d),((h,v)=>{let y;const w=h.dom,x=h.selection;if(!v)return;x.scrollIntoView(v);const S=js(h.getBody(),v);if("false"===w.getContentEditable(S))return w.remove(v),void x.select(S);let k=w.createRng();const D=v.previousSibling;if(G(D)){k.setStart(D,D.nodeValue.length);const M=v.nextSibling;G(M)&&(D.appendData(M.data),M.parentNode.removeChild(M))}else k.setStartBefore(v),k.setEndBefore(v);const B=w.getParent(v,w.isBlock);w.remove(v),B&&w.isEmpty(B)&&(ls(N(B)),k.setStart(B,0),k.setEnd(B,0),Lc(B)||B.getAttribute("data-mce-fragment")||!(y=(M=>{let O=I.fromRangeStart(M);if(O=kn(h.getBody()).next(O),O)return O.toRange()})(k))?w.add(B,w.create("br",{"data-mce-bogus":"1"})):(k=y,w.remove(B))),x.setRng(k)})(t,i.get("mce_marker")),b=t.getBody(),z.each(b.getElementsByTagName("*"),h=>{h.removeAttribute("data-mce-fragment")}),((h,v)=>{C.from(h.getParent(v,"td,th")).map(N).each(PS)})(i,a.getStart()),e},hi=t=>t instanceof ve,Mc=(t,e,n)=>{var r;t.dom.setHTML(t.getBody(),e),!0!==n&&Lr(r=t)&&be(r.getBody()).each(o=>{const s=o.getNode(),a=ds(s)?be(s).getOr(o):o;r.selection.setRng(a.toRange())})},Yb=t=>xt(t)?t:Dt,Ic=(t,e,n)=>{const r=e(t),o=Yb(n);return r.orThunk(()=>o(t)?C.none():((s,a,i)=>{let l=s.dom;const d=Yb(i);for(;l.parentNode;){l=l.parentNode;const c=N(l),u=a(c);if(u.isSome())return u;if(d(c))break}return C.none()})(t,e,o))},Fc=Id,Xb=(t,e,n)=>{const r=t.formatter.get(n);if(r)for(let o=0;o<r.length;o++){const s=r[o];if(Pe(s)&&!1===s.inherit&&t.dom.is(e,s.selector))return!0}return!1},Uc=(t,e,n,r,o)=>{const s=t.dom.getRoot();return e!==s&&(e=t.dom.getParent(e,a=>!!Xb(t,a,n)||a.parentNode===s||!!Nn(t,a,n,r,!0)),!!Nn(t,e,n,r,o))},bi=(t,e,n)=>!(!Qt(n)||!Fc(e,n.inline))||!(!_n(n)||!Fc(e,n.block))||!!Pe(n)&&rt(e)&&t.is(e,n.selector),Qb=(t,e,n,r,o,s)=>{const a=n[r];if(xt(n.onmatch))return n.onmatch(e,n,r);if(a)if(we(a.length)){for(const i in a)if(gt(a,i)){const l="attributes"===r?t.getAttrib(e,i):Qa(t,e,i),d=Fn(a[i],s),c=xe(l)||pa(l);if(c&&xe(d))continue;if(o&&c&&!n.exact||(!o||n.exact)&&!Fc(l,Fd(d,i)))return!1}}else for(let i=0;i<a.length;i++)if("attributes"===r?t.getAttrib(e,a[i]):Qa(t,e,a[i]))return!0;return!0},Nn=(t,e,n,r,o)=>{const s=t.formatter.get(n),a=t.dom;if(s&&e)for(let i=0;i<s.length;i++){const l=s[i];if(bi(t.dom,e,l)&&Qb(a,e,l,"attributes",o,r)&&Qb(a,e,l,"styles",o,r)){const d=l.classes;if(d)for(let c=0;c<d.length;c++)if(!t.dom.hasClass(e,Fn(d[c],r)))return;return l}}},zc=(t,e,n,r,o)=>{if(r)return Uc(t,r,e,n,o);if(r=t.selection.getNode(),Uc(t,r,e,n,o))return!0;const s=t.selection.getStart();return!(s===r||!Uc(t,s,e,n,o))},Jb="_mce_caret",Zb=t=>(e=>{const n=[];for(;e;){if(3===e.nodeType&&"\ufeff"!==e.nodeValue||e.childNodes.length>1)return[];1===e.nodeType&&n.push(e),e=e.firstChild}return n})(t).length>0,t0=t=>{if(t){const e=new zt(t,t);for(t=e.current();t;t=e.next())if(G(t))return t}return null},jc=t=>{const e=Ut("span");return pn(e,{id:Jb,"data-mce-bogus":"1","data-mce-type":"format-caret"}),t&&Ht(e,as("\ufeff")),e},Vc=(t,e,n=!0)=>{const r=t.dom,o=t.selection;if(Zb(e))Ir(t,!1,N(e),n);else{const s=o.getRng(),a=r.getParent(e,r.isBlock),i=s.startContainer,l=s.startOffset,d=s.endContainer,c=s.endOffset,u=(f=>{const m=t0(f);return m&&"\ufeff"===m.nodeValue.charAt(0)&&m.deleteData(0,1),m})(e);r.remove(e,!0),i===u&&l>0&&s.setStart(u,l-1),d===u&&c>0&&s.setEnd(u,c-1),a&&r.isEmpty(a)&&Mr(N(a)),o.setRng(s)}},Hc=(t,e,n=!0)=>{const r=t.dom,o=t.selection;if(e)Vc(t,e,n);else if(!(e=Pr(t.getBody(),o.getStart())))for(;e=r.get(Jb);)Vc(t,e,!1)},e0=(t,e)=>(t.appendChild(e),e),n0=(t,e)=>{const n=fa(t,(r,o)=>e0(r,o.cloneNode(!1)),e);return e0(n,n.ownerDocument.createTextNode("\ufeff"))},sE=(t,e)=>{const n=t.schema.getTextInlineElements();return gt(n,Tt(e))&&!En(e.dom)&&!xr(e.dom)},vi={},r0=Qr,o0=Jo;vi.pre||(vi.pre=[]),vi.pre.push(t=>{const e=t.selection.getRng();let n;const o=Qe(["pre"]);e.collapsed||(n=t.selection.getSelectedBlocks(),o0(r0(r0(n,o),s=>o(s.previousSibling)&&-1!==jm(n,s.previousSibling)),s=>{((a,i)=>{const l=N(i),d=Wn(l).dom;Mt(l),yr(N(a),[Ut("br",d),Ut("br",d),...se(l)])})(s.previousSibling,s)}))});const $c=z.each,qc=t=>rt(t)&&!ze(t)&&!En(t)&&!xr(t),s0=(t,e)=>{for(let n=t;n;n=n[e]){if(G(n)&&Pn(n.data))return t;if(rt(n)&&!ze(n))return n}return t},a0=(t,e,n)=>{const r=rb(t);if(e&&n&&(e=s0(e,"previousSibling"),n=s0(n,"nextSibling"),r.compare(e,n))){for(let o=e.nextSibling;o&&o!==n;){const s=o;o=o.nextSibling,e.appendChild(s)}return t.remove(n),z.each(z.grep(n.childNodes),o=>{e.appendChild(o)}),e}return n},i0=(t,e,n,r)=>{if(r&&!1!==e.merge_siblings){const o=a0(t,Qp(r),r);a0(t,o,Qp(o,!0))}},Wc=(t,e,n)=>{$c(t.childNodes,r=>{qc(r)&&(e(r)&&n(r),r.hasChildNodes()&&Wc(r,e,n))})},l0=(t,e)=>n=>!(!n||!Qa(t,n,e)),d0=(t,e,n)=>r=>{var o,s;t.setStyle(r,e,n),""===r.getAttribute("style")&&r.removeAttribute("style"),o=t,"SPAN"===(s=r).nodeName&&0===o.getAttribs(s).length&&o.remove(s,!0)},Hs=Cn([{keep:[]},{rename:["name"]},{removed:[]}]),aE=/^(src|href|style)$/,Kc=z.each,yi=Id,c0=(t,e,n)=>t.isChildOf(e,n)&&e!==n&&!t.isBlock(n),u0=(t,e,n)=>{let r=e[n?"startContainer":"endContainer"],o=e[n?"startOffset":"endOffset"];if(rt(r)){const s=r.childNodes.length-1;!n&&o&&o--,r=r.childNodes[o>s?s:o]}return G(r)&&n&&o>=r.nodeValue.length&&(r=new zt(r,t.getBody()).next()||r),G(r)&&!n&&0===o&&(r=new zt(r,t.getBody()).prev()||r),r},m0=(t,e)=>{const n=e?"firstChild":"lastChild";if(/^(TR|TH|TD)$/.test(t.nodeName)&&t[n]){const r=t[n];return"TR"===t.nodeName&&r[n]||r}return t},Gc=(t,e,n,r)=>{const o=t.create(n,r);return e.parentNode.insertBefore(o,e),o.appendChild(e),o},f0=(t,e,n,r,o)=>{const s=N(e),a=N(t.create(r,o)),i=n?_f(s):Ef(s);return yr(a,i),n?(Xe(s,a),If(a,s)):(Kn(s,a),Ht(a,s)),a.dom},g0=(t,e,n,r,o)=>{let s;const a=t.dom;if(!bi(a,r,e)&&(!e.links||"A"!==r.nodeName))return Hs.keep();const i=r;if(Qt(e)&&"all"===e.remove&&Kt(e.preserve_attributes)){const l=dt(a.getAttribs(i),d=>Ot(e.preserve_attributes,d.name.toLowerCase()));if(a.removeAllAttribs(i),H(l,d=>a.setAttrib(i,d.name,d.value)),l.length>0)return Hs.rename("span")}if("all"!==e.remove){Kc(e.styles,(d,c)=>{d=Fd(Fn(d,n),c+""),mn(c)&&(c=d,o=null),(e.remove_similar||!o||yi(Qa(a,o,c),d))&&a.setStyle(i,c,""),s=!0}),s&&""===a.getAttrib(i,"style")&&(i.removeAttribute("style"),i.removeAttribute("data-mce-style")),Kc(e.attributes,(d,c)=>{let u;if(d=Fn(d,n),mn(c)&&(c=d,o=null),e.remove_similar||!o||yi(a.getAttrib(o,c),d)){if("class"===c&&(d=a.getAttrib(i,c))&&(u="",H(d.split(/\s+/),f=>{/mce\-\w+/.test(f)&&(u+=(u?" ":"")+f)}),u))return void a.setAttrib(i,c,u);if(aE.test(c)&&i.removeAttribute("data-mce-"+c),"style"===c&&Qe(["li"])(i)&&"none"===a.getStyle(i,"list-style-type"))return i.removeAttribute(c),void a.setStyle(i,"list-style-type","none");"class"===c&&i.removeAttribute("className"),i.removeAttribute(c)}}),Kc(e.classes,d=>{d=Fn(d,n),o&&!a.hasClass(o,d)||a.removeClass(i,d)});const l=a.getAttribs(i);for(let d=0;d<l.length;d++){const c=l[d].nodeName;if(0!==c.indexOf("_")&&0!==c.indexOf("data-"))return Hs.keep()}}return"none"!==e.remove?(((l,d,c)=>{const u=d.parentNode;let f;const m=l.dom,g=_e(l);var p;_n(c)&&u===m.getRoot()&&(c.list_block&&yi(d,c.list_block)||H(ke(d.childNodes),p=>{Co(l,g,p.nodeName.toLowerCase())?f?f.appendChild(p):(f=Gc(m,p,g),m.setAttribs(f,Tr(l))):f=null})),Pe(p=c)&&Qt(p)&&Zr(Nt(p,"mixed"),!0)&&!yi(c.inline,d)||m.remove(d,!0)})(t,i,e),Hs.removed()):Hs.keep()},No=(t,e,n,r,o)=>g0(t,e,n,r,o).fold(Dt,s=>(t.dom.rename(r,s),!0),Vt),iE=(t,e,n,r)=>g0(t,e,n,r,r).fold(q(r),o=>(t.dom.createFragment().appendChild(r),t.dom.rename(r,o)),q(null)),p0=(t,e,n,r,o)=>{const s=t.formatter.get(e),a=s[0];let i=!0;const l=t.dom,d=t.selection,c=p=>{const b=((h,v,y,w,x)=>{let S;return H(Ja(h.dom,v.parentNode).reverse(),k=>{if(!S&&"_start"!==k.id&&"_end"!==k.id){const D=Nn(h,k,y,w,x);D&&!1!==D.split&&(S=k)}}),S})(t,p,e,n,o);return((h,v,y,w,x,S,k,D)=>{let B,M,O;const P=h.dom;if(y){const L=y.parentNode;for(let F=w.parentNode;F&&F!==L;F=F.parentNode){B=P.clone(F,!1);for(let V=0;V<v.length&&(B=iE(h,v[V],D,B),null!==B);V++);B&&(M&&B.appendChild(M),O||(O=B),M=B)}k.mixed&&P.isBlock(y)||(w=P.split(y,w)),M&&(x.parentNode.insertBefore(M,x),O.appendChild(x),Qt(k)&&i0(P,k,0,M))}return w})(t,s,b,p,p,0,a,n)},u=p=>It(s,b=>No(t,b,n,p,p)),f=p=>{let b=!0,h=!1;rt(p)&&l.getContentEditable(p)&&(b=i,i="true"===l.getContentEditable(p),h=!0);const v=ke(p.childNodes);if(i&&!h){const y=u(p)||It(s,x=>bi(l,p,x)),w=p.parentNode;!y&&lt(w)&&Ud(a)&&u(w)}if(a.deep&&v.length){for(let y=0;y<v.length;y++)f(v[y]);h&&(i=b)}H(["underline","line-through","overline"],y=>{rt(p)&&t.dom.getStyle(p,"text-decoration")===y&&p.parentNode&&Jp(l,p.parentNode)===y&&No(t,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:y}},null,p)})},m=p=>{const b=l.get(p?"_start":"_end");let h=b[p?"firstChild":"lastChild"];return ze(v=h)&&rt(v)&&("_start"===v.id||"_end"===v.id)&&(h=h[p?"firstChild":"lastChild"]),G(h)&&0===h.data.length&&(h=p?b.previousSibling||b.nextSibling:b.nextSibling||b.previousSibling),l.remove(b,!0),h;var v},g=p=>{let b,h,v=xo(t,p,s,p.collapsed);if(a.split){if(v=ai(v),b=u0(t,v,!0),h=u0(t,v),b!==h){if(b=m0(b,!0),h=m0(h,!1),c0(l,b,h)){const w=C.from(b.firstChild).getOr(b);return c(f0(l,w,!0,"span",{id:"_start","data-mce-type":"bookmark"})),void m(!0)}if(c0(l,h,b)){const w=C.from(h.lastChild).getOr(h);return c(f0(l,w,!1,"span",{id:"_end","data-mce-type":"bookmark"})),void m(!1)}b=Gc(l,b,"span",{id:"_start","data-mce-type":"bookmark"}),h=Gc(l,h,"span",{id:"_end","data-mce-type":"bookmark"});const y=l.createRng();y.setStartAfter(b),y.setEndBefore(h),Ts(l,y,w=>{H(w,x=>{ze(x)||ze(x.parentNode)||c(x)})}),c(b),c(h),b=m(!0),h=m()}else b=h=c(b);v.startContainer=b.parentNode?b.parentNode:b,v.startOffset=l.nodeIndex(b),v.endContainer=h.parentNode?h.parentNode:h,v.endOffset=l.nodeIndex(h)+1}Ts(l,v,y=>{H(y,f)})};if(r){if(Xa(r)){const p=l.createRng();p.setStartBefore(r),p.setEndAfter(r),g(p)}else g(r);Kd(t,e,r,n)}else if("false"!==l.getContentEditable(d.getNode()))d.isCollapsed()&&Qt(a)&&!ko(t).length?((t,e,n,r)=>{const o=t.dom,s=t.selection;let a,i,l;const d=[],c=s.getRng(),u=c.startContainer;for(i=u,3===u.nodeType&&(c.startOffset!==u.nodeValue.length&&(a=!0),i=i.parentNode);i;){if(Nn(t,i,e,n,r)){l=i;break}i.nextSibling&&(a=!0),d.push(i),i=i.parentNode}if(l)if(a){const m=s.getBookmark();c.collapse(!0);let g=xo(t,c,t.formatter.get(e),!0);g=ai(g),t.formatter.remove(e,n,g,r),s.moveToBookmark(m)}else{const m=Pr(t.getBody(),l),g=jc(!1).dom;((h,v,y)=>{const w=h.dom,x=w.getParent(y,Y(Ld,h));x&&w.isEmpty(x)?y.parentNode.replaceChild(v,y):((S=>{const k=Ee(S,"br"),D=dt((B=>{const M=[];let O=B.dom;for(;O;)M.push(N(O)),O=O.lastChild;return M})(S).slice(-1),so);k.length===D.length&&H(D,Mt)})(N(y)),w.isEmpty(y)?y.parentNode.replaceChild(v,y):w.insertAfter(v,y))})(t,g,null!==m?m:l);const p=((h,v,y,w,x,S)=>{const k=h.formatter,D=h.dom,B=dt(Ke(k.get()),O=>O!==w&&!de(O,"removeformat")),M=(O=h,P=y,Be(B,(F,V)=>{const nt=It(O.formatter.get(V),bt=>{const St=et=>et.length>1&&"%"===et.charAt(0);return It(["styles","attributes"],et=>Nt(bt,et).exists(ft=>{const ut=Kt(ft)?ft:Tl(ft);return It(ut,St)}))});return O.formatter.matchNode(P,V,{},nt)?F.concat([V]):F},[]));var O,P;if(dt(M,O=>!((P,L,F)=>{const V=["inline","block","selector","attributes","styles","classes"],nt=tt=>Qo(tt,(it,bt)=>It(V,St=>St===bt));return It(P.formatter.get(L),tt=>{const it=nt(tt);return It(P.formatter.get(F),bt=>{const St=nt(bt);return((et,ft,ut=Cl)=>Om(ut).eq(et,ft))(it,St)})})})(h,O,w)).length>0){const O=y.cloneNode(!1);return D.add(v,O),k.remove(w,x,O,S),D.remove(O),C.some(O)}return C.none()})(t,g,l,e,n,r),b=n0(d.concat(p.toArray()),g);Vc(t,m,!1),s.setCursorLocation(b,1),o.isEmpty(l)&&o.remove(l)}})(t,e,n,o):(qd(d,!0,()=>{$d(t,g)}),Qt(a)&&zc(t,e,n,d.getStart())&&Xp(l,d,d.getRng()),t.nodeChanged()),Kd(t,e,r,n);else{r=d.getNode();for(let p=0;p<s.length&&(!s[p].ceFalseOverride||!No(t,s[p],n,r,r));p++);Kd(t,e,r,n)}},h0=z.each,Ci=z.each,lE=t=>rt(t)&&!ze(t)&&!En(t)&&!xr(t),b0=(t,e,n,r)=>{const o=t.formatter.get(e),s=o[0],a=!r&&t.selection.isCollapsed(),i=t.dom,l=t.selection,d=(m,g=s)=>{if(xt(g.onformat)&&g.onformat(m,g,n,r),Ci(g.styles,(p,b)=>{i.setStyle(m,b,Fn(p,n))}),g.styles){const p=i.getAttrib(m,"style");p&&i.setAttrib(m,"data-mce-style",p)}Ci(g.attributes,(p,b)=>{i.setAttrib(m,b,Fn(p,n))}),Ci(g.classes,p=>{p=Fn(p,n),i.hasClass(m,p)||i.addClass(m,p)})},c=(m,g)=>{let p=!1;return Ci(m,b=>!!Pe(b)&&(lt(b.collapsed)&&b.collapsed!==a?void 0:i.is(g,b.selector)&&!En(g)?(d(g,b),p=!0,!1):void 0)),p},f=(m,g,p)=>{const b=[];let h=!0;const v=s.inline||s.block,y=(m=>{if(st(m)){const g=i.create(m);return d(g),g}return null})(v);Ts(m,g,w=>{let x;const S=k=>{let D=!1,B=h;const M=k.nodeName.toLowerCase(),O=k.parentNode,P=O.nodeName.toLowerCase();if(rt(k)&&m.getContentEditable(k)&&(B=h,h="true"===m.getContentEditable(k),D=!0),Ft(k)&&!((L,F,V,nt)=>{if(rk(L)&&Qt(F)){const tt=gg(L.schema),it=((t,e)=>((n,r)=>{const o=n.dom;return o.parentNode?(s=N(o.parentNode),Gt(s.dom.childNodes,i=>(s=>!kt(n,s)&&r(s))(N(i))).map(N)):C.none();var s})(t,e).isSome())(N(V),bt=>En(bt.dom));return Xr(tt,nt)&&Yt(N(V.parentNode),!1)&&!it}return!1})(t,s,k,P))return x=null,void(_n(s)&&m.remove(k));if(_n(s)&&s.wrapper&&Nn(t,k,e,n))x=null;else{if(h&&!D&&_n(s)&&!s.wrapper&&Ld(t,M)&&Co(t,P,v)){const L=m.rename(k,v);return d(L),b.push(L),void(x=null)}if(Pe(s)){let L=c(o,k);if(!L&&lt(O)&&Ud(s)&&(L=c(o,O)),!Qt(s)||L)return void(x=null)}!h||D||!Co(t,v,M)||!Co(t,P,v)||!p&&G(k)&&Ra(k.data)||En(k)||Qt(s)&&m.isBlock(k)?(x=null,H(ke(k.childNodes),S),D&&(h=B),x=null):(x||(x=m.clone(y,!1),k.parentNode.insertBefore(x,k),b.push(x)),x.appendChild(k))}};H(w,S)}),!0===s.links&&H(b,w=>{const x=S=>{"A"===S.nodeName&&d(S,s),H(ke(S.childNodes),x)};x(w)}),H(b,w=>{const x=(S=>{let k=0;return H(S.childNodes,D=>{var B;lt(B=D)&&G(B)&&0===B.length||ze(D)||k++}),k})(w);var S;!(b.length>1)&&m.isBlock(w)||0!==x?(Qt(s)||_n(s)&&s.wrapper)&&(s.exact||1!==x||(w=Gt((S=w).childNodes,lE).filter(D=>bi(m,D,s)).map(D=>{const B=m.clone(D,!1);return d(B),m.replace(B,S,!0),m.remove(D,!0),B}).getOr(S)),((S,k,D,B)=>{h0(k,M=>{var O,P,L;Qt(M)&&h0(S.dom.select(M.inline,B),O=>{qc(O)&&No(S,M,D,O,M.exact?O:null)}),O=S.dom,L=B,(P=M).clear_child_styles&&$c(O.select(P.links?"*:not(a)":"*",L),V=>{qc(V)&&$c(P.styles,(nt,tt)=>{O.setStyle(V,tt,"")})})})})(t,o,n,w),((S,k,D,B,M)=>{Nn(S,M.parentNode,D,B)&&No(S,k,B,M)||k.merge_with_parents&&S.dom.getParent(M.parentNode,O=>{if(Nn(S,O,D,B))return No(S,k,B,M),!0})})(t,s,e,n,w),((S,k,D,B)=>{k.styles&&k.styles.backgroundColor&&Wc(B,l0(S,"fontSize"),d0(S,"backgroundColor",Fn(k.styles.backgroundColor,D)))})(m,s,n,w),((S,k,D,B)=>{const M=O=>{if(1===O.nodeType&&O.parentNode&&1===O.parentNode.nodeType){const P=Jp(S,O.parentNode);S.getStyle(O,"color")&&P?S.setStyle(O,"text-decoration",P):S.getStyle(O,"text-decoration")===P&&S.setStyle(O,"text-decoration",null)}};k.styles&&(k.styles.color||k.styles.textDecoration)&&(z.walk(B,M,"childNodes"),M(B))})(m,s,0,w),((S,k,D,B)=>{!Qt(k)||"sub"!==k.inline&&"sup"!==k.inline||(Wc(B,l0(S,"fontSize"),d0(S,"fontSize","")),S.remove(S.select("sup"===k.inline?"sub":"sup",B),!0))})(m,s,0,w),i0(m,s,0,w)):m.remove(w,!0)})};if("false"!==i.getContentEditable(l.getNode())){if(s){if(r)if(Xa(r)){if(!c(o,r)){const m=i.createRng();m.setStartBefore(r),m.setEndAfter(r),f(i,xo(t,m,o),!0)}}else f(i,r,!0);else a&&Qt(s)&&!ko(t).length?((m,g,p)=>{let b,h;const v=m.selection,y=v.getRng();let w=y.startOffset;const x=y.startContainer.nodeValue;b=Pr(m.getBody(),v.getStart()),b&&(h=t0(b));const S=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(x&&w>0&&w<x.length&&S.test(x.charAt(w))&&S.test(x.charAt(w-1))){const B=v.getBookmark();y.collapse(!0);let M=xo(m,y,m.formatter.get(g));M=ai(M),m.formatter.apply(g,p,M),v.moveToBookmark(B)}else b&&"\ufeff"===h.nodeValue||(k=m.getDoc(),D=jc(!0).dom,b=k.importNode(D,!0),h=b.firstChild,y.insertNode(b),w=1),m.formatter.apply(g,p,b),v.setCursorLocation(h,w);var k,D})(t,e,n):(l.setRng(Dc(l.getRng())),qd(l,!0,()=>{$d(t,(m,g)=>{const p=g?m:xo(t,m,o);f(i,p,!1)})}),Xp(i,l,l.getRng()),t.nodeChanged());g=t,o0(vi[e],p=>{p(g)})}bh(t,e,r,n)}else{r=l.getNode();for(let m=0,g=o.length;m<g;m++){const p=o[m];if(p.ceFalseOverride&&Pe(p)&&i.is(r,p.selector)){d(r,p);break}}bh(t,e,r,n)}var g},v0=t=>gt(t,"vars"),y0=t=>t.selection.getStart(),C0=(t,e,n,r,o)=>Im(e,s=>{const a=t.formatter.matchNode(s,n,null!=o?o:{},r);return!we(a)},s=>!!Xb(t,s,n)||!r&&lt(t.formatter.matchNode(s,n,o,!0))),w0=(t,e)=>{const n=null!=e?e:y0(t);return dt(Ja(t.dom,n),r=>rt(r)&&!xr(r))},x0=(t,e,n)=>{const r=w0(t,e);At(n,(o,s)=>{const a=i=>{const l=C0(t,r,s,i.similar,v0(i)?i.vars:void 0),d=l.isSome();if(i.state.get()!==d){i.state.set(d);const c=l.getOr(e);v0(i)?i.callback(d,{node:c,format:s,parents:r}):H(i.callbacks,u=>u(d,{node:c,format:s,parents:r}))}};H([o.withSimilar,o.withoutSimilar],a),H(o.withVars,a)})};function Ur(t){return(Ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function Yc(t,e){return(Yc=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(t,e)}function dE(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Xc(t,e,n){return(Xc=dE()?Reflect.construct:function(r,o,s){var a=[null];a.push.apply(a,o);var i=new(Function.bind.apply(r,a));return s&&Yc(i,s.prototype),i}).apply(null,arguments)}function sn(t){return function(e){if(Array.isArray(e))return Qc(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,n){if(e){if("string"==typeof e)return Qc(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qc(e,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var cE=Object.hasOwnProperty,k0=Object.setPrototypeOf,uE=Object.isFrozen,mE=Object.getPrototypeOf,fE=Object.getOwnPropertyDescriptor,Ne=Object.freeze,Rn=Object.seal,gE=Object.create,S0="undefined"!=typeof Reflect&&Reflect,wi=S0.apply,Jc=S0.construct;wi||(wi=function(t,e,n){return t.apply(e,n)}),Ne||(Ne=function(t){return t}),Rn||(Rn=function(t){return t}),Jc||(Jc=function(t,e){return Xc(t,sn(e))});var E0,pE=an(Array.prototype.forEach),hE=an(Array.prototype.pop),$s=an(Array.prototype.push),xi=an(String.prototype.toLowerCase),bE=an(String.prototype.match),lr=an(String.prototype.replace),vE=an(String.prototype.indexOf),yE=an(String.prototype.trim),Re=an(RegExp.prototype.test),Zc=(E0=TypeError,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Jc(E0,e)});function an(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return wi(t,e,r)}}function wt(t,e){k0&&k0(t,null);for(var n=e.length;n--;){var r=e[n];if("string"==typeof r){var o=xi(r);o!==r&&(uE(e)||(e[n]=o),r=o)}t[r]=!0}return t}function zr(t){var e,n=gE(null);for(e in t)wi(cE,t,[e])&&(n[e]=t[e]);return n}function ki(t,e){for(;null!==t;){var n=fE(t,e);if(n){if(n.get)return an(n.get);if("function"==typeof n.value)return an(n.value)}t=mE(t)}return function(r){return console.warn("fallback value for",r),null}}var _0=Ne(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),tu=Ne(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),eu=Ne(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),CE=Ne(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),nu=Ne(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),wE=Ne(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),N0=Ne(["#text"]),R0=Ne(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),ru=Ne(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),A0=Ne(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Si=Ne(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),xE=Rn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),kE=Rn(/<%[\w\W]*|[\w\W]*%>/gm),SE=Rn(/^data-[\-\w.\u00B7-\uFFFF]/),EE=Rn(/^aria-[\-\w]+$/),_E=Rn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),NE=Rn(/^(?:\w+script|data):/i),RE=Rn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),AE=Rn(/^html$/i),OE=function(){return"undefined"==typeof window?null:window},TE=function(t,e){if("object"!==Ur(t)||"function"!=typeof t.createPolicy)return null;var n=null,r="data-tt-policy-suffix";e.currentScript&&e.currentScript.hasAttribute(r)&&(n=e.currentScript.getAttribute(r));var o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:function(s){return s}})}catch(s){return console.warn("TrustedTypes policy "+o+" could not be created."),null}},BE=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:OE(),n=function(T){return t(T)};if(n.version="2.3.8",n.removed=[],!e||!e.document||9!==e.document.nodeType)return n.isSupported=!1,n;var r=e.document,o=e.document,s=e.DocumentFragment,a=e.HTMLTemplateElement,i=e.Node,l=e.Element,d=e.NodeFilter,c=e.NamedNodeMap,u=void 0===c?e.NamedNodeMap||e.MozNamedAttrMap:c,f=e.HTMLFormElement,m=e.DOMParser,g=e.trustedTypes,p=l.prototype,b=ki(p,"cloneNode"),h=ki(p,"nextSibling"),v=ki(p,"childNodes"),y=ki(p,"parentNode");if("function"==typeof a){var w=o.createElement("template");w.content&&w.content.ownerDocument&&(o=w.content.ownerDocument)}var x=TE(g,r),S=x?x.createHTML(""):"",k=o,D=k.implementation,B=k.createNodeIterator,M=k.createDocumentFragment,O=k.getElementsByTagName,P=r.importNode,L={};try{L=zr(o).documentMode?o.documentMode:{}}catch(T){}var F={};n.isSupported="function"==typeof y&&D&&void 0!==D.createHTMLDocument&&9!==L;var V,nt,tt=xE,it=kE,bt=SE,St=EE,et=NE,ft=RE,ut=_E,vt=null,E=wt({},[].concat(sn(_0),sn(tu),sn(eu),sn(nu),sn(N0))),_=null,A=wt({},[].concat(sn(R0),sn(ru),sn(A0),sn(Si))),R=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),U=null,$=null,j=!0,W=!0,Q=!1,ht=!1,K=!1,ct=!1,_t=!1,Ce=!1,Zt=!1,te=!1,me=!0,$e=!0,ee=!1,tn={},qe=null,fl=wt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),gl=null,la=wt({},["audio","video","img","source","image","track"]),Vo=null,pl=wt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),da="http://www.w3.org/1998/Math/MathML",Nm="http://www.w3.org/2000/svg",cr="http://www.w3.org/1999/xhtml",hl=cr,X1=!1,oA=["application/xhtml+xml","text/html"],sA="text/html",Ho=null,aA=o.createElement("form"),Q1=function(T){return T instanceof RegExp||T instanceof Function},Rm=function(T){Ho&&Ho===T||(T&&"object"===Ur(T)||(T={}),T=zr(T),vt="ALLOWED_TAGS"in T?wt({},T.ALLOWED_TAGS):E,_="ALLOWED_ATTR"in T?wt({},T.ALLOWED_ATTR):A,Vo="ADD_URI_SAFE_ATTR"in T?wt(zr(pl),T.ADD_URI_SAFE_ATTR):pl,gl="ADD_DATA_URI_TAGS"in T?wt(zr(la),T.ADD_DATA_URI_TAGS):la,qe="FORBID_CONTENTS"in T?wt({},T.FORBID_CONTENTS):fl,U="FORBID_TAGS"in T?wt({},T.FORBID_TAGS):{},$="FORBID_ATTR"in T?wt({},T.FORBID_ATTR):{},tn="USE_PROFILES"in T&&T.USE_PROFILES,j=!1!==T.ALLOW_ARIA_ATTR,W=!1!==T.ALLOW_DATA_ATTR,Q=T.ALLOW_UNKNOWN_PROTOCOLS||!1,ht=T.SAFE_FOR_TEMPLATES||!1,K=T.WHOLE_DOCUMENT||!1,Ce=T.RETURN_DOM||!1,Zt=T.RETURN_DOM_FRAGMENT||!1,te=T.RETURN_TRUSTED_TYPE||!1,_t=T.FORCE_BODY||!1,me=!1!==T.SANITIZE_DOM,$e=!1!==T.KEEP_CONTENT,ee=T.IN_PLACE||!1,ut=T.ALLOWED_URI_REGEXP||ut,hl=T.NAMESPACE||cr,T.CUSTOM_ELEMENT_HANDLING&&Q1(T.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(R.tagNameCheck=T.CUSTOM_ELEMENT_HANDLING.tagNameCheck),T.CUSTOM_ELEMENT_HANDLING&&Q1(T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(R.attributeNameCheck=T.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),T.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(R.allowCustomizedBuiltInElements=T.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),V=V=-1===oA.indexOf(T.PARSER_MEDIA_TYPE)?sA:T.PARSER_MEDIA_TYPE,nt="application/xhtml+xml"===V?function(ot){return ot}:xi,ht&&(W=!1),Zt&&(Ce=!0),tn&&(vt=wt({},sn(N0)),_=[],!0===tn.html&&(wt(vt,_0),wt(_,R0)),!0===tn.svg&&(wt(vt,tu),wt(_,ru),wt(_,Si)),!0===tn.svgFilters&&(wt(vt,eu),wt(_,ru),wt(_,Si)),!0===tn.mathMl&&(wt(vt,nu),wt(_,A0),wt(_,Si))),T.ADD_TAGS&&(vt===E&&(vt=zr(vt)),wt(vt,T.ADD_TAGS)),T.ADD_ATTR&&(_===A&&(_=zr(_)),wt(_,T.ADD_ATTR)),T.ADD_URI_SAFE_ATTR&&wt(Vo,T.ADD_URI_SAFE_ATTR),T.FORBID_CONTENTS&&(qe===fl&&(qe=zr(qe)),wt(qe,T.FORBID_CONTENTS)),$e&&(vt["#text"]=!0),K&&wt(vt,["html","head","body"]),vt.table&&(wt(vt,["tbody"]),delete U.tbody),Ne&&Ne(T),Ho=T)},J1=wt({},["mi","mo","mn","ms","mtext"]),Z1=wt({},["foreignobject","desc","title","annotation-xml"]),iA=wt({},["title","style","font","a","script"]),bl=wt({},tu);wt(bl,eu),wt(bl,CE);var Am=wt({},nu);wt(Am,wE);var lA=function(T){var ot=y(T);ot&&ot.tagName||(ot={namespaceURI:cr,tagName:"template"});var Z=xi(T.tagName),Pt=xi(ot.tagName);return T.namespaceURI===Nm?ot.namespaceURI===cr?"svg"===Z:ot.namespaceURI===da?"svg"===Z&&("annotation-xml"===Pt||J1[Pt]):Boolean(bl[Z]):T.namespaceURI===da?ot.namespaceURI===cr?"math"===Z:ot.namespaceURI===Nm?"math"===Z&&Z1[Pt]:Boolean(Am[Z]):T.namespaceURI===cr&&!(ot.namespaceURI===Nm&&!Z1[Pt])&&!(ot.namespaceURI===da&&!J1[Pt])&&!Am[Z]&&(iA[Z]||!bl[Z])},$n=function(T){$s(n.removed,{element:T});try{T.parentNode.removeChild(T)}catch(ot){try{T.outerHTML=S}catch(Z){T.remove()}}},vl=function(T,ot){try{$s(n.removed,{attribute:ot.getAttributeNode(T),from:ot})}catch(Z){$s(n.removed,{attribute:null,from:ot})}if(ot.removeAttribute(T),"is"===T&&!_[T])if(Ce||Zt)try{$n(ot)}catch(Z){}else try{ot.setAttribute(T,"")}catch(Z){}},tw=function(T){var ot,Z;if(_t)T="<remove></remove>"+T;else{var Pt=bE(T,/^[\r\n\t ]+/);Z=Pt&&Pt[0]}"application/xhtml+xml"===V&&(T='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+T+"</body></html>");var qt=x?x.createHTML(T):T;if(hl===cr)try{ot=(new m).parseFromString(qt,V)}catch(fe){}if(!ot||!ot.documentElement){ot=D.createDocument(hl,"template",null);try{ot.documentElement.innerHTML=X1?"":qt}catch(fe){}}var Oe=ot.body||ot.documentElement;return T&&Z&&Oe.insertBefore(o.createTextNode(Z),Oe.childNodes[0]||null),hl===cr?O.call(ot,K?"html":"body")[0]:K?ot.documentElement:Oe},ew=function(T){return B.call(T.ownerDocument||T,T,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},dA=function(T){return T instanceof f&&("string"!=typeof T.nodeName||"string"!=typeof T.textContent||"function"!=typeof T.removeChild||!(T.attributes instanceof u)||"function"!=typeof T.removeAttribute||"function"!=typeof T.setAttribute||"string"!=typeof T.namespaceURI||"function"!=typeof T.insertBefore)},ca=function(T){return"object"===Ur(i)?T instanceof i:T&&"object"===Ur(T)&&"number"==typeof T.nodeType&&"string"==typeof T.nodeName},qn=function(T,ot,Z){F[T]&&pE(F[T],function(Pt){Pt.call(n,ot,Z,Ho)})},nw=function(T){var ot;if(qn("beforeSanitizeElements",T,null),dA(T)||Re(/[\u0080-\uFFFF]/,T.nodeName))return $n(T),!0;var Z=nt(T.nodeName);if(qn("uponSanitizeElement",T,{tagName:Z,allowedTags:vt}),T.hasChildNodes()&&!ca(T.firstElementChild)&&(!ca(T.content)||!ca(T.content.firstElementChild))&&Re(/<[/\w]/g,T.innerHTML)&&Re(/<[/\w]/g,T.textContent)||"select"===Z&&Re(/<template/i,T.innerHTML))return $n(T),!0;if(!vt[Z]||U[Z]){if(!U[Z]&&ow(Z)&&(R.tagNameCheck instanceof RegExp&&Re(R.tagNameCheck,Z)||R.tagNameCheck instanceof Function&&R.tagNameCheck(Z)))return!1;if($e&&!qe[Z]){var Pt=y(T)||T.parentNode,qt=v(T)||T.childNodes;if(qt&&Pt)for(var Oe=qt.length-1;Oe>=0;--Oe)Pt.insertBefore(b(qt[Oe],!0),h(T))}return $n(T),!0}return T instanceof l&&!lA(T)?($n(T),!0):"noscript"!==Z&&"noembed"!==Z||!Re(/<\/no(script|embed)/i,T.innerHTML)?(ht&&3===T.nodeType&&(ot=lr(ot=T.textContent,tt," "),ot=lr(ot,it," "),T.textContent!==ot&&($s(n.removed,{element:T.cloneNode()}),T.textContent=ot)),qn("afterSanitizeElements",T,null),!1):($n(T),!0)},rw=function(T,ot,Z){if(me&&("id"===ot||"name"===ot)&&(Z in o||Z in aA))return!1;if((!W||$[ot]||!Re(bt,ot))&&(!j||!Re(St,ot)))if(!_[ot]||$[ot]){if(!(ow(T)&&(R.tagNameCheck instanceof RegExp&&Re(R.tagNameCheck,T)||R.tagNameCheck instanceof Function&&R.tagNameCheck(T))&&(R.attributeNameCheck instanceof RegExp&&Re(R.attributeNameCheck,ot)||R.attributeNameCheck instanceof Function&&R.attributeNameCheck(ot))||"is"===ot&&R.allowCustomizedBuiltInElements&&(R.tagNameCheck instanceof RegExp&&Re(R.tagNameCheck,Z)||R.tagNameCheck instanceof Function&&R.tagNameCheck(Z))))return!1}else if(!Vo[ot]&&!Re(ut,lr(Z,ft,""))&&("src"!==ot&&"xlink:href"!==ot&&"href"!==ot||"script"===T||0!==vE(Z,"data:")||!gl[T])&&(!Q||Re(et,lr(Z,ft,"")))&&Z)return!1;return!0},ow=function(T){return T.indexOf("-")>0},sw=function(T){var ot,Z,Pt,qt;qn("beforeSanitizeAttributes",T,null);var Oe=T.attributes;if(Oe){var fe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:_};for(qt=Oe.length;qt--;){var ua=ot=Oe[qt],Bn=ua.name,un=ua.namespaceURI;Z="value"===Bn?ot.value:yE(ot.value),Pt=nt(Bn);var uA=Z;if(fe.attrName=Pt,fe.attrValue=Z,fe.keepAttr=!0,fe.forceKeepAttr=void 0,qn("uponSanitizeAttribute",T,fe),Z=fe.attrValue,!fe.forceKeepAttr)if(fe.keepAttr)if(Re(/\/>/i,Z))vl(Bn,T);else{ht&&(Z=lr(Z,tt," "),Z=lr(Z,it," "));var mA=nt(T.nodeName);if(rw(mA,Pt,Z)){if(Z!==uA)try{un?T.setAttributeNS(un,Bn,Z):T.setAttribute(Bn,Z)}catch(hA){vl(Bn,T)}}else vl(Bn,T)}else vl(Bn,T)}qn("afterSanitizeAttributes",T,null)}},cA=function T(ot){var Z,Pt=ew(ot);for(qn("beforeSanitizeShadowDOM",ot,null);Z=Pt.nextNode();)qn("uponSanitizeShadowNode",Z,null),nw(Z)||(Z.content instanceof s&&T(Z.content),sw(Z));qn("afterSanitizeShadowDOM",ot,null)};return n.sanitize=function(T,ot){var Z,Pt,qt,Oe,fe;if((X1=!T)&&(T="\x3c!--\x3e"),"string"!=typeof T&&!ca(T)){if("function"!=typeof T.toString)throw Zc("toString is not a function");if("string"!=typeof(T=T.toString()))throw Zc("dirty is not a string, aborting")}if(!n.isSupported){if("object"===Ur(e.toStaticHTML)||"function"==typeof e.toStaticHTML){if("string"==typeof T)return e.toStaticHTML(T);if(ca(T))return e.toStaticHTML(T.outerHTML)}return T}if(ct||Rm(ot),n.removed=[],"string"==typeof T&&(ee=!1),ee){if(T.nodeName){var ua=nt(T.nodeName);if(!vt[ua]||U[ua])throw Zc("root node is forbidden and cannot be sanitized in-place")}}else if(T instanceof i)1===(Pt=(Z=tw("\x3c!----\x3e")).ownerDocument.importNode(T,!0)).nodeType&&"BODY"===Pt.nodeName||"HTML"===Pt.nodeName?Z=Pt:Z.appendChild(Pt);else{if(!Ce&&!ht&&!K&&-1===T.indexOf("<"))return x&&te?x.createHTML(T):T;if(!(Z=tw(T)))return Ce?null:te?S:""}Z&&_t&&$n(Z.firstChild);for(var Bn=ew(ee?T:Z);qt=Bn.nextNode();)3===qt.nodeType&&qt===Oe||nw(qt)||(qt.content instanceof s&&cA(qt.content),sw(qt),Oe=qt);if(Oe=null,ee)return T;if(Ce){if(Zt)for(fe=M.call(Z.ownerDocument);Z.firstChild;)fe.appendChild(Z.firstChild);else fe=Z;return _.shadowroot&&(fe=P.call(r,fe,!0)),fe}var un=K?Z.outerHTML:Z.innerHTML;return K&&vt["!doctype"]&&Z.ownerDocument&&Z.ownerDocument.doctype&&Z.ownerDocument.doctype.name&&Re(AE,Z.ownerDocument.doctype.name)&&(un="<!DOCTYPE "+Z.ownerDocument.doctype.name+">\n"+un),ht&&(un=lr(un,tt," "),un=lr(un,it," ")),x&&te?x.createHTML(un):un},n.setConfig=function(T){Rm(T),ct=!0},n.clearConfig=function(){Ho=null,ct=!1},n.isValidAttribute=function(T,ot,Z){Ho||Rm({});var Pt=nt(T),qt=nt(ot);return rw(Pt,qt,Z)},n.addHook=function(T,ot){"function"==typeof ot&&(F[T]=F[T]||[],$s(F[T],ot))},n.removeHook=function(T){if(F[T])return hE(F[T])},n.removeHooks=function(T){F[T]&&(F[T]=[])},n.removeAllHooks=function(){F={}},n}();const O0=z.explode,T0=()=>{const t={};return{addFilter:(e,n)=>{H(O0(e),r=>{gt(t,r)||(t[r]={name:r,callbacks:[]}),t[r].callbacks.push(n)})},getFilters:()=>Tl(t),removeFilter:(e,n)=>{H(O0(e),r=>{if(gt(t,r))if(lt(n)){const o=t[r],s=dt(o.callbacks,a=>a!==n);s.length>0?o.callbacks=s:delete t[r]}else delete t[r]})}}},ou=t=>{const[e,...n]=t.split(","),r=n.join(","),o=/data:([^/]+\/[^;]+)(;.+)?/.exec(e);if(o){const s=";base64"===o[2],a=s?(i=>{const l=/([a-z0-9+\/=\s]+)/i.exec(i);return l?l[1]:""})(r):decodeURIComponent(r);return C.some({type:o[1],data:a,base64Encoded:s})}return C.none()},B0=(t,e,n=!0)=>{let r=e;if(n)try{r=atob(e)}catch(s){return C.none()}const o=new Uint8Array(r.length);for(let s=0;s<o.length;s++)o[s]=r.charCodeAt(s);return C.some(new Blob([o],{type:t}))},D0=t=>new Promise((e,n)=>{const r=new FileReader;r.onloadend=()=>{e(r.result)},r.onerror=()=>{n(r.error.message)},r.readAsDataURL(t)});let PE=0;const P0=(t,e,n)=>ou(t).bind(({data:r,type:o,base64Encoded:s})=>{if(e&&!s)return C.none();{const a=s?r:btoa(r);return n(a,o)}}),L0=(t,e,n)=>{const r=t.create("blobid"+PE++,e,n);return t.add(r),r},M0=(t,e,n=!1)=>P0(e,n,(r,o)=>C.from(t.getByData(r,o)).orThunk(()=>B0(o,r).map(s=>L0(t,s,r)))),I0=z.each,LE=z.trim,ME="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),IE={ftp:21,http:80,https:443,mailto:25},FE=["img","video"],F0=(t,e,n)=>{const r=(o=>{try{return decodeURIComponent(o)}catch(s){return unescape(o)}})(e);return!t.allow_script_urls&&(!!/((java|vb)script|mhtml):/i.test(r)||!t.allow_html_data_urls&&(/^data:image\//i.test(r)?(s=n,(lt(o=t.allow_svg_data_urls)?!o:!lt(s)||!Ot(FE,s))&&/^data:image\/svg\+xml/i.test(r)):/^data:/i.test(r)));var o,s};class ln{constructor(e,n){e=LE(e),this.settings=n||{};const r=this.settings.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(e)||/^\s*#/.test(e))return void(o.source=e);const s=0===e.indexOf("//");if(0!==e.indexOf("/")||s||(e=(r&&r.protocol||"http")+"://mce_host"+e),!/^[\w\-]*:?\/\//.test(e)){const i=this.settings.base_uri?this.settings.base_uri.path:new ln(document.location.href).directory;if(this.settings.base_uri&&""==this.settings.base_uri.protocol)e="//mce_host"+o.toAbsPath(i,e);else{const l=/([^#?]*)([#?]?.*)/.exec(e);e=(r&&r.protocol||"http")+"://mce_host"+o.toAbsPath(i,l[1])+l[2]}}e=e.replace(/@@/g,"(mce_at)");const a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e);I0(ME,(i,l)=>{let d=a[l];d&&(d=d.replace(/\(mce_at\)/g,"@@")),o[i]=d}),r&&(o.protocol||(o.protocol=r.protocol),o.userInfo||(o.userInfo=r.userInfo),o.port||"mce_host"!==o.host||(o.port=r.port),o.host&&"mce_host"!==o.host||(o.host=r.host),o.source=""),s&&(o.protocol="")}static parseDataUri(e){let n;const r=decodeURIComponent(e).split(","),o=/data:([^;]+)/.exec(r[0]);return o&&(n=o[1]),{type:n,data:r[1]}}static isDomSafe(e,n,r={}){if(r.allow_script_urls)return!0;{const o=Xn.decode(e).replace(/[\s\u0000-\u001F]+/g,"");return!F0(r,o,n)}}static getDocumentBaseUrl(e){let n;return n=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?e.href:e.protocol+"//"+e.host+e.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/")),n}setPath(e){const n=/^(.*?)\/?(\w+)?$/.exec(e);this.path=n[0],this.directory=n[1],this.file=n[2],this.source="",this.getURI()}toRelative(e){let n;if("./"===e)return e;const r=new ln(e,{base_uri:this});if("mce_host"!==r.host&&this.host!==r.host&&r.host||this.port!==r.port||this.protocol!==r.protocol&&""!==r.protocol)return r.getURI();const o=this.getURI(),s=r.getURI();return o===s||"/"===o.charAt(o.length-1)&&o.substr(0,o.length-1)===s?o:(n=this.toRelPath(this.path,r.path),r.query&&(n+="?"+r.query),r.anchor&&(n+="#"+r.anchor),n)}toAbsolute(e,n){const r=new ln(e,{base_uri:this});return r.getURI(n&&this.isSameOrigin(r))}isSameOrigin(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;const n=IE[this.protocol];if(n&&(this.port||n)==(e.port||n))return!0}return!1}toRelPath(e,n){let r,o,s=0,a="";const i=e.substring(0,e.lastIndexOf("/")).split("/"),l=n.split("/");if(i.length>=l.length)for(r=0,o=i.length;r<o;r++)if(r>=l.length||i[r]!==l[r]){s=r+1;break}if(i.length<l.length)for(r=0,o=l.length;r<o;r++)if(r>=i.length||i[r]!==l[r]){s=r+1;break}if(1===s)return n;for(r=0,o=i.length-(s-1);r<o;r++)a+="../";for(r=s-1,o=l.length;r<o;r++)a+=r!==s-1?"/"+l[r]:l[r];return a}toAbsPath(e,n){let r,o,s=0,a=[];const i=/\/$/.test(n)?"/":"";let l=e.split("/");const d=n.split("/");for(I0(l,c=>{c&&a.push(c)}),l=a,r=d.length-1,a=[];r>=0;r--)0!==d[r].length&&"."!==d[r]&&(".."!==d[r]?s>0?s--:a.push(d[r]):s++);return r=l.length-s,o=r<=0?Go(a).join("/"):l.slice(0,r).join("/")+"/"+Go(a).join("/"),0!==o.indexOf("/")&&(o="/"+o),i&&o.lastIndexOf("/")!==o.length-1&&(o+=i),o}getURI(e=!1){let n;return this.source&&!e||(n="",e||(n+=this.protocol?this.protocol+"://":"//",this.userInfo&&(n+=this.userInfo+"@"),this.host&&(n+=this.host),this.port&&(n+=":"+this.port)),this.path&&(n+=this.path),this.query&&(n+="?"+this.query),this.anchor&&(n+="#"+this.anchor),this.source=n),this.source}}const U0=z.makeMap,z0=z.extend,UE={IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[]},zE=z.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),su="data-mce-type",j0=(t,e,n)=>{const r=t.name,o=r in n&&"title"!==r&&"textarea"!==r,s=e.childNodes;for(let a=0,i=s.length;a<i;a++){const l=s[a],d=new ve(l.nodeName.toLowerCase(),l.nodeType);if(rt(l)){const c=l.attributes;for(let u=0,f=c.length;u<f;u++){const m=c[u];d.attr(m.name,m.value)}}else G(l)?(d.value=l.data,o&&(d.raw=!0)):(Kl(l)||Iw(l)||Fw(l))&&(d.value=l.data);j0(d,l,n),t.append(d)}},Ro=(t={},e=Jn())=>{const n=T0(),r=T0(),o=at({validate:!0,root_name:"body"},t),s=new DOMParser,a=((t,e)=>{const n=BE(),r=t.validate;let o=0;return n.addHook("uponSanitizeElement",(s,a)=>{var i,l;8===s.nodeType&&!t.allow_conditional_comments&&/^\[if/i.test(s.nodeValue)&&(s.nodeValue=" "+s.nodeValue);const d=a.tagName;if(1!==s.nodeType||"body"===d)return;const c=N(s),u=ts(c,su),f=Me(c,"data-mce-bogus");if(!u&&st(f))return void("all"===f?Mt(c):Cr(c));const m=e.getElementRule(d.toLowerCase());if(!r||m){if(a.allowedTags[d]=!0,r&&!u){if(H(null!==(i=m.attributesForced)&&void 0!==i?i:[],g=>{re(c,g.name,"{$uid}"===g.value?"mce_"+o++:g.value)}),H(null!==(l=m.attributesDefault)&&void 0!==l?l:[],g=>{ts(c,g.name)||re(c,g.name,"{$uid}"===g.value?"mce_"+o++:g.value)}),m.attributesRequired&&!It(m.attributesRequired,g=>ts(c,g))||m.removeEmptyAttrs&&(g=>{const p=g.dom.attributes;return null==p||0===p.length})(c))return void Cr(c);m.outputName&&m.outputName!==d.toLowerCase()&&((g,p)=>{const b=((v,y)=>{const w=Ut(y),x=hf(v);return pn(w,x),w})(g,p);Kn(g,b);const h=se(g);yr(b,h),Mt(g)})(c,m.outputName)}}else Cr(c)}),n.addHook("uponSanitizeAttribute",(s,a)=>{const i=s.tagName.toLowerCase(),{attrName:l,attrValue:d}=a;a.keepAttr=!r||e.isValid(i,l)||ne(l,"data-")||ne(l,"aria-"),l in zE&&F0(t,d,i)&&(a.keepAttr=!1),a.keepAttr?(a.allowedAttributes[l]=!0,l in e.getBoolAttrs()&&(a.attrValue=l),t.allow_svg_data_urls&&ne(d,"data:image/svg+xml")&&(a.forceKeepAttr=!0)):!s.hasAttribute(su)||"id"!==l&&"class"!==l&&"style"!==l||(a.forceKeepAttr=!0)}),n})(o,e),l=n.getFilters,u=r.getFilters,m={schema:e,addAttributeFilter:r.addFilter,getAttributeFilters:u,removeAttributeFilter:r.removeFilter,addNodeFilter:n.addFilter,getNodeFilters:l,removeNodeFilter:n.removeFilter,parse:(g,p={})=>{var b;const h=o.validate,v=null!==(b=p.context)&&void 0!==b?b:o.root_name,y=((P,L,F="html")=>{const V="xhtml"===F?"application/xhtml+xml":"text/html",nt=gt(e.getSpecialElements(),L.toLowerCase()),tt=nt?`<${L}>${P}</${L}>`:P,bt=s.parseFromString("xhtml"===F?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${tt}</body></html>`:`<body>${tt}</body>`,V).body;return a.sanitize(bt,((St,et)=>{const ft=at({},UE);return ft.PARSER_MEDIA_TYPE=et,St.allow_script_urls?ft.ALLOWED_URI_REGEXP=/.*/:St.allow_html_data_urls&&(ft.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),ft})(o,V)),a.removed=[],nt?bt.firstChild:bt})(g,v,p.format),w=new ve(v,11);j0(w,y,e.getSpecialElements());const[x,S]=((P,L,F,V)=>{const nt=F.validate,tt=L.getNonEmptyElements(),it=L.getWhitespaceElements(),bt=z0(U0("script,style,head,html,body,title,meta,param"),L.getBlockElements()),St=gg(L),et=/[ \t\r\n]+/g,ft=/^[ \t\r\n]+/,ut=/[ \t\r\n]+$/,vt=_=>{for(_=_.parent;lt(_);){if(_.name in it)return!0;_=_.parent}return!1},E=(_,A)=>!lt(A?_.prev:_.next)&&_.parent.name in bt&&(_.parent!==P||V.isRootContent);return[_=>{if(3===_.type&&!vt(_)){let A=_.value;A=A.replace(et," "),((R=_.prev)&&(R.name in bt||"br"===R.name)||E(_,!0))&&(A=A.replace(ft,"")),0===A.length?_.remove():_.value=A}var R},_=>{var A,$;if(1===_.type){const R=L.getElementRule(_.name);if(nt&&R){const U=Vs(L,tt,it,_);R.paddInEmptyBlock&&U&&($=>{let j=$;for(;lt(j);){if(j.name in St)return Vs(L,tt,it,j);j=j.parent}return!1})(_)?Oc(0,V,bt,_):R.removeEmpty&&U?bt[_.name]?_.remove():_.unwrap():R.paddEmpty&&(U||Kb($=_,"#text")&&$.firstChild.value===ae)&&Oc(0,V,bt,_)}}else if(3===_.type&&!vt(_)){let R=_.value;(bt[null===(A=_.next)||void 0===A?void 0:A.name]||E(_,!1))&&(R=R.replace(ut,"")),0===R.length?_.remove():_.value=R}}]})(w,e,o,p),k=[],B={nodes:{},attributes:{}},M=P=>$b(l(),u(),P,B);if(((P,L,F)=>{const V=[];for(let nt=P,tt=nt;lt(nt);tt=nt,nt=nt.walk())H(L,it=>it(nt)),xe(nt.parent)&&nt!==P?nt=tt:V.push(nt);for(let nt=V.length-1;nt>=0;nt--){const tt=V[nt];H(F,it=>it(tt))}})(w,[x,M],[S,h?P=>((L,F)=>{const V=L.parent;V&&e.children[L.name]&&!e.isValidChild(V.name,L.name)&&F.push(L)})(P,k):pt]),k.reverse(),h&&k.length>0)if(p.context){const{pass:P,fail:L}=Wo(k,F=>F.parent===w);Bc(L,e,M),p.invalid=P.length>0}else Bc(k,e,M);const O=((P,L)=>{var F;const V=null!==(F=L.forced_root_block)&&void 0!==F?F:P.forced_root_block;return!1===V?"":!0===V?"p":V})(o,p);return O&&("body"===w.name||p.isRootContent)&&((P,L)=>{const F=z0(U0("script,style,head,html,body,title,meta,param"),e.getBlockElements()),V=/^[ \t\r\n]+/,nt=/[ \t\r\n]+$/;let tt=P.firstChild,it=null;const bt=St=>{St&&(tt=St.firstChild,tt&&3===tt.type&&(tt.value=tt.value.replace(V,"")),tt=St.lastChild,tt&&3===tt.type&&(tt.value=tt.value.replace(nt,"")))};if(e.isValidChild(P.name,L.toLowerCase())){for(;tt;){const St=tt.next;3===tt.type||1===tt.type&&"p"!==tt.name&&!F[tt.name]&&!tt.attr(su)?(it||(it=new ve(L,1),it.attr(o.forced_root_block_attrs),P.insert(it,tt)),it.append(tt)):(bt(it),it=null),tt=St}bt(it)}})(w,O),p.invalid||qb(B,p),w}};return((g,p)=>{const b=g.schema;p.remove_trailing_brs&&g.addNodeFilter("br",(h,v,y)=>{const w=z.extend({},b.getBlockElements()),x=b.getNonEmptyElements(),S=b.getWhitespaceElements();w.body=1;for(let k=0,D=h.length;k<D;k++){let B=h[k],M=B.parent;if(w[B.parent.name]&&B===M.lastChild){let O=B.prev;for(;O;){const P=O.name;if("span"!==P||"bookmark"!==O.attr("data-mce-type")){"br"===P&&(B=null);break}O=O.prev}if(B&&(B.remove(),Vs(b,x,S,M))){const P=b.getElementRule(M.name);P&&(P.removeEmpty?M.remove():P.paddEmpty&&Oc(0,y,w,M))}}else{let O=B;for(;M&&M.firstChild===O&&M.lastChild===O&&(O=M,!w[M.name]);)M=M.parent;if(O===M){const P=new ve("#text",3);P.value=ae,B.replace(P)}}}}),g.addAttributeFilter("href",h=>{let v=h.length;const y=w=>{const x=w?z.trim(w):"";return/\b(noopener)\b/g.test(x)?x:x.split(" ").filter(k=>k.length>0).concat(["noopener"]).sort().join(" ")};if(!p.allow_unsafe_link_target)for(;v--;){const w=h[v];"a"===w.name&&"_blank"===w.attr("target")&&w.attr("rel",y(w.attr("rel")))}}),p.allow_html_in_named_anchor||g.addAttributeFilter("id,name",h=>{let v,y,w,x,S=h.length;for(;S--;)if(x=h[S],"a"===x.name&&x.firstChild&&!x.attr("href")){w=x.parent,v=x.lastChild;do{y=v.prev,w.insert(v,x),v=y}while(v)}}),p.fix_list_elements&&g.addNodeFilter("ul,ol",h=>{let v,y,w=h.length;for(;w--;)if(v=h[w],y=v.parent,"ul"===y.name||"ol"===y.name)if(v.prev&&"li"===v.prev.name)v.prev.append(v);else{const x=new ve("li",1);x.attr("style","list-style-type: none"),v.wrap(x)}}),p.validate&&b.getValidClasses()&&g.addAttributeFilter("class",h=>{const v=b.getValidClasses();let y=h.length;for(;y--;){const w=h[y],x=w.attr("class").split(" ");let S="";for(let k=0;k<x.length;k++){const D=x[k];let B=!1,M=v["*"];M&&M[D]&&(B=!0),M=v[w.name],!B&&M&&M[D]&&(B=!0),B&&(S&&(S+=" "),S+=D)}S.length||(S=null),w.attr("class",S)}}),((h,v)=>{const{blob_cache:y}=v,w=x=>{const S=x.attr("src");var k;(k=x).attr("src")===Ct.transparentSrc||lt(k.attr("data-mce-placeholder"))||(k=>lt(k.attr("data-mce-bogus")))(x)||M0(y,S,!0).each(k=>{x.attr("src",k.blobUri())})};y&&h.addAttributeFilter("src",x=>H(x,w))})(g,p)})(m,o),(p=o).inline_styles&&((t,e,n)=>{const r=id();var o,s,a;e.convert_fonts_to_spans&&(o=t,s=r,a=z.explode(e.font_size_legacy_values),o.addNodeFilter("font",i=>{H(i,l=>{const d=s.parse(l.attr("style")),c=l.attr("color"),u=l.attr("face"),f=l.attr("size");var m;c&&(d.color=c),u&&(d["font-family"]=u),f&&(d["font-size"]=a[parseInt(l.attr("size"),10)-1]),l.name="span",l.attr("style",s.serialize(d)),m=l,H(["color","face","size"],p=>{m.attr(p,null)})})})),((o,s,a)=>{o.addNodeFilter("strike",i=>{const l="html4"!==s.type;H(i,d=>{if(l)d.name="s";else{const c=a.parse(d.attr("style"));c["text-decoration"]="line-through",d.name="span",d.attr("style",a.serialize(c))}})})})(t,n,r)})(m,p,e),m;var p},V0=(t,e)=>{const n=hi(o=t)?rr({validate:!1}).serialize(o):o,r=e(n);var o;if(r.isDefaultPrevented())return r;if(hi(t)){if(r.content!==n){const o=Ro({validate:!1,forced_root_block:!1}).parse(r.content,{context:t.name});return Rt(at({},r),{content:o})}return Rt(at({},r),{content:t})}return r},H0=(t,e)=>{if(e.no_events)return he.value(e);{const n=t.dispatch("BeforeGetContent",e);return n.isDefaultPrevented()?he.error(yh(t,at({content:""},n)).content):he.value(n)}},$0=(t,e,n)=>n.no_events?e:V0(e,r=>yh(t,Rt(at({},n),{content:r}))).content,au=(t,e)=>{if(e.no_events)return he.value(e);{const n=V0(e.content,r=>{return o=t,s=Rt(at({},e),{content:r}),o.dispatch("BeforeSetContent",s);var o,s});return n.isDefaultPrevented()?(vh(t,n),he.error(void 0)):he.value(n)}},iu=(t,e,n)=>{n.no_events||vh(t,Rt(at({},n),{content:e}))},lu=(t,e,n)=>({element:t,width:e,rows:n}),q0=(t,e)=>({element:t,cells:e}),VE=(t,e)=>({x:t,y:e}),W0=(t,e)=>{const n=parseInt(Me(t,e),10);return isNaN(n)?1:n},HE=(t,e,n)=>{const r=t.rows;return!!(r[n]?r[n].cells:[])[e]},K0=t=>Be(t,(e,n)=>n.cells.length>e?n.cells.length:e,0),G0=(t,e)=>{const n=t.rows;for(let r=0;r<n.length;r++){const o=n[r].cells;for(let s=0;s<o.length;s++)if(kt(o[s],e))return C.some(VE(s,r))}return C.none()},Y0=(t,e,n,r,o)=>{const s=[],a=t.rows;for(let i=n;i<=o;i++){const l=a[i].cells,d=e<r?l.slice(e,r+1):l.slice(r,e+1);s.push(q0(a[i].element,d))}return s},$E=t=>((e,n)=>{const r=go(e.element),o=Ut("tbody");return yr(o,n),Ht(r,o),r})(t,yt(t.rows,n=>{const r=yt(n.cells,s=>{const a=Ng(s);return oe(a,"colspan"),oe(a,"rowspan"),a}),o=go(n.element);return yr(o,r),o})),X0=()=>Qd([]),Ei=(t,e)=>e>=0&&e<t.length&&Os(t.charAt(e)),Q0=t=>Yn(t.innerText),J0=t=>rt(t)?t.outerHTML:G(t)?Xn.encodeRaw(t.data,!1):Kl(t)?"\x3c!--"+t.data+"--\x3e":"",YE=gr(()=>document.implementation.createHTMLDocument("undo")),_i=t=>{const e=(n=t.getBody(),dt(yt(ke(n.childNodes),J0),s=>s.length>0));var n;const r=Dn(e,s=>{const a=nb(t.serializer,s);return a.length>0?[a]:[]}),o=r.join("");return-1!==o.indexOf("</iframe>")?{type:"fragmented",fragments:r,content:"",bookmark:null,beforeBookmark:null}:(s=>({type:"complete",fragments:null,content:s,bookmark:null,beforeBookmark:null}))(o)},du=(t,e,n)=>{const r=n?e.beforeBookmark:e.bookmark;"fragmented"===e.type?((t,e)=>{((n,r)=>{let o=0;H(n,s=>{0===s[0]?o++:1===s[0]?(((a,i,l)=>{const d=(c=>{let u;const f=document.createElement("div"),m=document.createDocumentFragment();for(c&&(f.innerHTML=c);u=f.firstChild;)m.appendChild(u);return m})(i);if(a.hasChildNodes()&&l<a.childNodes.length){const c=a.childNodes[l];c.parentNode.insertBefore(d,c)}else a.appendChild(d)})(r,s[1],o),o++):2===s[0]&&((a,i)=>{if(a.hasChildNodes()&&i<a.childNodes.length){const l=a.childNodes[i];l.parentNode.removeChild(l)}})(r,o)})})(((n,r)=>{const o=n.length+r.length+2,s=new Array(o),a=new Array(o),i=(u,f,m,g,p)=>{const b=d(u,f,m,g);if(null===b||b.start===f&&b.diag===f-g||b.end===u&&b.diag===u-m){let h=u,v=m;for(;h<f||v<g;)h<f&&v<g&&n[h]===r[v]?(p.push([0,n[h]]),++h,++v):f-u>g-m?(p.push([2,n[h]]),++h):(p.push([1,r[v]]),++v)}else{i(u,b.start,m,b.start-b.diag,p);for(let h=b.start;h<b.end;++h)p.push([0,n[h]]);i(b.end,f,b.end-b.diag,g,p)}},l=(u,f,m,g)=>{let p=u;for(;p-f<g&&p<m&&n[p]===r[p-f];)++p;return{start:u,end:p,diag:f}},d=(u,f,m,g)=>{const p=f-u,b=g-m;if(0===p||0===b)return null;const h=p-b,v=b+p,y=(v%2==0?v:v+1)/2;let w,x,S,k,D;for(s[1+y]=u,a[1+y]=f+1,w=0;w<=y;++w){for(x=-w;x<=w;x+=2){for(S=x+y,s[S]=x===-w||x!==w&&s[S-1]<s[S+1]?s[S+1]:s[S-1]+1,k=s[S],D=k-u+m-x;k<f&&D<g&&n[k]===r[D];)s[S]=++k,++D;if(h%2!=0&&h-w<=x&&x<=h+w&&a[S-h]<=s[S])return l(a[S-h],x+u-m,f,g)}for(x=h-w;x<=h+w;x+=2){for(S=x+y-h,a[S]=x===h-w||x!==h+w&&a[S+1]<=a[S-1]?a[S+1]-1:a[S-1],k=a[S]-1,D=k-u+m-x;k>=u&&D>=m&&n[k]===r[D];)a[S]=k--,D--;if(h%2==0&&-w<=x&&x<=w&&a[S]<=s[S+h])return l(a[S],x+u-m,f,g)}}},c=[];return i(0,n.length,0,r.length,c),c})(yt(ke(e.childNodes),J0),t),e)})(e.fragments,t.getBody()):t.setContent(e.content,{format:"raw",no_selection:!lt(r)||!Hp(r)||!r.isFakeCaret}),t.selection.moveToBookmark(r)},cu=t=>"fragmented"===t.type?t.fragments.join(""):t.content,Z0=t=>{const e=Ut("body",YE());return Hl(e,cu(t)),H(Ee(e,"*[data-mce-bogus]"),Cr),Ff(e)},uu=(t,e)=>{return!(!t||!e)&&(r=e,!(cu(t)!==cu(r))||((n,r)=>Z0(n)===Z0(r))(t,e));var r},mu=t=>0===t.get(),Ni=(t,e,n)=>{mu(n)&&(t.typing=e)},tv=(t,e)=>{t.typing&&(Ni(t,!1,e),t.add())},ev=t=>({init:{bindEvents:pt},undoManager:{beforeChange:(e,n)=>{return r=t,s=n,void(mu(e)&&s.set(Jg(r.selection)));var r,s},add:(e,n,r,o,s,a)=>((i,l,d,c,u,f,m)=>{const g=_i(i);if(f=z.extend(f=f||{},g),!1===mu(c)||i.removed)return null;const p=l.data[d.get()];if(i.dispatch("BeforeAddUndo",{level:f,lastLevel:p,originalEvent:m}).isDefaultPrevented()||p&&uu(p,f))return null;l.data[d.get()]&&u.get().each(v=>{l.data[d.get()].beforeBookmark=v});const b=dk(i);if(b&&l.data.length>b){for(let v=0;v<l.data.length-1;v++)l.data[v]=l.data[v+1];l.data.length--,d.set(l.data.length)}f.bookmark=Jg(i.selection),d.get()<l.data.length-1&&(l.data.length=d.get()+1),l.data.push(f),d.set(l.data.length-1);const h={level:f,lastLevel:p,originalEvent:m};return d.get()>0?(i.setDirty(!0),i.dispatch("AddUndo",h),i.dispatch("change",h)):i.dispatch("AddUndo",h),f})(t,e,n,r,o,s,a),undo:(e,n,r)=>((o,s,a,i)=>{let l;return s.typing&&(s.add(),s.typing=!1,Ni(s,!1,a)),i.get()>0&&(i.set(i.get()-1),l=s.data[i.get()],du(o,l,!0),o.setDirty(!0),o.dispatch("Undo",{level:l})),l})(t,e,n,r),redo:(e,n)=>((r,o,s)=>{let a;return o.get()<s.length-1&&(o.set(o.get()+1),a=s[o.get()],du(r,a,!1),r.setDirty(!0),r.dispatch("Redo",{level:a})),a})(t,e,n),clear:(e,n)=>{return r=t,s=n,(o=e).data=[],s.set(0),o.typing=!1,void r.dispatch("ClearUndos");var r,o,s},reset:e=>{return(n=e).clear(),void n.add();var n},hasUndo:(e,n)=>{return r=t,o=e,n.get()>0||o.typing&&o.data[0]&&!uu(_i(r),o.data[0]);var r,o},hasRedo:(e,n)=>{return r=e,n.get()<r.data.length-1&&!r.typing;var r},transact:(e,n,r)=>{return a=r,tv(o=e,n),o.beforeChange(),o.ignore(a),o.add();var o,a},ignore:(e,n)=>((r,o)=>{try{r.set(r.get()+1),o()}finally{r.set(r.get()-1)}})(e,n),extra:(e,n,r,o)=>((s,a,i,l,d)=>{if(a.transact(l)){const c=a.data[i.get()].bookmark,u=a.data[i.get()-1];du(s,u,!0),a.transact(d)&&(a.data[i.get()-1].beforeBookmark=c)}})(t,e,n,r,o)},formatter:{match:(e,n,r,o)=>zc(t,e,n,r,o),matchAll:(e,n)=>((r,o,s)=>{const a=[],i={},l=r.selection.getStart();return r.dom.getParent(l,d=>{for(let c=0;c<o.length;c++){const u=o[c];!i[u]&&Nn(r,d,u,s)&&(i[u]=!0,a.push(u))}},r.dom.getRoot()),a})(t,e,n),matchNode:(e,n,r,o)=>Nn(t,e,n,r,o),canApply:e=>((n,r)=>{const o=n.formatter.get(r),s=n.dom;if(o){const a=n.selection.getStart(),i=Ja(s,a);for(let l=o.length-1;l>=0;l--){const d=o[l];if(!Pe(d))return!0;for(let c=i.length-1;c>=0;c--)if(s.is(i[c],d.selector))return!0}}return!1})(t,e),closest:e=>((n,r)=>{const o=s=>kt(s,N(n.getBody()));return C.from(n.selection.getStart(!0)).bind(s=>Ic(N(s),a=>Yr(r,i=>{return Nn(n,a.dom,d=i)?C.some(d):C.none();var d}),o)).getOrNull()})(t,e),apply:(e,n,r)=>b0(t,e,n,r),remove:(e,n,r,o)=>p0(t,e,n,r,o),toggle:(e,n,r)=>((o,s,a,i)=>{const l=o.formatter.get(s);!zc(o,s,a,i)||"toggle"in l[0]&&!l[0].toggle?b0(o,s,a,i):p0(o,s,a,i)})(t,e,n,r),formatChanged:(e,n,r,o,s)=>{return a=t,l=n,d=r,c=o,u=s,null===(i=e).get()&&(m=a,(f=i).set({}),m.on("NodeChange",g=>{x0(m,g.element,f.get())}),m.on("FormatApply FormatRemove",g=>{const p=C.from(g.node).map(b=>Xa(b)?b:b.startContainer).bind(b=>rt(b)?C.some(b):C.from(b.parentElement)).getOrThunk(()=>y0(m));x0(m,p,f.get())})),((f,m,g,p,b,h)=>{const v=m.get();H(g.split(","),y=>{const w=Nt(v,y).getOrThunk(()=>{const S={withSimilar:{state:Xt(!1),similar:!0,callbacks:[]},withoutSimilar:{state:Xt(!1),similar:!1,callbacks:[]},withVars:[]};return v[y]=S,S}),x=()=>{const S=w0(f);return C0(f,S,y,b,h).isSome()};if(we(h)){const S=b?w.withSimilar:w.withoutSimilar;S.callbacks.push(p),1===S.callbacks.length&&S.state.set(x())}else w.withVars.push({state:Xt(x()),similar:b,vars:h,callback:p})}),m.set(v)})(a,i,l,d,c,u),{unbind:()=>((f,m,g)=>{const p=f.get();H(m.split(","),b=>Nt(p,b).each(h=>{p[b]={withSimilar:Rt(at({},h.withSimilar),{callbacks:dt(h.withSimilar.callbacks,v=>v!==g)}),withoutSimilar:Rt(at({},h.withoutSimilar),{callbacks:dt(h.withoutSimilar.callbacks,v=>v!==g)}),withVars:dt(h.withVars,v=>v.callback!==g)}})),f.set(p)})(i,l,d)};var a,i,l,d,c,u,f,m}},editor:{getContent:e=>{return r=e,C.from((n=t).getBody()).fold(q("tree"===r.format?new ve("body",11):""),o=>((s,a,i)=>{let l;return"raw"===a.format?l=z.trim(RS(s.serializer,i.innerHTML)):"text"===a.format?(l=Yn(i.innerText),l="\n"===l?"":l):l="tree"===a.format?s.serializer.serialize(i,a):((d,c)=>{const u=_e(d),f=new RegExp(`^(<${u}[^>]*>(&nbsp;|&#160;|\\s|\xa0|<br \\/>|)<\\/${u}>[\r\n]*|<br \\/>[\r\n]*)$`);return c.replace(f,"")})(s,s.serializer.serialize(i,a)),"text"!==a.format&&!_a(N(i))&&st(l)?z.trim(l):l})(n,r,o));var n,r},setContent:(e,n)=>{return o=e,s=n,C.from((r=t).getBody()).map(a=>hi(o)?((i,l,d,c)=>{Wb(i.parser.getNodeFilters(),i.parser.getAttributeFilters(),d);const u=rr({validate:!1},i.schema).serialize(d),f=_a(N(l))?u:z.trim(u);return Mc(i,f,c.no_selection),{content:d,html:f}})(r,a,o,s):((i,l,d,c)=>{if(0===d.length||/^\s+$/.test(d)){const u='<br data-mce-bogus="1">';"TABLE"===l.nodeName?d="<tr><td>"+u+"</td></tr>":/^(UL|OL)$/.test(l.nodeName)&&(d="<li>"+u+"</li>");const f=_e(i);return i.schema.isValidChild(l.nodeName.toLowerCase(),f.toLowerCase())?(d=u,d=i.dom.createHTML(f,Tr(i),d)):d||(d=u),Mc(i,d,c.no_selection),{content:d,html:d}}{"raw"!==c.format&&(d=rr({validate:!1},i.schema).serialize(i.parser.parse(d,{isRootContent:!0,insert:!0})));const u=_a(N(l))?d:z.trim(d);return Mc(i,u,c.no_selection),{content:u,html:u}}})(r,a,o,s)).getOr({content:o,html:hi(s.content)?"":s.content});var r,o,s},insertContent:(e,n)=>nE(t,e,n),addVisual:e=>((n,r)=>{const o=n.dom,s=lt(r)?r:n.getBody();we(n.hasVisual)&&(n.hasVisual=gk(n)),H(o.select("table,a",s),a=>{switch(a.nodeName){case"TABLE":const i=pk(n),l=o.getAttrib(a,"border");l&&"0"!==l||!n.hasVisual?o.removeClass(a,i):o.addClass(a,i);break;case"A":if(!o.getAttrib(a,"href")){const d=o.getAttrib(a,"name")||a.id,c=pp(n);d&&n.hasVisual?o.addClass(a,c):o.removeClass(a,c)}}}),n.dispatch("VisualAid",{element:r,hasVisual:n.hasVisual})})(t,e)},selection:{getContent:(e,n)=>((r,o,s={})=>{const a=(l=o,Rt(at({},s),{format:l,get:!0,selection:!0,getInner:!0}));var l;return H0(r,a).fold(pe,i=>{const l=((d,c)=>{if("text"===c.format)return C.from((u=d).selection.getRng()).map(f=>{const m=C.from(u.dom.getParent(f.commonAncestorContainer,u.dom.isBlock)),g=u.getBody(),p=m.map(w=>w.nodeName).getOr("div").toLowerCase(),b=u.dom.add(g,p,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},f.cloneContents()),h=Q0(b),v=Yn(b.textContent);if(u.dom.remove(b),Ei(v,0)||Ei(v,v.length-1)){const y=m.getOr(g),w=Q0(y),x=w.indexOf(h);return-1===x?h:(Ei(w,x-1)?" ":"")+h+(Ei(w,x+h.length)?" ":"")}return h}).getOr("");var u;{const u=((f,m)=>{const g=f.selection.getRng(),p=f.dom.create("body"),b=f.selection.getSel(),h=dc(f,zd(b)),v=m.contextual?((t,e)=>{const n=lh(e,t);return n.length>0?((t,e)=>{return(n=t,r=e[0],cs(r,"table",Y(kt,n))).bind(n=>{const r=e[0],o=e[e.length-1],s=(a=>{const i=lu(go(a),0,[]);return H(Ee(a,"tr"),(l,d)=>{H(Ee(l,"td,th"),(c,u)=>{((f,m,g,p,b)=>{const h=W0(b,"rowspan"),v=W0(b,"colspan"),y=f.rows;for(let w=g;w<g+h;w++){y[w]||(y[w]=q0(Ng(p),[]));for(let x=m;x<m+v;x++)y[w].cells[x]=w===g&&x===m?b:go(b)}})(i,((f,m,g)=>{for(;HE(f,m,g);)m++;return m})(i,u,d),d,l,c)})}),lu(i.element,K0(i.rows),i.rows)})(n);return(a=s,i=r,l=o,G0(a,i).bind(d=>G0(a,l).map(c=>((u,f,m)=>{const g=f.x,p=f.y,b=m.x,h=m.y,v=p<h?Y0(u,g,p,b,h):Y0(u,g,h,b,p);return lu(u.element,K0(v),v)})(a,d,c)))).map(a=>Qd([$E(a)]));var a,i,l}).getOrThunk(X0);var n,r})(t,n):(r=t,(o=e).length>0&&o[0].collapsed?X0():(s=r,((i,l)=>{const d=Be(l,(c,u)=>(Ht(u,c),u),i);return l.length>0?Qd([d]):d})(N((a=o[0]).cloneContents()),((t,e)=>{const n=N(e.commonAncestorContainer),r=zn(n,t),o=dt(r,$w),s=(l=e,Gt(i=r,d=>"li"===Tt(d)&&Vd(d,l)).fold(q([]),d=>{return(c=i,Gt(c,u=>"ul"===Tt(u)||"ol"===Tt(u))).map(c=>{const u=Ut(Tt(c)),f=Qo(Lf(c),(m,g)=>ne(g,"list-style"));return ya(u,f),[Ut("li"),u]}).getOr([]);var c})),a=o.concat(s.length?s:(i=>ms(i)?Ye(i).filter(Ql).fold(q([]),l=>[i,l]):Ql(i)?[i]:[])(n));var i,l;return yt(a,go)})(s,a))));var r,o,s,a})(N(f.getBody()),h).dom:g.cloneContents();return v&&p.appendChild(v),f.selection.serializer.serialize(p,m)})(d,c);return"tree"===c.format?u:d.selection.isCollapsed()?"":u}})(r,i);return $0(r,l,i)})})(t,e,n)},autocompleter:{addDecoration:e=>((t,e)=>{if(Zh(N(t.getBody())).isNone()){const r=ss('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());Ht(r,N(e.extractContents())),e.insertNode(r.dom),Ye(r).each(o=>o.dom.normalize()),(n=r,((o,s)=>{const a=i=>{const l=se(i);for(let d=l.length-1;d>=0;d--){const c=l[d];if(s(c))return C.some(c);const u=a(c);if(u.isSome())return u}return C.none()};return a(o)})(n,Qh)).map(o=>{var s;t.selection.setCursorLocation(o.dom,"img"===Tt(s=o)?1:uh(s).fold(()=>se(s).length,a=>a.length))})}var n})(t,e),removeDecoration:()=>{return e=t,n=N(t.getBody()),Zh(n).each(r=>{const o=e.selection.getBookmark();Cr(r),e.selection.moveToBookmark(o)});var e,n}},raw:{getModel:()=>C.none()}}),jn=t=>gt(t.plugins,"rtc"),fu=t=>t.rtcInstance?t.rtcInstance:ev(t),Lt=t=>{const e=t.rtcInstance;if(e)return e;throw new Error("Failed to get RTC instance not yet initialized.")},nv=t=>Lt(t).init.bindEvents(),rv=t=>0===t.dom.length?(Mt(t),C.none()):C.some(t),ov=(t,e,n,r)=>{t.bind(o=>((r?vc:mi)(o.dom,r?o.dom.length:0),e.filter(Le).map(s=>((a,i,l,d)=>{const c=a.dom,u=i.dom,f=d?c.length:u.length;d?(yc(c,u,!1,!d),l.setStart(u,f)):(yc(u,c,!1,!d),l.setEnd(u,f))})(o,s,n,r)))).orThunk(()=>{return(s=e,a=r,s.filter(i=>Ds.isBookmarkNode(i.dom)).bind(a?is:br)).or(e).filter(Le).map(s=>((a,i)=>{Ye(a).each(l=>{const d=a.dom;i&&ci(l,I(d,0))?mi(d,0):!i&&ui(l,I(d,d.length))&&vc(d,d.length)})})(s,r));var s,a})},sv=(t,e,n)=>{if(t&&gt(t,e)){const r=dt(t[e],o=>o!==n);0===r.length?delete t[e]:t[e]=r}},av=t=>!(!t||!t.ownerDocument)&&Mn(N(t.ownerDocument),N(t)),iv=(t,e,n,r)=>{let o,s;const{selectorChangedWithUnbind:a}=((b,h)=>{let v,y;const w=(S,k)=>Gt(k,D=>b.is(D,S)),x=S=>b.getParents(S,null,b.getRoot());return{selectorChangedWithUnbind:(S,k)=>(v||(v={},y={},h.on("NodeChange",D=>{const B=D.element,M=x(B),O={};z.each(v,(P,L)=>{w(L,M).each(F=>{y[L]||(H(P,V=>{V(!0,{node:F,selector:L,parents:M})}),y[L]=P),O[L]=P})}),z.each(y,(P,L)=>{O[L]||(delete y[L],z.each(P,F=>{F(!1,{node:B,selector:L,parents:M})}))})})),v[S]||(v[S]=[]),v[S].push(k),w(S,x(h.selection.getStart())).each(()=>{y[S]=v[S]}),{unbind:()=>{sv(v,S,k),sv(y,S,k)}})}})(t,r),i=(b,h)=>((v,y,w={})=>{const x=(k=y,Rt(at({format:"html"},w),{set:!0,selection:!0,content:k}));var k;au(v,x).each(S=>{const k=((B,M)=>{if("raw"!==M.format){const O=B.selection.getRng(),P=B.dom.getParent(O.commonAncestorContainer,B.dom.isBlock),L=P?{context:P.nodeName.toLowerCase()}:{},F=B.parser.parse(M.content,at(at({forced_root_block:!1},L),M));return rr({validate:!1},B.schema).serialize(F)}return M.content})(v,S),D=v.selection.getRng();((B,M)=>{const O=C.from(M.firstChild).map(N),P=C.from(M.lastChild).map(N);B.deleteContents(),B.insertNode(M);const L=O.bind(br).filter(Le).bind(rv),F=P.bind(is).filter(Le).bind(rv);ov(L,O,B,!0),ov(F,P,B,!1),B.collapse(!1)})(D,D.createContextualFragment(k)),v.selection.setRng(D),Ms(v,D),iu(v,k,S)})})(r,b,h),l=b=>{const h=c();h.collapse(!!b),u(h)},d=()=>e.getSelection?e.getSelection():e.document.selection,c=()=>{let b,h,v;const y=(x,S,k)=>{try{return S.compareBoundaryPoints(x,k)}catch(D){return-1}},w=e.document;if(void 0!==r.bookmark&&!1===Lr(r)){const x=sc(r);if(x.isSome())return x.map(S=>dc(r,[S])[0]).getOr(w.createRange())}try{(b=d())&&!xa(b.anchorNode)&&(h=b.rangeCount>0?b.getRangeAt(0):b.createRange?b.createRange():w.createRange(),h=dc(r,[h])[0])}catch(x){}return h||(h=w.createRange()),h.setStart&&9===h.startContainer.nodeType&&h.collapsed&&(v=t.getRoot(),h.setStart(v,0),h.setEnd(v,0)),o&&s&&(0===y(h.START_TO_START,h,o)&&0===y(h.END_TO_END,h,o)?h=s:(o=null,s=null)),h},u=(b,h)=>{let v;if(!((w=b)&&av(w.startContainer)&&av(w.endContainer)))return;var w;const y=d();if(b=r.dispatch("SetSelectionRange",{range:b,forward:h}).range,y){s=b;try{y.removeAllRanges(),y.addRange(b)}catch(w){}!1===h&&y.extend&&(y.collapse(b.endContainer,b.endOffset),y.extend(b.startContainer,b.startOffset)),o=y.rangeCount>0?y.getRangeAt(0):null}!b.collapsed&&b.startContainer===b.endContainer&&y.setBaseAndExtent&&b.endOffset-b.startOffset<2&&b.startContainer.hasChildNodes()&&(v=b.startContainer.childNodes[b.startOffset],v&&"IMG"===v.tagName&&(y.setBaseAndExtent(b.startContainer,b.startOffset,b.endContainer,b.endOffset),y.anchorNode===b.startContainer&&y.focusNode===b.endContainer||y.setBaseAndExtent(v,0,v,1))),r.dispatch("AfterSetSelectionRange",{range:b,forward:h})},f=()=>{const b=d(),h=null==b?void 0:b.anchorNode,v=null==b?void 0:b.focusNode;if(!b||!h||!v||xa(h)||xa(v))return!0;const y=t.createRng(),w=t.createRng();try{y.setStart(h,b.anchorOffset),y.collapse(!0),w.setStart(v,b.focusOffset),w.collapse(!0)}catch(x){return!0}return y.compareBoundaryPoints(y.START_TO_START,w)<=0},m={bookmarkManager:null,controlSelection:null,dom:t,win:e,serializer:n,editor:r,collapse:l,setCursorLocation:(b,h)=>{const v=t.createRng();lt(b)&&lt(h)?(v.setStart(b,h),v.setEnd(b,h),u(v),l(!1)):(Hd(t,v,r.getBody(),!0),u(v))},getContent:b=>((h,v={})=>{return w=v.format?v.format:"html",x=v,Lt(h).selection.getContent(w,x);var w,x})(r,b),setContent:i,getBookmark:(b,h)=>g.getBookmark(b,h),moveToBookmark:b=>g.moveToBookmark(b),select:(b,h)=>{return(v=t,y=b,w=h,C.from(y).map(x=>{const S=v.nodeIndex(x),k=v.createRng();return k.setStart(x.parentNode,S),k.setEnd(x.parentNode,S+1),w&&(Hd(v,k,x,!0),Hd(v,k,x,!1)),k})).each(u),b;var v,y,w},isCollapsed:()=>{const b=c(),h=d();return!(!b||b.item)&&(b.compareEndPoints?0===b.compareEndPoints("StartToEnd",b):!h||b.collapsed)},isForward:f,setNode:b=>(i(t.getOuterHTML(b)),b),getNode:()=>((b,h)=>{let v,y,w;if(!h)return b;y=h.startContainer,w=h.endContainer;const x=h.startOffset,S=h.endOffset;return v=h.commonAncestorContainer,!h.collapsed&&(y===w&&S-x<2&&y.hasChildNodes()&&(v=y.childNodes[x]),3===y.nodeType&&3===w.nodeType&&(y=y.length===x?Xh(y.nextSibling,!0):y.parentNode,w=0===S?Xh(w.previousSibling,!1):w.parentNode,y&&y===w))?y:v&&3===v.nodeType?v.parentNode:v})(r.getBody(),c()),getSel:d,setRng:u,getRng:c,getStart:b=>Gh(r.getBody(),c(),b),getEnd:b=>Yh(r.getBody(),c(),b),getSelectedBlocks:(b,h)=>((v,y,w,x)=>{let S;const k=[],D=v.getRoot();if(w=v.getParent(w||Gh(D,y,y.collapsed),v.isBlock),x=v.getParent(x||Yh(D,y,y.collapsed),v.isBlock),w&&w!==D&&k.push(w),w&&x&&w!==x){S=w;const B=new zt(w,D);for(;(S=B.next())&&S!==x;)v.isBlock(S)&&k.push(S)}return x&&w!==x&&x!==D&&k.push(x),k})(t,c(),b,h),normalize:()=>{const b=c(),h=d();if(!(zd(h).length>1)&&ti(r)){const v=oi(t,b);return v.each(y=>{u(y,f())}),v.getOr(b)}return b},selectorChanged:(b,h)=>(a(b,h),m),selectorChangedWithUnbind:a,getScrollContainer:()=>{let b,h=t.getRoot();for(;h&&"BODY"!==h.nodeName;){if(h.scrollHeight>h.clientHeight){b=h;break}h=h.parentNode}return b},scrollIntoView:(b,h)=>{var v;lt(b)?((v=r).inline?pS:bS)(v,b,h):Ms(r,c(),h)},placeCaretAt:(b,h)=>u(Nh(b,h,r.getDoc())),getBoundingClientRect:()=>{const b=c();return b.collapsed?I.fromRangeStart(b).getClientRects()[0]:b.getBoundingClientRect()},destroy:()=>{e=o=s=null,p.destroy()}},g=Ds(m),p=xh(m,r);return m.bookmarkManager=g,m.controlSelection=p,m},XE=(t,e,n)=>{-1===z.inArray(e,n)&&(t.addAttributeFilter(n,(r,o)=>{let s=r.length;for(;s--;)r[s].attr(o,null)}),e.push(n))},lv=(t,e)=>{const n=((t,e)=>{const n=["data-mce-selected"],r=e&&e.dom?e.dom:Et.DOM,o=e&&e.schema?e.schema:Jn(t);t.entity_encoding=t.entity_encoding||"named",t.remove_trailing_brs=!("remove_trailing_brs"in t)||t.remove_trailing_brs;const s=Ro(t,o);return i=t,l=r,(a=s).addAttributeFilter("data-mce-tabindex",(d,c)=>{let u=d.length;for(;u--;){const f=d[u];f.attr("tabindex",f.attr("data-mce-tabindex")),f.attr(c,null)}}),a.addAttributeFilter("src,href,style",(d,c)=>{const u="data-mce-"+c,f=i.url_converter,m=i.url_converter_scope;let g=d.length;for(;g--;){const p=d[g];let b=p.attr(u);void 0!==b?(p.attr(c,b.length>0?b:null),p.attr(u,null)):(b=p.attr(c),"style"===c?b=l.serializeStyle(l.parseStyle(b),p.name):f&&(b=f.call(m,b,c,p.name)),p.attr(c,b.length>0?b:null))}}),a.addAttributeFilter("class",d=>{let c=d.length;for(;c--;){const u=d[c];let f=u.attr("class");f&&(f=u.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),u.attr("class",f.length>0?f:null))}}),a.addAttributeFilter("data-mce-type",(d,c,u)=>{let f=d.length;for(;f--;){const m=d[f];"bookmark"===m.attr("data-mce-type")&&!u.cleanup&&(C.from(m.firstChild).exists(p=>!Ra(p.value))?m.unwrap():m.remove())}}),a.addNodeFilter("noscript",d=>{let c=d.length;for(;c--;){const u=d[c].firstChild;u&&(u.value=Xn.decode(u.value))}}),a.addNodeFilter("script,style",(d,c)=>{const u=m=>m.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"");let f=d.length;for(;f--;){const m=d[f],g=m.firstChild?m.firstChild.value:"";if("script"===c){const p=m.attr("type");p&&m.attr("type","mce-no/type"===p?null:p.replace(/^mce\-/,"")),"xhtml"===i.element_format&&g.length>0&&(m.firstChild.value="// <![CDATA[\n"+u(g)+"\n// ]]>")}else"xhtml"===i.element_format&&g.length>0&&(m.firstChild.value="\x3c!--\n"+u(g)+"\n--\x3e")}}),a.addNodeFilter("#comment",d=>{let c=d.length;for(;c--;){const u=d[c];i.preserve_cdata&&0===u.value.indexOf("[CDATA[")?(u.name="#cdata",u.type=4,u.value=l.decode(u.value.replace(/^\[CDATA\[|\]\]$/g,""))):0===u.value.indexOf("mce:protected ")&&(u.name="#text",u.type=3,u.raw=!0,u.value=unescape(u.value).substr(14))}}),a.addNodeFilter("xml:namespace,input",(d,c)=>{let u=d.length;for(;u--;){const f=d[u];7===f.type?f.remove():1===f.type&&("input"!==c||f.attr("type")||f.attr("type","text"))}}),a.addAttributeFilter("data-mce-type",d=>{H(d,c=>{"format-caret"===c.attr("data-mce-type")&&(c.isEmpty(a.schema.getNonEmptyElements())?c.remove():c.unwrap())})}),a.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize,data-mce-placeholder",(d,c)=>{let u=d.length;for(;u--;)d[u].attr(c,null)}),{schema:o,addNodeFilter:s.addNodeFilter,addAttributeFilter:s.addAttributeFilter,serialize:(a,i={})=>{const l=at({format:"html"},i),d=(m=a,b=g=l,(p=f=e)&&p.hasEventListeners("PreProcess")&&!b.no_events?((p,b,h)=>{let v;const y=p.dom;let w=b.cloneNode(!0);const x=document.implementation;if(x.createHTMLDocument){const S=x.createHTMLDocument("");z.each("BODY"===w.nodeName?w.childNodes:[w],k=>{S.body.appendChild(S.importNode(k,!0))}),w="BODY"!==w.nodeName?S.body.firstChild:S.body,v=y.doc,y.doc=S}return S=p,k=Rt(at({},h),{node:w}),S.dispatch("PreProcess",k),v&&(y.doc=v),w;var S,k})(f,m,g):m),c=((f,m,g)=>{const p=Yn(g.getInner?m.innerHTML:f.getOuterHTML(m));return g.selection||_a(N(m))?p:z.trim(p)})(r,d,l),u=((f,m,g)=>{const p=g.selection?at({forced_root_block:!1},g):g,b=f.parse(m,p);return(h=>{const v=w=>w&&"br"===w.name,y=h.lastChild;if(v(y)){const w=y.prev;v(w)&&(y.remove(),w.remove())}})(b),b})(s,c,l);var f,m,g,p,b;return"tree"===l.format?u:((f,m,g,p,b)=>{var w;return((v,y,w)=>{return!y.no_events&&v?(S=v,k=Rt(at({},y),{content:w}),S.dispatch("PostProcess",k)).content:w;var S,k})(f,b,(w=p,rr(m,g).serialize(w)))})(e,t,o,u,l)},addRules:o.addValidElements,setRules:o.setValidElements,addTempAttr:Y(XE,s,n),getTempAttrs:q(n),getNodeFilters:s.getNodeFilters,getAttributeFilters:s.getAttributeFilters,removeNodeFilter:s.removeNodeFilter,removeAttributeFilter:s.removeAttributeFilter};var a,i,l})(t,e);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},gu=(t,e,n={})=>{const r=(s=e,Rt(at({format:"html"},n),{set:!0,content:s}));var s;return au(t,r).map(o=>{const s=(i=o.content,l=o,fu(t).editor.setContent(i,l));var i,l;return iu(t,s.html,o),s.content}).getOr(e)},JE="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),ZE="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),Ri=Et.DOM,Ai=t=>C.from(t).each(e=>e.destroy()),Oi=(()=>{const t={};return{add:(e,n)=>{t[e]=n},get:e=>t[e]?t[e]:{icons:{}},has:e=>gt(t,e)}})(),Ao=ce.ModelManager,dv=(t,e)=>e.dom[t],cv=(t,e)=>parseInt(bn(e,t),10),n_=Y(dv,"clientWidth"),r_=Y(dv,"clientHeight"),o_=Y(cv,"margin-top"),s_=Y(cv,"margin-left"),uv=t=>{const e=[],n=()=>{const l=t.theme;return l&&l.getNotificationManagerImpl?l.getNotificationManagerImpl():(()=>{const d=()=>{throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:d,close:d,getArgs:d}})()},r=()=>C.from(e[0]),o=()=>{H(e,l=>{l.reposition()})},s=l=>{Ko(e,d=>d===l).each(d=>{e.splice(d,1)})},a=(l,d=!0)=>{if(!t.removed&&(u=(c=t).inline?c.getBody():c.getContentAreaContainer(),C.from(u).map(N)).map(eo).getOr(!1))return d&&t.dispatch("BeforeOpenNotification",{notification:l}),Gt(e,c=>{return!((u=n().getArgs(c)).type!==(f=l).type||u.text!==f.text||u.progressBar||u.timeout||f.progressBar||f.timeout);var u,f}).getOrThunk(()=>{t.editorManager.setActive(t);const c=n().open(l,()=>{s(c),o(),r().fold(()=>t.focus(),u=>zh(N(u.getEl())))});return(u=>{e.push(u)})(c),o(),t.dispatch("OpenNotification",{notification:at({},c)}),c});var c,u},i=q(e);return(l=t).on("SkinLoaded",()=>{const d=Jx(l);d&&a({text:d,type:"warning",timeout:0},!1),o()}),l.on("show ResizeEditor ResizeWindow NodeChange",()=>{requestAnimationFrame(o)}),l.on("remove",()=>{H(e.slice(),d=>{n().close(d)})}),{open:a,close:()=>{r().each(l=>{n().close(l),s(l),o()})},getNotifications:i};var l},Oo=ce.PluginManager,jr=ce.ThemeManager,mv=t=>{let e=[];const n=()=>{const a=t.theme;return a&&a.getWindowManagerImpl?a.getWindowManagerImpl():(()=>{const i=()=>{throw new Error("Theme did not provide a WindowManager implementation.")};return{open:i,openUrl:i,alert:i,confirm:i,close:i,getParams:i,setParams:i}})()},r=(a,i)=>(...l)=>i?i.apply(a,l):void 0,o=a=>{t.dispatch("CloseWindow",{dialog:a}),e=dt(e,i=>i!==a),0===e.length&&t.focus()},s=a=>{t.editorManager.setActive(t),oc(t),t.ui.show();const i=a();return e.push(l=i),t.dispatch("OpenWindow",{dialog:l}),i;var l};return t.on("remove",()=>{H(e,a=>{n().close(a)})}),{open:(a,i)=>s(()=>n().open(a,i,o)),openUrl:a=>s(()=>n().openUrl(a,o)),alert:(a,i,l)=>{const d=n();d.alert(a,r(l||d,i))},confirm:(a,i,l)=>{const d=n();d.confirm(a,r(l||d,i))},close:()=>{C.from(e[e.length-1]).each(a=>{n().close(a),o(a)})}}},fv=(t,e)=>{t.notificationManager.open({type:"error",text:e})},Ti=(t,e)=>{t._skinLoaded?fv(t,e):t.on("SkinLoaded",()=>{fv(t,e)})},qs=(t,e,n)=>{hh(t,e,{message:n}),console.error(n)},Ws=(t,e,n)=>n?`Failed to load ${t}: ${n} from url ${e}`:`Failed to load ${t} url: ${e}`,Bi=(t,...e)=>{const n=window.console;n&&(n.error?n.error(t,...e):n.log(t,...e))},gv=(t,e)=>{const n=t.editorManager.baseURL+"/skins/content",r=`content${t.editorManager.suffix}.css`,o=!0===t.inline;return yt(e,s=>/^[a-z0-9\-]+$/i.test(s)&&!o?`${n}/${s}/${r}`:t.documentBaseURI.toAbsolute(s))},a_=Vt,pv=()=>{let t={};const e=(r,o)=>({status:r,resultUri:o}),n=r=>r in t;return{hasBlobUri:n,getResultUri:r=>{const o=t[r];return o?o.resultUri:null},isPending:r=>!!n(r)&&1===t[r].status,isUploaded:r=>!!n(r)&&2===t[r].status,markPending:r=>{t[r]=e(1,null)},markUploaded:(r,o)=>{t[r]=e(2,o)},removeFailed:r=>{delete t[r]},destroy:()=>{t={}}}};let l_=0;const hv=t=>()=>t.notificationManager.open({text:t.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),bv=(t,e)=>((t,e)=>{const n={},r=(i,l)=>new Promise((d,c)=>{const u=new XMLHttpRequest;u.open("POST",e.url),u.withCredentials=e.credentials,u.upload.onprogress=m=>{l(m.loaded/m.total*100)},u.onerror=()=>{c("Image upload failed due to a XHR Transport error. Code: "+u.status)},u.onload=()=>{if(u.status<200||u.status>=300)return void c("HTTP Error: "+u.status);const m=JSON.parse(u.responseText);var g,p;m&&st(m.location)?d((p=m.location,(g=e.basePath)?g.replace(/\/$/,"")+"/"+p.replace(/^\//,""):p)):c("Invalid JSON: "+u.responseText)};const f=new FormData;f.append("file",i.blob(),i.filename()),u.send(f)}),o=(i,l)=>({url:l,blobInfo:i,status:!0}),s=(i,l)=>({url:"",blobInfo:i,status:!1,error:l}),a=(i,l)=>{z.each(n[i],d=>{d(l)}),delete n[i]};return!1===xt(e.handler)&&(e.handler=r),{upload:(i,l)=>{return e.url||e.handler!==r?(c=l,d=z.grep(d=i,u=>!t.isUploaded(u.blobUri())),Promise.all(z.map(d,u=>{return t.isPending(u.blobUri())?(f=>{const m=f.blobUri();return new Promise(g=>{n[m]=n[m]||[],n[m].push(g)})})(u):(m=e.handler,g=c,t.markPending((f=u).blobUri()),new Promise(p=>{let b,h;try{const v=()=>{b&&(b.close(),h=pt)},y=x=>{v(),t.markUploaded(f.blobUri(),x),a(f.blobUri(),o(f,x)),p(o(f,x))},w=x=>{v(),t.removeFailed(f.blobUri()),a(f.blobUri(),s(f,x)),p(s(f,x))};h=x=>{x<0||x>100||C.from(b).orThunk(()=>C.from(g).map(Sl)).each(S=>{b=S,S.progressBar.value(x)})},m(f,h).then(y,x=>{w(st(x)?{message:x}:x)})}catch(v){p(s(f,v))}}));var f,m,g}))):new Promise(d=>{d([])});var d,c}}})(e,{url:Ux(t),basePath:zx(t),credentials:jx(t),handler:Vx(t)}),vv={remove_similar:!0,inherit:!1},To=at({selector:"td,th"},vv),u_={tablecellbackgroundcolor:at({styles:{backgroundColor:"%value"}},To),tablecellverticalalign:at({styles:{"vertical-align":"%value"}},To),tablecellbordercolor:at({styles:{borderColor:"%value"}},To),tablecellclass:at({classes:["%value"]},To),tableclass:at({selector:"table",classes:["%value"]},vv),tablecellborderstyle:at({styles:{borderStyle:"%value"}},To),tablecellborderwidth:at({styles:{borderWidth:"%value"}},To)},m_=q(u_),Di=z.each,Ae=Et.DOM,yv=(t,e)=>{let n,r,o;const s=e&&e.schema||Jn({}),a=l=>{r="string"==typeof l?{name:l,classes:[],attrs:{}}:l;const d=Ae.create(r.name);return c=d,(u=r).classes.length&&Ae.addClass(c,u.classes.join(" ")),Ae.setAttribs(c,u.attrs),d;var c,u},i=(l,d,c)=>{let u,f;const m=d.length>0&&d[0],g=m&&m.name,p=((b,h)=>{const v="string"!=typeof b?b.nodeName.toLowerCase():b,y=s.getElementRule(v),w=y&&y.parentsRequired;return!(!w||!w.length)&&(h&&-1!==z.inArray(w,h)?h:w[0])})(l,g);if(p)g===p?(f=d[0],d=d.slice(1)):f=p;else if(m)f=d[0],d=d.slice(1);else if(!c)return l;return f&&(u=a(f),u.appendChild(l)),c&&(u||(u=Ae.create("div"),u.appendChild(l)),z.each(c,b=>{const h=a(b);u.insertBefore(h,l)})),i(u,d,f&&f.siblings)};return t&&t.length?(r=t[0],n=a(r),o=Ae.create("div"),o.appendChild(i(n,t.slice(1),r.siblings)),o):""},f_=t=>{let e;const n={classes:[],attrs:{}};return"*"!==(t=n.selector=z.trim(t))&&(e=t.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(r,o,s,a,i)=>{switch(o){case"#":n.attrs.id=s;break;case".":n.classes.push(s);break;case":":-1!==z.inArray("checked disabled enabled read-only required".split(" "),s)&&(n.attrs[s]=s)}if("["===a){const l=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);l&&(n.attrs[l[1]]=l[2])}return""})),n.name=e||"div",n},g_=(t,e)=>{let n,r,o,s="",a=nk(t);if(""===a)return"";const i=u=>u.replace(/%(\w+)/g,"");if("string"==typeof e){if(!(e=t.formatter.get(e)))return;e=e[0]}if("preview"in e){const u=Nt(e,"preview");if(Zr(u,!1))return"";a=u.getOr(a)}n=e.block||e.inline||"span";const l=(d=e.selector)&&"string"==typeof d?(d=(d=d.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),z.map(d.split(/(?:>|\s+(?![^\[\]]+\]))/),u=>{const f=z.map(u.split(/(?:~\+|~|\+)/),f_),m=f.pop();return f.length&&(m.siblings=f),m}).reverse()):[];var d;l.length?(l[0].name||(l[0].name=n),n=e.selector,r=yv(l,t)):r=yv([n],t);const c=Ae.select(n,r)[0]||r.firstChild;return Di(e.styles,(u,f)=>{const m=i(u);m&&Ae.setStyle(c,f,m)}),Di(e.attributes,(u,f)=>{const m=i(u);m&&Ae.setAttrib(c,f,m)}),Di(e.classes,u=>{const f=i(u);Ae.hasClass(c,f)||Ae.addClass(c,f)}),t.dispatch("PreviewFormats"),Ae.setStyles(r,{position:"absolute",left:-65535}),t.getBody().appendChild(r),o=Ae.getStyle(t.getBody(),"fontSize",!0),o=/px$/.test(o)?parseInt(o,10):0,Di(a.split(" "),u=>{let f=Ae.getStyle(c,u,!0);if(!("background-color"===u&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(f)&&(f=Ae.getStyle(t.getBody(),u,!0),"#ffffff"===Ya(f).toLowerCase())||"color"===u&&"#000000"===Ya(f).toLowerCase())){if("font-size"===u&&/em|%$/.test(f)){if(0===o)return;f=parseFloat(f)/(/%$/.test(f)?100:1)*o+"px"}"border"===u&&f&&(s+="padding:0 2px;"),s+=u+":"+f+";"}}),t.dispatch("AfterPreviewFormats"),Ae.remove(r),s},Cv=t=>{const e=(r=>{const o={},s=(a,i)=>{a&&(st(a)?(Kt(i)||(i=[i]),H(i,l=>{we(l.deep)&&(l.deep=!Pe(l)),we(l.split)&&(l.split=!Pe(l)||Qt(l)),we(l.remove)&&Pe(l)&&!Qt(l)&&(l.remove="none"),Pe(l)&&Qt(l)&&(l.mixed=!0,l.block_expand=!0),st(l.classes)&&(l.classes=l.classes.split(/\s+/))}),o[a]=i):At(a,(l,d)=>{s(d,l)}))};return s((a=>{const i=a.dom,l=a.schema.type,d={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:c=>{i.setStyle(c,"float",null)},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:c=>{i.setStyle(c,"float",null)},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{const c={inline:"span",styles:{textDecoration:"line-through"},exact:!0},u={inline:"strike",remove:"all",preserve_attributes:["class","style"]},f={inline:"s",remove:"all",preserve_attributes:["class","style"]};return"html4"!==l?[f,c,u]:[c,f,u]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(c,u,f)=>rt(c)&&c.hasAttribute("href"),onformat:(c,u,f)=>{z.each(f,(m,g)=>{i.setAttrib(c,g,m)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":c=>{var u;return null!==(u=null==c?void 0:c.customValue)&&void 0!==u?u:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return z.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),c=>{d[c]={block:c,remove:"all"}}),d})(r)),s(m_()),s(ek(r)),{get:a=>lt(a)?o[a]:o,has:a=>gt(o,a),register:s,unregister:a=>(a&&o[a]&&delete o[a],o)}})(t),n=Xt(null);return(r=>{r.addShortcut("meta+b","","Bold"),r.addShortcut("meta+i","","Italic"),r.addShortcut("meta+u","","Underline");for(let o=1;o<=6;o++)r.addShortcut("access+"+o,"",["FormatBlock",!1,"h"+o]);r.addShortcut("access+7","",["FormatBlock",!1,"p"]),r.addShortcut("access+8","",["FormatBlock",!1,"div"]),r.addShortcut("access+9","",["FormatBlock",!1,"address"])})(t),(r=t).on("mouseup keydown",o=>{((s,a)=>{const i=s.selection,l=s.getBody();Hc(s,null,!1),8!==a&&46!==a||!i.isCollapsed()||"\ufeff"!==i.getStart().innerHTML||Hc(s,Pr(l,i.getStart())),37!==a&&39!==a||Hc(s,Pr(l,i.getStart()))})(r,o.keyCode)}),{get:e.get,has:e.has,register:e.register,unregister:e.unregister,apply:(r,o,s)=>{var i,l,d;i=r,l=o,d=s,Lt(t).formatter.apply(i,l,d)},remove:(r,o,s,a)=>{var l,d,c,u;l=r,d=o,c=s,u=a,Lt(t).formatter.remove(l,d,c,u)},toggle:(r,o,s)=>{var i,l,d;i=r,l=o,d=s,Lt(t).formatter.toggle(i,l,d)},match:(r,o,s,a)=>{return l=r,d=o,c=s,u=a,Lt(t).formatter.match(l,d,c,u);var l,d,c,u},closest:r=>{return s=r,Lt(t).formatter.closest(s);var s},matchAll:(r,o)=>{return a=r,i=o,Lt(t).formatter.matchAll(a,i);var a,i},matchNode:(r,o,s,a)=>{return l=r,d=o,c=s,u=a,Lt(t).formatter.matchNode(l,d,c,u);var l,d,c,u},canApply:r=>{return s=r,Lt(t).formatter.canApply(s);var s},formatChanged:(r,o,s,a)=>{return l=n,d=r,c=o,u=s,f=a,Lt(t).formatter.formatChanged(l,d,c,u,f);var l,d,c,u,f},getCssText:Y(g_,t)};var r},wv=t=>{switch(t.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},xv=t=>{const e=Zn(),n=Xt(0),r=Xt(0),o={data:[],typing:!1,beforeChange:()=>{var a,i;a=n,i=e,Lt(t).undoManager.beforeChange(a,i)},add:(s,a)=>{return l=o,d=r,c=n,u=e,f=s,m=a,Lt(t).undoManager.add(l,d,c,u,f,m);var l,d,c,u,f,m},dispatchChange:()=>{t.setDirty(!0),t.dispatch("change",{level:_i(t),lastLevel:Rl(o.data,r.get()).getOrUndefined()})},undo:()=>{return a=o,i=n,l=r,Lt(t).undoManager.undo(a,i,l);var a,i,l},redo:()=>{return a=r,i=o.data,Lt(t).undoManager.redo(a,i);var a,i},clear:()=>{var a,i;a=o,i=r,Lt(t).undoManager.clear(a,i)},reset:()=>{var a;a=o,Lt(t).undoManager.reset(a)},hasUndo:()=>{return a=o,i=r,Lt(t).undoManager.hasUndo(a,i);var a,i},hasRedo:()=>{return a=o,i=r,Lt(t).undoManager.hasRedo(a,i);var a,i},transact:s=>{return i=o,l=n,d=s,Lt(t).undoManager.transact(i,l,d);var i,l,d},ignore:s=>{var i,l;i=n,l=s,Lt(t).undoManager.ignore(i,l)},extra:(s,a)=>{var l,d,c,u;l=o,d=r,c=s,u=a,Lt(t).undoManager.extra(l,d,c,u)}};return jn(t)||((s,a,i)=>{const l=Xt(!1),d=c=>{Ni(a,!1,i),a.add({},c)};s.on("init",()=>{a.add()}),s.on("BeforeExecCommand",c=>{wv(c.command)||(tv(a,i),a.beforeChange())}),s.on("ExecCommand",c=>{wv(c.command)||d(c)}),s.on("ObjectResizeStart cut",()=>{a.beforeChange()}),s.on("SaveContent ObjectResized blur",d),s.on("dragend",d),s.on("keyup",c=>{const u=c.keyCode;c.isDefaultPrevented()||((u>=33&&u<=36||u>=37&&u<=40||45===u||c.ctrlKey)&&(d(),s.nodeChanged()),46!==u&&8!==u||s.nodeChanged(),l.get()&&a.typing&&!1===uu(_i(s),a.data[0])&&(!1===s.isDirty()&&s.setDirty(!0),s.dispatch("TypingUndo"),l.set(!1),s.nodeChanged()))}),s.on("keydown",c=>{const u=c.keyCode;c.isDefaultPrevented()||(u>=33&&u<=36||u>=37&&u<=40||45===u?a.typing&&d(c):!(u<16||u>20)||224===u||91===u||a.typing||c.ctrlKey&&!c.altKey||c.metaKey||(a.beforeChange(),Ni(a,!0,i),a.add({},c),l.set(!0)))}),s.on("mousedown",c=>{a.typing&&d(c)}),s.on("input",c=>{var u,f;c.inputType&&("insertReplacementText"===c.inputType||"insertText"===(u=c).inputType&&null===u.data||"insertFromPaste"===(f=c).inputType||"insertFromDrop"===f.inputType)&&d(c)}),s.on("AddUndo Undo Redo ClearUndos",c=>{c.isDefaultPrevented()||s.nodeChanged()})})(t,o,n),(s=t).addShortcut("meta+z","","Undo"),s.addShortcut("meta+y,meta+shift+z","","Redo"),o;var s},p_=[9,27,J.HOME,J.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,J.DOWN,J.UP,J.LEFT,J.RIGHT].concat(Ct.browser.isFirefox()?[224]:[]),kv="data-mce-placeholder",Sv=t=>"keydown"===t.type||"keyup"===t.type,Ev=t=>{const e=t.keyCode;return e===J.BACKSPACE||e===J.DELETE},h_=(t,e)=>({from:t,to:e}),pu=(t,e)=>{const n=N(t),r=N(e.container());return fi(n,r).map(o=>({block:o,position:e}))},_v=t=>{const e=(t=>{const e=se(t);return Ko(e,en).fold(q(e),n=>e.slice(0,n))})(t);return H(e,Mt),e},Nv=(t,e)=>{const n=zn(e,t);return Gt(n.reverse(),r=>Yt(r)).each(Mt)},v_=(t,e,n,r)=>{if(Yt(n))return Mr(n),be(n.dom);0===dt(Ef(r),s=>!Yt(s)).length&&Yt(e)&&Xe(r,Ut("br"));const o=on(n.dom,I.before(r.dom));return H(_v(e),s=>{Xe(r,s)}),Nv(t,e),o},y_=(t,e,n)=>{if(Yt(n))return Mt(n),Yt(e)&&Mr(e),be(e.dom);const r=Sn(n.dom);return H(_v(e),o=>{Ht(n,o)}),Nv(t,e),r},Rv=(t,e)=>{yo(t,e.dom).map(n=>n.getNode()).map(N).filter(so).each(Mt)},Av=(t,e,n)=>{return Rv(!0,e),Rv(!1,n),(r=e,o=n,Mn(o,r)?((s,a)=>{const i=zn(a,s);return C.from(i[i.length-1])})(o,r):C.none()).fold(Y(y_,t,e,n),Y(v_,t,e,n));var r,o},Ov=(t,e,n,r)=>e?Av(t,r,n):Av(t,n,r),hu=(t,e)=>{const n=N(t.getBody());return(o=n.dom,s=e,a=t.selection.getRng(),a.collapsed?((i,l,d)=>{const c=pu(i,I.fromRangeStart(d)),u=c.bind(f=>Fe(l,i,f.position).bind(m=>pu(i,m).map(g=>{return p=i,b=l,Ft((h=g).position.getNode())&&!1===Yt(h.block)?yo(!1,h.block.dom).bind(v=>v.isEqual(h.position)?Fe(b,p,v).bind(y=>pu(p,y)):C.some(h)).getOr(h):h;var p,b,h})));return Se(c,u,h_).filter(f=>{return!1===kt((m=f).from.block,m.to.block)&&(m=>Ye(m.from.block).bind(g=>Ye(m.to.block).filter(p=>kt(g,p))).isSome())(f)&&(m=>!1===Bt(m.from.block.dom)&&!1===Bt(m.to.block.dom))(f);var m})})(o,s,a):C.none()).map(o=>()=>{Ov(n,e,o.from.block,o.to.block).each(s=>{t.selection.setRng(s.toRange())})});var o,s,a},Tv=(t,e)=>{const n=N(e),r=Y(kt,t);return ro(n,Ea,r).isSome()},bu=(t,e)=>t.selection.isCollapsed()?C.none():(t=>{const e=N(t.getBody());return((n,r)=>{const o=on(n.dom,I.fromRangeStart(r)).isNone(),s=Ue(n.dom,I.fromRangeEnd(r)).isNone();return!(Tv(a=n,(i=r).startContainer)||Tv(a,i.endContainer))&&o&&s;var a,i})(e,t.selection.getRng())?(n=t,C.some(()=>{n.setContent(""),n.selection.setCursorLocation()})):((n,r)=>{const o=r.getRng();return Se(fi(n,N(o.startContainer)),fi(n,N(o.endContainer)),(s,a)=>!1===kt(s,a)?C.some(()=>{o.deleteContents(),Ov(n,!0,s,a).each(i=>{r.setRng(i.toRange())})}):C.none()).getOr(C.none())})(e,t.selection);var n})(t),w_=vn,x_=Bt,Vn=(t,e,n,r,o)=>C.from(e._selectionOverrides.showCaret(t,n,r,o)),Ks=(t,e)=>t.dispatch("BeforeObjectSelected",{target:e}).isDefaultPrevented()?C.none():C.some((n=>{const r=n.ownerDocument.createRange();return r.selectNode(n),r})(e)),vu=(t,e,n)=>e.collapsed?((r,o,s)=>{const a=Rd(1,r.getBody(),o),i=I.fromRangeStart(a),l=i.getNode();if(Ss(l))return Vn(1,r,l,!i.isAtEnd(),!1);const d=i.getNode(!0);if(Ss(d))return Vn(1,r,d,!1,!1);const c=r.dom.getParent(i.getNode(),u=>x_(u)||w_(u));return Ss(c)?Vn(1,r,c,!1,s):C.none()})(t,e,n).getOr(e):e,k_=t=>sr(t)||Fs(t),S_=t=>ar(t)||Us(t),Bv=(t,e,n,r,o,s)=>{var a,i;Vn(r,t,s.getNode(!o),o,!0).each(a=>{if(e.collapsed){const i=e.cloneRange();o?i.setEnd(a.startContainer,a.startOffset):i.setStart(a.endContainer,a.endOffset),i.deleteContents()}else e.deleteContents();t.selection.setRng(a)}),a=t.dom,G(i=n)&&0===i.data.length&&a.remove(i)},yu=(t,e)=>((n,r)=>{const o=n.selection.getRng();if(!G(o.commonAncestorContainer))return C.none();const s=r?$t.Forwards:$t.Backwards,a=kn(n.getBody()),i=Y(Ad,r?a.next:a.prev),l=r?k_:S_,d=As(s,n.getBody(),o),c=Ve(r,i(d));if(!c||!$a(d,c))return C.none();if(l(c))return C.some(()=>Bv(n,o,d.getNode(),s,r,c));const u=i(c);return u&&l(u)&&$a(c,u)?C.some(()=>Bv(n,o,d.getNode(),s,r,u)):C.none()})(t,e),Cu=(t,e)=>{const n=t.getBody();return e?be(n).filter(sr):Sn(n).filter(ar)},wu=t=>{const e=t.selection.getRng();return!e.collapsed&&(Cu(t,!0).exists(n=>n.isEqual(I.fromRangeStart(e)))||Cu(t,!1).exists(n=>n.isEqual(I.fromRangeEnd(e))))},He=Cn([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),Dv=(t,e,n)=>Fe(e,t,n).bind(r=>{return o=r.getNode(),Ea(N(o))||ms(N(o))||((s,a,i,l)=>{const d=c=>Xl(N(c))&&!wn(i,l,s);return Bp(!a,i).fold(()=>Bp(a,l).fold(Dt,d),d)})(t,e,n,r)?C.none():e&&Bt(r.getNode())||!1===e&&Bt(r.getNode(!0))?((s,a,i,l)=>{const d=l.getNode(!1===a);return fi(N(s),N(i.getNode())).map(c=>Yt(c)?He.remove(c.dom):He.moveToElement(d)).orThunk(()=>C.some(He.moveToElement(d)))})(t,e,n,r):e&&ar(n)||!1===e&&sr(n)?C.some(He.moveToPosition(r)):C.none();var o}),Pv=(t,e)=>C.from(js(t.getBody(),e)),Lv=t=>{const e=t.dom,n=t.selection,r=js(t.getBody(),n.getNode());if(vn(r)&&e.isBlock(r)&&e.isEmpty(r)){const o=e.create("br",{"data-mce-bogus":"1"});e.setHTML(r,""),r.appendChild(o),n.setRng(I.before(o).toRange())}return!0},xu=(t,e)=>t.selection.isCollapsed()?((t,e)=>{const n=t.selection.getNode();return Pv(t,n).filter(Bt).fold(()=>((r,o,s)=>{const a=Rd(o?1:-1,r,s),i=I.fromRangeStart(a),l=N(r);return!1===o&&ar(i)?C.some(He.remove(i.getNode(!0))):o&&sr(i)?C.some(He.remove(i.getNode())):!1===o&&sr(i)&&hc(l,i)?FS(l,i).map(d=>He.remove(d.getNode())):o&&ar(i)&&pc(l,i)?US(l,i).map(d=>He.remove(d.getNode())):(d=r,((f,m)=>{const g=m.getNode(!1===f),p=f?"after":"before";return rt(g)&&g.getAttribute("data-mce-caret")===p})(c=o,u=i)?(f=c,m=u.getNode(!1===c),f&&Bt(m.nextSibling)?C.some(He.moveToElement(m.nextSibling)):!1===f&&Bt(m.previousSibling)?C.some(He.moveToElement(m.previousSibling)):C.none()).fold(()=>Dv(d,c,u),C.some):Dv(d,c,u).bind(f=>((m,g,p)=>p.fold(b=>C.some(He.remove(b)),b=>C.some(He.moveToElement(b)),b=>wn(g,b,m)?C.none():C.some(He.moveToPosition(b))))(d,u,f)));var d,c,u,f,m})(t.getBody(),e,t.selection.getRng()).map(r=>()=>{return r.fold((o=t,s=e,a=>(o._selectionOverrides.hideFakeCaret(),Ir(o,s,N(a)),!0)),((o,s)=>a=>{const i=s?I.before(a):I.after(a);return o.selection.setRng(i.toRange()),!0})(t,e),(o=>s=>(o.selection.setRng(s.toRange()),!0))(t));var o,s}),()=>C.some(pt))})(t,e):((n,r)=>{const o=n.selection.getNode();return Bt(o)&&!Sa(o)?Pv(n,o.parentNode).filter(Bt).fold(()=>C.some(()=>{var s;s=N(n.getBody()),H(Ee(s,".mce-offscreen-selection"),Mt),Ir(n,r,N(n.selection.getNode())),Tb(n)}),()=>C.some(pt)):wu(n)?C.some(()=>{Db(n,n.selection.getRng(),N(n.getBody()))}):C.none()})(t,e),ku=(t,e)=>t.selection.isCollapsed()?((n,r)=>{const o=I.fromRangeStart(n.selection.getRng());return Fe(r,n.getBody(),o).filter(s=>r?BS(s):DS(s)).bind(s=>C.from(Nd(r?0:-1,s))).map(s=>()=>n.selection.select(s))})(t,e):C.none(),Bo=G,Mv=t=>Bo(t)&&t.data[0]===ie,Iv=t=>Bo(t)&&t.data[t.data.length-1]===ie,Fv=t=>t.ownerDocument.createTextNode(ie),Pi=(t,e)=>t?(n=>{if(Bo(n.previousSibling))return Iv(n.previousSibling)||n.previousSibling.appendData(ie),n.previousSibling;if(Bo(n))return Mv(n)||n.insertData(0,ie),n;{const r=Fv(n);return n.parentNode.insertBefore(r,n),r}})(e):(n=>{if(Bo(n.nextSibling))return Mv(n.nextSibling)||n.nextSibling.insertData(0,ie),n.nextSibling;if(Bo(n))return Iv(n)||n.appendData(ie),n;{const r=Fv(n);return n.nextSibling?n.parentNode.insertBefore(r,n.nextSibling):n.parentNode.appendChild(r),r}})(e),__=Y(Pi,!0),N_=Y(Pi,!1),Uv=(t,e)=>G(t.container())?Pi(e,t.container()):Pi(e,t.getNode()),zv=(t,e)=>{const n=e.get();return n&&t.container()===n&&lo(n)},Su=(t,e)=>e.fold(n=>{Br(t.get());const r=__(n);return t.set(r),C.some(I(r,r.length-1))},n=>be(n).map(r=>{if(zv(r,t))return I(t.get(),1);{Br(t.get());const o=Uv(r,!0);return t.set(o),I(o,1)}}),n=>Sn(n).map(r=>{if(zv(r,t))return I(t.get(),t.get().length-1);{Br(t.get());const o=Uv(r,!1);return t.set(o),I(o,o.length-1)}}),n=>{Br(t.get());const r=N_(n);return t.set(r),C.some(I(r,1))}),jv=(t,e)=>{for(let n=0;n<t.length;n++){const r=t[n].apply(null,e);if(r.isSome())return r}return C.none()},ue=Cn([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),Vv=(t,e)=>nr(e,t)||t,R_=(t,e,n)=>{const r=Rb(n),o=Vv(e,r.container());return ir(t,o,r).fold(()=>Ue(o,r).bind(Y(ir,t,o)).map(s=>ue.before(s)),C.none)},A_=(t,e)=>null===Pr(t,e),Hv=(t,e,n)=>ir(t,e,n).filter(Y(A_,e)),O_=(t,e,n)=>{const r=Ab(n);return Hv(t,e,r).bind(o=>on(o,r).isNone()?C.some(ue.start(o)):C.none())},T_=(t,e,n)=>{const r=Rb(n);return Hv(t,e,r).bind(o=>Ue(o,r).isNone()?C.some(ue.end(o)):C.none())},B_=(t,e,n)=>{const r=Ab(n),o=Vv(e,r.container());return ir(t,o,r).fold(()=>on(o,r).bind(Y(ir,t,o)).map(s=>ue.after(s)),C.none)},$v=t=>{return e=Eu(t),!1===("rtl"===Et.DOM.getStyle(e,"direction",!0)||WS.test(e.textContent));var e},An=(t,e,n)=>jv([R_,O_,T_,B_],[t,e,n]).filter($v),Eu=t=>t.fold(pe,pe,pe,pe),qv=t=>t.fold(q("before"),q("start"),q("end"),q("after")),Li=t=>t.fold(ue.before,ue.before,ue.after,ue.after),_u=t=>t.fold(ue.start,ue.start,ue.end,ue.end),D_=(t,e,n,r,o,s)=>Se(ir(e,n,r),ir(e,n,o),(a,i)=>a!==i&&((l,d,c)=>{const u=nr(d,l),f=nr(c,l);return u&&u===f})(n,a,i)?ue.after(t?a:i):s).getOr(s),P_=(t,e)=>t.fold(Vt,n=>{return o=e,!(qv(r=n)===qv(o)&&Eu(r)===Eu(o));var r,o}),L_=(t,e)=>t?e.fold(mr(C.some,ue.start),C.none,mr(C.some,ue.after),C.none):e.fold(C.none,mr(C.some,ue.before),C.none,mr(C.some,ue.end)),Wv=(t,e,n)=>{const r=t?1:-1;return e.setRng(I(n.container(),n.offset()+r).toRange()),e.getSel().modify("move",t?"forward":"backward","word"),!0};var On;!function(t){t[t.Br=0]="Br",t[t.Block=1]="Block",t[t.Wrap=2]="Wrap",t[t.Eol=3]="Eol"}(On||(On={}));const Mi=(t,e)=>t===$t.Backwards?Go(e):e,M_=(t,e,n)=>t===$t.Forwards?e.next(n):e.prev(n),I_=(t,e,n,r)=>Ft(r.getNode(e===$t.Forwards))?On.Br:!1===wn(n,r)?On.Block:On.Wrap,Kv=(t,e,n,r)=>{const o=kn(n);let s=r;const a=[];for(;s;){const i=M_(e,o,s);if(!i)break;if(Ft(i.getNode(!1)))return e===$t.Forwards?{positions:Mi(e,a).concat([i]),breakType:On.Br,breakAt:C.some(i)}:{positions:Mi(e,a),breakType:On.Br,breakAt:C.some(i)};if(i.isVisible()){if(t(s,i)){const l=I_(0,e,s,i);return{positions:Mi(e,a),breakType:l,breakAt:C.some(i)}}a.push(i),s=i}else s=i}return{positions:Mi(e,a),breakType:On.Eol,breakAt:C.none()}},Gv=(t,e,n,r)=>e(n,r).breakAt.map(o=>{const s=e(n,o).positions;return t===$t.Backwards?s.concat(o):[o].concat(s)}).getOr([]),Nu=(t,e)=>Be(t,(n,r)=>n.fold(()=>C.some(r),o=>Se(De(o.getClientRects()),De(r.getClientRects()),(s,a)=>{const i=Math.abs(e-s.left);return Math.abs(e-a.left)<=i?r:o}).or(n)),C.none()),Ii=(t,e)=>De(e.getClientRects()).bind(n=>Nu(t,n.left)),Gs=Y(Kv,I.isAbove,-1),Ys=Y(Kv,I.isBelow,1),Yv=Y(Gv,-1,Gs),Xv=Y(Gv,1,Ys),F_=(t,e)=>Ii(Yv(t,e),e),U_=(t,e)=>Ii(Xv(t,e),e),z_=Bt,Qv=(t,e)=>Math.abs(t.left-e),Jv=(t,e)=>Math.abs(t.right-e),Zv=(t,e)=>ga(t,(n,r)=>{const o=Math.min(Qv(n,e),Jv(n,e)),s=Math.min(Qv(r,e),Jv(r,e));return s===o&&Xr(r,"node")&&z_(r.node)||s<o?r:n}),j_=t=>{const e=n=>yt(n,r=>{const o=Ar(r);return o.node=t,o});if(rt(t))return e(t.getClientRects());if(G(t)){const n=t.ownerDocument.createRange();return n.setStart(t,0),n.setEnd(t,t.data.length),e(n.getClientRects())}return[]},ty=t=>Dn(t,j_);var Xs;!function(t){t[t.Up=-1]="Up",t[t.Down=1]="Down"}(Xs||(Xs={}));const ey=(t,e,n,r,o,s)=>{let a=0;const i=[],l=u=>{let f=ty([u]);-1===t&&(f=f.reverse());for(let m=0;m<f.length;m++){const g=f[m];if(!n(g,d)){if(i.length>0&&e(g,fr(i))&&a++,g.line=a,o(g))return!0;i.push(g)}}},d=fr(s.getClientRects());if(!d)return i;const c=s.getNode();return l(c),((u,f,m,g)=>{for(;g=_s(g,u,og,f);)if(m(g))return})(t,r,l,c),i},V_=Y(ey,Xs.Up,ys,Cs),H_=Y(ey,Xs.Down,Cs,ys),ny=t=>e=>e.line>t,Ru=t=>e=>e.line===t,Hn=(t,e)=>{t.selection.setRng(e),Ms(t,t.selection.getRng())},Au=(t,e,n)=>C.some(vu(t,e,n)),ry=(t,e,n,r,o,s)=>{const a=e===$t.Forwards,i=kn(t.getBody()),l=Y(Ad,a?i.next:i.prev),d=a?r:o;if(!n.collapsed){const g=Ma(n);if(s(g))return Vn(e,t,g,e===$t.Backwards,!1);if(wu(t)){const p=n.cloneRange();return p.collapse(e===$t.Backwards),C.from(p)}}const c=As(e,t.getBody(),n);if(d(c))return Ks(t,c.getNode(!a));const u=Ve(a,l(c)),f=eg(n);if(!u)return f?C.some(n):C.none();if(d(u))return Vn(e,t,u.getNode(!a),a,!1);const m=l(u);return m&&d(m)&&$a(u,m)?Vn(e,t,m.getNode(!a),a,!1):f?Au(t,u.toRange(),!1):C.none()},oy=(t,e,n,r,o,s)=>{const a=As(e,t.getBody(),n),i=fr(a.getClientRects()),l=e===Xs.Down,d=t.getBody();if(!i)return C.none();if(wu(t)){const p=l?I.fromRangeEnd(n):I.fromRangeStart(n);return(l?U_:F_)(d,p).orThunk(()=>C.from(p)).map(b=>b.toRange())}const c=(l?H_:V_)(d,ny(1),a),u=dt(c,Ru(1)),f=i.left,m=Zv(u,f);if(m&&s(m.node)){const p=Math.abs(f-m.left),b=Math.abs(f-m.right);return Vn(e,t,m.node,p<b,!1)}let g;if(g=r(a)?a.getNode():o(a)?a.getNode(!0):Ma(n),g){const p=((h,v,y,w)=>{const x=kn(v);let S,k,D,B;const M=[];let O=0;const P=F=>fr(F.getClientRects());1===h?(S=x.next,k=Cs,D=ys,B=I.after(w)):(S=x.prev,k=ys,D=Cs,B=I.before(w));const L=P(B);do{if(!B.isVisible())continue;const F=P(B);if(D(F,L))continue;M.length>0&&k(F,fr(M))&&O++;const V=Ar(F);if(V.position=B,V.line=O,y(V))return M;M.push(V)}while(B=S(B));return M})(e,d,ny(1),g);let b=Zv(dt(p,Ru(1)),f);if(b||(b=fr(dt(p,Ru(0))),b))return Au(t,b.position.toRange(),!1)}return 0===u.length?Ou(t,l).filter(l?o:r).map(p=>vu(t,p.toRange(),!1)):C.none()},Ou=(t,e)=>{const n=t.selection.getRng(),r=e?I.fromRangeEnd(n):I.fromRangeStart(n),o=(s=r.container(),a=t.getBody(),ro(N(s),i=>Vk(i.dom),i=>i.dom===a).map(i=>i.dom).getOr(a));var s,a;if(e){const i=Ys(o,r);return Gr(i.positions)}{const i=Gs(o,r);return De(i.positions)}},sy=(t,e,n)=>Ou(t,e).filter(n).exists(r=>(t.selection.setRng(r.toRange()),!0)),Fi=(t,e)=>{const n=t.dom.createRng();n.setStart(e.container(),e.offset()),n.setEnd(e.container(),e.offset()),t.selection.setRng(n)},ay=(t,e)=>{t?e.setAttribute("data-mce-selected","inline-boundary"):e.removeAttribute("data-mce-selected")},iy=(t,e,n)=>Su(e,n).map(r=>(Fi(t,r),n)),ly=(t,e,n)=>!!ks(t)&&((t,e,n)=>{const r=t.getBody(),o=((s,a,i)=>{const l=I.fromRangeStart(s);if(s.collapsed)return l;{const d=I.fromRangeEnd(s);return i?on(a,d).getOr(d):Ue(a,l).getOr(l)}})(t.selection.getRng(),r,n);return((s,a,i,l)=>{const d=Ve(s,l),c=An(a,i,d);return An(a,i,d).bind(Y(L_,s)).orThunk(()=>((u,f,m,g,p)=>{const b=Ve(u,p);return Fe(u,m,b).map(Y(Ve,u)).fold(()=>g.map(Li),h=>An(f,m,h).map(Y(D_,u,f,m,b,h)).filter(Y(P_,g))).filter($v)})(s,a,i,c,l))})(n,Y(Fr,t),r,o).bind(s=>iy(t,e,s))})(t,e,n).isSome(),dy=(t,e,n)=>!!ks(e)&&((r,o)=>{const s=o.selection.getRng(),a=r?I.fromRangeEnd(s):I.fromRangeStart(s);return!!xt(o.selection.getSel().modify)&&(r&&Jl(a)?Wv(!0,o.selection,a):!(r||!Zl(a))&&Wv(!1,o.selection,a))})(t,e),W_=Y(dy,!0),K_=Y(dy,!1),Ui=(t,e,n)=>{if(ks(t)){const r=Ou(t,e).getOrThunk(()=>{const o=t.selection.getRng();return e?I.fromRangeEnd(o):I.fromRangeStart(o)});return An(Y(Fr,t),t.getBody(),r).exists(o=>{const s=Li(o);return Su(n,s).exists(a=>(Fi(t,a),!0))})}return!1},cy=(t,e)=>n=>Su(e,n).map(r=>()=>Fi(t,r)),uy=(t,e,n,r)=>{const o=t.getBody(),s=Y(Fr,t);t.undoManager.ignore(()=>{t.selection.setRng(((a,i)=>{const l=document.createRange();return l.setStart(a.container(),a.offset()),l.setEnd(i.container(),i.offset()),l})(n,r)),Cc(t),An(s,o,I.fromRangeStart(t.selection.getRng())).map(_u).bind(cy(t,e)).each(qo)}),t.nodeChanged()},Tu=(t,e,n)=>{if(t.selection.isCollapsed()&&ks(t)){const r=I.fromRangeStart(t.selection.getRng());return((o,s,a,i)=>{const l=(u=o.getBody(),f=i.container(),nr(f,u)||u),d=Y(Fr,o),c=An(d,l,i);var u,f;return c.bind(u=>a?u.fold(q(C.some(_u(u))),C.none,q(C.some(Li(u))),C.none):u.fold(C.none,q(C.some(Li(u))),C.none,q(C.some(_u(u))))).map(cy(o,s)).getOrThunk(()=>{const u=Wa(a,l,i),f=u.bind(m=>An(d,l,m));return Se(c,f,()=>ir(d,l,i).bind(m=>{return Se(be(g=m),Sn(g),(p,b)=>{const h=Ve(!0,p),v=Ve(!1,b);return Ue(g,h).forall(y=>y.isEqual(v))}).getOr(!0)?C.some(()=>{Ir(o,a,N(m))}):C.none();var g})).getOrThunk(()=>f.bind(()=>u.map(m=>()=>{a?uy(o,s,i,m):uy(o,s,m,i)})))})})(t,e,n,r)}return C.none()},G_=t=>1===Rf(t),Bu=(t,e)=>t.selection.isCollapsed()?((t,e)=>{const n=N(t.getBody()),r=N(t.selection.getStart()),o=dt(((s,a)=>{const i=zn(a,s);return Ko(i,en).fold(q(i),l=>i.slice(0,l))})(n,r),G_);return Gr(o).bind(s=>{const a=I.fromRangeStart(t.selection.getRng());return l=e,d=a,!Se(be(c=s.dom),Sn(c),(u,f)=>{const m=Ve(!0,u),g=Ve(!1,f),p=Ve(!1,d);return l?Ue(c,p).exists(b=>b.isEqual(g)&&d.isEqual(m)):on(c,p).exists(b=>b.isEqual(m)&&d.isEqual(g))}).getOr(!0)||En((i=s).dom)&&Zb(i.dom)?C.none():C.some(()=>((l,d,c,u)=>{const f=Y(sE,d),m=yt(dt(u,f),g=>g.dom);if(0===m.length)Ir(d,l,c);else{const g=((p,b)=>{const h=jc(!1),v=n0(b,h.dom);return Xe(N(p),h),Mt(N(p)),I(v,0)})(c.dom,m);d.selection.setRng(g.toRange())}})(e,t,s,o));var l,d,c,i})})(t,e):C.none(),Du=(t,e,n)=>C.some(()=>{t._selectionOverrides.hideFakeCaret(),Ir(t,e,N(n))}),Pu=(t,e)=>t.selection.isCollapsed()?((n,r)=>{const o=r?Fs:Us,a=As(r?$t.Forwards:$t.Backwards,n.getBody(),n.selection.getRng());return o(a)?Du(n,r,a.getNode(!r)):C.from(Ve(r,a)).filter(i=>o(i)&&$a(a,i)).map(i=>()=>Du(n,r,i.getNode(!r)))})(t,e):((n,r)=>{const o=n.selection.getNode();return yn(o)?Du(n,r,o):C.none()})(t,e),Lu=t=>{const e=parseInt(t,10);return isNaN(e)?0:e},my=(t,e)=>(t||"table"===Tt(e)?"margin":"padding")+("rtl"===bn(e,"direction")?"-right":"-left"),fy=t=>{const e=py(t);return!t.mode.isReadOnly()&&(e.length>1||(n=t,Kr(e,o=>{const s=my(cp(n),o),a=Ca(o,s).map(Lu).getOr(0);return"false"!==n.dom.getContentEditable(o.dom)&&a>0})));var n},gy=t=>Ql(t)||ms(t),py=t=>{return dt((e=t.selection.getSelectedBlocks(),yt(e,N)),n=>!gy(n)&&!Ye(n).exists(gy)&&oo(n,r=>vn(r.dom)||Bt(r.dom)).exists(r=>vn(r.dom)));var e},hy=(t,e)=>{const{dom:n}=t,r=qx(t),o=/[a-z%]+$/i.exec(r)[0],s=parseInt(r,10),a=cp(t);H(py(t),i=>{((l,d,c,u,f,m)=>{const g=my(c,N(m));if("outdent"===d){const p=Math.max(0,Lu(m.style[g])-u);l.setStyle(m,g,p?p+f:"")}else{const p=Lu(m.style[g])+u+f;l.setStyle(m,g,p)}})(n,e,a,s,o,i.dom)})},by=t=>hy(t,"outdent"),vy=t=>{if(t.selection.isCollapsed()&&fy(t)){const e=t.dom,n=t.selection.getRng(),r=I.fromRangeStart(n),o=e.getParent(n.startContainer,e.isBlock);if(null!==o&&gc(N(o),r))return C.some(()=>by(t))}return C.none()},yy=(t,e,n)=>Yr([vy,xu,yu,(r,o)=>Tu(r,e,o),hu,Rc,ku,Pu,bu,Bu],r=>r(t,n)),Cy=t=>void 0===t.touches||1!==t.touches.length?C.none():C.some(t.touches[0]),Mu=(t,e)=>gt(t,e.nodeName),Q_=(t,e)=>!!G(e)||!!rt(e)&&!Mu(t,e)&&!ze(e),J_=(t,e)=>!(!G(e)||0!==e.nodeValue.length&&(!/^\s+$/.test(e.nodeValue)||e.nextSibling&&!Mu(t,e.nextSibling))),Z_=t=>{const e=t.dom,n=t.selection,r=t.schema,o=r.getBlockElements();let s=n.getStart();const a=t.getBody();let i,l,d;const c=_e(t);if(!s||!rt(s))return;const u=a.nodeName.toLowerCase();if(!r.isValidChild(u,c.toLowerCase())||(v=o,y=a,It(fb(N(s),N(y)),x=>Mu(v,x.dom))))return;var v,y;const f=n.getRng(),m=f.startContainer,g=f.startOffset,p=f.endContainer,b=f.endOffset,h=Lr(t);for(s=a.firstChild;s;)if(Q_(o,s)){if(J_(o,s)){l=s,s=s.nextSibling,e.remove(l);continue}i||(i=e.create(c,Tr(t)),s.parentNode.insertBefore(i,s),d=!0),l=s,s=s.nextSibling,i.appendChild(l)}else i=null,s=s.nextSibling;d&&h&&(f.setStart(m,g),f.setEnd(p,b),n.setRng(f),t.nodeChanged())},wy=t=>e=>-1!==(" "+e.attr("class")+" ").indexOf(t),tN=(t,e,n)=>function(r){const o=arguments,s=o[o.length-2],a=s>0?e.charAt(s-1):"";if('"'===a)return r;if(">"===a){const i=e.lastIndexOf("<",s);if(-1!==i&&-1!==e.substring(i,s).indexOf('contenteditable="false"'))return r}return'<span class="'+n+'" data-mce-content="'+t.dom.encode(o[0])+'">'+t.dom.encode("string"==typeof o[1]?o[1]:o[0])+"</span>"},xy=(t,e)=>{e.hasAttribute("data-mce-caret")&&(td(e),t.selection.setRng(t.selection.getRng()),t.selection.scrollIntoView(e))},eN=(t,e)=>{const n=us(N(t.getBody()),"*[data-mce-caret]").map(o=>o.dom).getOrNull();if(n)return"compositionstart"===e.type?(e.preventDefault(),e.stopPropagation(),void xy(t,n)):void(tg(n)&&(xy(t,n),t.undoManager.add()))},ky=Bt,Sy=(t,e,n)=>{const r=kn(t.getBody()),o=Y(Ad,1===e?r.next:r.prev);if(n.collapsed){const s=t.dom.getParent(n.startContainer,"PRE");if(!s)return;if(!o(I.fromRangeStart(n))){const a=N((i=>{const l=i.dom.create(_e(i));return l.innerHTML='<br data-mce-bogus="1">',l})(t));1===e?Kn(N(s),a):Xe(N(s),a),t.selection.select(a.dom,!0),t.selection.collapse()}}},Ey=(t,e)=>((n,r)=>{const o=r?$t.Forwards:$t.Backwards,s=n.selection.getRng();return(a=o,i=n,l=s,ry(i,a,l,sr,ar,ky)).orThunk(()=>(Sy(n,o,s),C.none()));var a,i,l})(t,e).exists(n=>(Hn(t,n),!0)),_y=(t,e)=>((n,r)=>{const o=r?1:-1,s=n.selection.getRng();return(a=o,i=n,l=s,oy(i,a,l,d=>sr(d)||ub(d),d=>ar(d)||mb(d),ky)).orThunk(()=>(Sy(n,o,s),C.none()));var a,i,l})(t,e).exists(n=>(Hn(t,n),!0)),Ny=(t,e)=>sy(t,e,e?ar:sr),zi=(t,e)=>Cu(t,!e).map(n=>{const r=n.toRange(),o=t.selection.getRng();return e?r.setStart(o.startContainer,o.startOffset):r.setEnd(o.endContainer,o.endOffset),r}).exists(n=>(Hn(t,n),!0)),nN=t=>Ot(["figcaption"],Tt(t)),Ry=(t,e)=>!!t.selection.isCollapsed()&&((t,e)=>{const n=N(t.getBody()),r=I.fromRangeStart(t.selection.getRng()),o=_e(t),s=Tr(t);return((a,i)=>{const l=Y(kt,i);return oo(N(a.container()),en,l).filter(nN)})(r,n).exists(()=>{if(a=n,l=r,e?Ys(a.dom,l).breakAt.isNone():Gs(a.dom,l).breakAt.isNone()){const a=((i,l,d,c)=>{const u=Ut(d),f=Ut("br");return pn(u,c),Ht(u,f),m=i,g=u,l?Ht(m,g):If(m,g),(m=>{const g=document.createRange();return g.setStartBefore(m.dom),g.setEndBefore(m.dom),g})(f);var m,g})(n,e,o,s);return t.selection.setRng(a),!0}var a,l;return!1})})(t,e),Ay={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},Oy=(t,e)=>e.keyCode===t.keyCode&&e.shiftKey===t.shiftKey&&e.altKey===t.altKey&&e.ctrlKey===t.ctrlKey&&e.metaKey===t.metaKey,mt=(t,...e)=>()=>t.apply(null,e),Qs=(t,e)=>{return Gt((r=e,Dn(yt(t,s=>at(Rt(at({},Ay),{action:pt}),s)),o=>Oy(o,r)?[o]:[])),n=>n.action());var r},Ty=(t,e)=>{return Yr((r=e,Dn(yt(t,s=>at(Rt(at({},Ay),{action:()=>C.none()}),s)),o=>Oy(o,r)?[o]:[])),n=>n.action());var r},By=(t,e)=>{const n=e?$t.Forwards:$t.Backwards,r=t.selection.getRng();return ry(t,n,r,Fs,Us,yn).exists(o=>(Hn(t,o),!0))},Dy=(t,e)=>{const n=e?1:-1,r=t.selection.getRng();return oy(t,n,r,Fs,Us,yn).exists(o=>(Hn(t,o),!0))},Py=(t,e)=>sy(t,e,e?Us:Fs),Ly=Cn([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Js=Rt(at({},Ly),{none:t=>Ly.none(t)}),My=(t,e,n)=>Dn(se(t),r=>hn(r,e)?n(r)?[r]:[]:My(r,e,n)),Iy=(t,e)=>kr(t,"table",e),Iu=(t,e,n,r,o=Vt)=>{const s=1===r;if(!s&&n<=0)return Js.first(t[0]);if(s&&n>=t.length-1)return Js.last(t[t.length-1]);{const a=n+r,i=t[a];return o(i)?Js.middle(e,i):Iu(t,e,a,r,o)}},Fy=(t,e)=>Iy(t,e).bind(n=>{const r=My(n,"th,td",Vt);return Ko(r,o=>kt(t,o)).map(o=>({index:o,all:r}))}),Uy=(t,e=!1)=>{return eo(t)?t.dom.isContentEditable:(n=t,kr(n,"[contenteditable]")).fold(q(e),r=>"true"===oN(r));var n},oN=t=>t.dom.contentEditable,zy=(t,e,n,r,o)=>{const s=Ee(N(n),"td,th,caption").map(i=>i.dom);var i;return((i,l,d)=>Be(i,(c,u)=>c.fold(()=>C.some(u),f=>{const m=Math.sqrt(Math.abs(f.x-l)+Math.abs(f.y-d)),g=Math.sqrt(Math.abs(u.x-l)+Math.abs(u.y-d));return C.some(g<m?u:f)}),C.none()))(dt((i=t,Dn(s,d=>{const c={left:(u=Ar(d.getBoundingClientRect())).left- -1,top:u.top- -1,right:u.right+-2,bottom:u.bottom+-2,width:u.width+-1,height:u.height+-1};var u;return[{x:c.left,y:i(c),cell:d},{x:c.right,y:i(c),cell:d}]})),i=>e(i,o)),r,o).map(i=>i.cell)},sN=Y(zy,t=>t.bottom,(t,e)=>t.y<e),aN=Y(zy,t=>t.top,(t,e)=>t.y>e),jy=(t,e,n)=>{const r=t(e,n);return(o=r).breakType===On.Wrap&&0===o.positions.length||!Ft(n.getNode())&&(o=>o.breakType===On.Br&&1===o.positions.length)(r)?!((o,s,a)=>a.breakAt.exists(i=>o(s,i).breakAt.isSome()))(t,e,r):r.breakAt.isNone();var o},iN=Y(jy,Gs),lN=Y(jy,Ys),dN=(t,e,n,r)=>{const o=t.selection.getRng(),s=e?1:-1;return!(!Ep()||!((a,i,l)=>{const d=I.fromRangeStart(i);return yo(!a,l).exists(c=>c.isEqual(d))})(e,o,n)||(Vn(s,t,n,!e,!1).each(a=>{Hn(t,a)}),0))},Vy=(t,e,n)=>{const r=((s,a)=>{const i=a.getNode(s);return rt(i)&&"TABLE"===i.nodeName?C.some(i):C.none()})(!!e,n),o=!1===e;r.fold(()=>Hn(t,n.toRange()),s=>yo(o,t.getBody()).filter(a=>a.isEqual(n)).fold(()=>Hn(t,n.toRange()),a=>((i,l,d)=>{const c=_e(l);l.undoManager.transact(()=>{const u=Ut(c);pn(u,Tr(l)),Ht(u,Ut("br")),i?Kn(N(d),u):Xe(N(d),u);const f=l.dom.createRng();f.setStart(u.dom,0),f.setEnd(u.dom,0),Hn(l,f)})})(e,t,s)))},cN=(t,e,n,r)=>{const o=t.selection.getRng(),s=I.fromRangeStart(o),a=t.getBody();if(!e&&iN(r,s)){const i=(l=a,(u=d=n,f=c=s,De(f.getClientRects()).bind(m=>sN(u,m.left,m.top)).bind(m=>{return Ii(Sn(g=m).map(p=>Gs(g,p).positions.concat(p)).getOr([]),f);var g})).orThunk(()=>De(c.getClientRects()).bind(u=>Nu(Yv(l,I.before(d)),u.left))).getOr(I.before(d)));return Vy(t,e,i),!0}var l,d,c,u,f;if(e&&lN(r,s)){const i=((l,d,c)=>((u,f)=>Gr(f.getClientRects()).bind(m=>aN(u,m.left,m.top)).bind(m=>{return Ii(be(g=m).map(p=>[p].concat(Ys(g,p).positions)).getOr([]),f);var g}))(d,c).orThunk(()=>De(c.getClientRects()).bind(u=>Nu(Xv(l,I.after(d)),u.left))).getOr(I.after(d)))(a,n,s);return Vy(t,e,i),!0}return!1},Hy=(t,e,n)=>C.from(t.dom.getParent(t.selection.getNode(),"td,th")).bind(r=>C.from(t.dom.getParent(r,"table")).map(o=>n(t,e,o,r))).getOr(!1),$y=(t,e)=>Hy(t,e,dN),qy=(t,e)=>Hy(t,e,cN),Wy=(t,e,n)=>n.fold(C.none,C.none,(r,o)=>{return(s=o,((a,i)=>{const l=d=>{for(let c=0;c<d.childNodes.length;c++){const u=N(d.childNodes[c]);if(i(u))return C.some(u);const f=l(d.childNodes[c]);if(f.isSome())return f}return C.none()};return l(a.dom)})(s,Qh)).map(a=>{return(t=>{const e=So.getWin(t).dom,n=(o,s,a,i)=>Yd(e,o,s,a,i),r=t.match({domRange:s=>{const a=N(s.startContainer),i=N(s.endContainer);return _h(a,s.startOffset,i,s.endOffset)},relative:sS,exact:_h});return((o,s)=>{var i;return((i,l)=>{const d=l.ltr();return d.collapsed?l.rtl().filter(c=>!1===c.collapsed).map(c=>Ls.rtl(N(c.endContainer),c.endOffset,N(c.startContainer),c.startOffset)).getOrThunk(()=>Sh(0,Ls.ltr,d)):Sh(0,Ls.ltr,d)})(0,(i=o,s.match({domRange:d=>({ltr:q(d),rtl:C.none}),relative:(d,c)=>({ltr:gr(()=>kh(i,d,c)),rtl:gr(()=>C.some(kh(i,c,d)))}),exact:(d,c,u,f)=>({ltr:gr(()=>Yd(i,d,c,u,f)),rtl:gr(()=>C.some(Yd(i,u,f,d,c)))})})))})(e,r).match({ltr:n,rtl:n})})(So.exact(i=a,0,i,0));var i});var s},r=>(t.execCommand("mceTableInsertRowAfter"),Ky(t,e,r))),Ky=(t,e,n)=>{return Wy(t,e,(o=Uy,Fy(r=n,void 0).fold(()=>Js.none(r),s=>Iu(s.all,r,s.index,1,o))));var r,o},uN=(t,e,n)=>{return Wy(t,e,(o=Uy,Fy(r=n,void 0).fold(()=>Js.none(),s=>Iu(s.all,r,s.index,-1,o))));var r,o},Gy=(t,e)=>{const n=["table","li","dl"],r=N(t.getBody()),o=a=>{const i=Tt(a);return kt(a,r)||Ot(n,i)},s=t.selection.getRng();return(a=N(e?s.endContainer:s.startContainer),i=o,((l,d,c=Dt)=>c(d)?C.none():Ot(l,Tt(d))?C.some(d):cs(d,l.join(","),u=>hn(u,"table")||c(u)))(["td","th"],a,i)).map(a=>(Iy(a,o).each(i=>{t.model.table.clearSelectedCells(i.dom)}),t.selection.collapse(!e),(e?Ky:uN)(t,o,a).each(i=>{t.selection.setRng(i)}),!0)).getOr(!1);var a,i},dn=(t,e)=>({container:t,offset:e}),ji=Et.DOM,Vi=t=>e=>t===e?-1:0,Fu=(t,e,n)=>{if(G(t)&&e>=0)return C.some(dn(t,e));{const r=Rr(ji);return C.from(r.backwards(t,e,Vi(t),n)).map(o=>dn(o.container,o.container.data.length))}},Uu=(t,e,n)=>{if(!G(t))return C.none();if(e>=0&&e<=t.textContent.length)return C.some(dn(t,e));{const o=Rr(ji);return C.from(o.backwards(t,e,Vi(t),n)).bind(s=>Uu(s.container,e+s.container.data.length,n))}},Yy=(t,e,n)=>{if(!G(t))return C.none();const r=t.textContent;if(e<=r.length)return C.some(dn(t,e));{const o=Rr(ji);return C.from(o.forwards(t,e,Vi(t),n)).bind(s=>Yy(s.container,e-r.length,n))}},zu=(t,e,n,r,o)=>{const s=Rr(t,(a=t,i=>a.isBlock(i)||Ot(["BR","IMG","HR","INPUT"],i.nodeName)||"false"===a.getContentEditable(i)));var a;return C.from(s.backwards(e,n,r,o))},Xy=t=>t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,""),Qy=t=>""!==t&&-1!==" \xa0\f\n\r\t\v".indexOf(t),ju=(t,e)=>t.substring(e.length),Jy=(t,e,n,r=0)=>{return(o=N(e.startContainer),kr(o,Jh)).fold(()=>((s,a,i,l=0)=>{if(!(d=a).collapsed||3!==d.startContainer.nodeType)return C.none();var d;const c=s.getParent(a.startContainer,s.isBlock)||s.getRoot();return zu(s,a.startContainer,a.startOffset,(u,f,m)=>((g,p,b)=>{let h;for(h=p-1;h>=0;h--){const v=g.charAt(h);if(Qy(v))return C.none();if(v===b)break}return C.some(h)})(m,f,i).getOr(f),c).bind(u=>{const f=a.cloneRange();if(f.setStart(u.container,u.offset),f.setEnd(a.endContainer,a.endOffset),f.collapsed)return C.none();const m=Xy(f);return 0!==m.lastIndexOf(i)||ju(m,i).length<l?C.none():C.some({text:ju(m,i),range:f,triggerChar:i})})})(t,e,n,r),s=>{const a=t.createRng();a.selectNode(s.dom);const i=Xy(a);return C.some({range:a,text:ju(i,n),triggerChar:n})});var o},Zy=t=>{if(3===t.nodeType)return dn(t,t.data.length);{const e=t.childNodes;return e.length>0?Zy(e[e.length-1]):dn(t,e.length)}},tC=(t,e)=>{const n=t.childNodes;return n.length>0&&e<n.length?tC(n[e],0):n.length>0&&1===t.nodeType&&n.length===e?Zy(n[n.length-1]):dn(t,e)},eC=(t,e,n,r={})=>{const o=e(),s=t.selection.getRng().startContainer.nodeValue,a=dt(o.lookupByChar(n.triggerChar),l=>n.text.length>=l.minChars&&l.matches.getOrThunk(()=>{return d=t.dom,c=>{const u=tC(c.startContainer,c.startOffset);return!((f,m)=>{const g=f.getParent(m.container,f.isBlock);return zu(f,m.container,m.offset,(p,b)=>0===b?-1:b,g).filter(p=>{const b=p.container.data.charAt(p.offset-1);return!Qy(b)}).isSome()})(d,u)};var d})(n.range,s,n.text));if(0===a.length)return C.none();const i=Promise.all(yt(a,l=>l.fetch(n.text,l.maxResults,r).then(d=>({matchText:n.text,items:d,columns:l.columns,onAction:l.onAction,highlightOn:l.highlightOn}))));return C.some({lookupData:i,context:n})};var Tn;!function(t){t[t.Error=0]="Error",t[t.Value=1]="Value"}(Tn||(Tn={}));const Vu=(t,e,n)=>t.stype===Tn.Error?e(t.serror):n(t.svalue),Do=t=>({stype:Tn.Value,svalue:t}),Zs=t=>({stype:Tn.Error,serror:t}),mN=Vu,Hu=t=>Te(t)&&Ke(t).length>100?" removed due to size":JSON.stringify(t,null,2),Hi=(t,e)=>Zs([{path:t,getErrorInfo:e}]),nC=t=>(...e)=>{if(0===e.length)throw new Error("Can't merge zero objects");const n={};for(let r=0;r<e.length;r++){const o=e[r];for(const s in o)gt(o,s)&&(n[s]=t(n[s],o[s]))}return n},$u=nC((t,e)=>Dm(t)&&Dm(e)?$u(t,e):e),rC=(nC((t,e)=>e),t=>({tag:"defaultedThunk",process:q(t)})),oC=(t,e,n)=>{switch(t.tag){case"field":return e(t.key,t.newKey,t.presence,t.prop);case"custom":return n(t.newKey,t.instantiator)}},qu=t=>({extract:(e,n)=>{return(r=t(n)).stype===Tn.Error?Hi(e,q(r.serror)):r;var r},toString:q("val")}),pN=qu(Do),sC=(t,e,n,r)=>r(Nt(t,e).getOrThunk(()=>n(t))),hN=(t,e,n,r,o)=>{const s=i=>o.extract(e.concat([r]),i),a=i=>i.fold(()=>Do(C.none()),l=>{return(c=o.extract(e.concat([r]),l)).stype===Tn.Value?{stype:Tn.Value,svalue:(0,C.some)(c.svalue)}:c;var c});switch(t.tag){case"required":return i=e,c=s,Nt(l=n,d=r).fold(()=>{return f=d,m=l,Hi(i,()=>'Could not find valid *required* value for "'+f+'" in '+Hu(m));var f,m},c);case"defaultedThunk":return sC(n,r,t.process,s);case"option":return((i,l,d)=>d(Nt(i,l)))(n,r,a);case"defaultedOptionThunk":return((i,l,d,c)=>c(Nt(i,l).map(u=>!0===u?d(i):u)))(n,r,t.process,a);case"mergeWithThunk":return sC(n,r,q({}),i=>{const l=$u(t.process(n),i);return s(l)})}var i,l,d,c},Wu=t=>({extract:(e,n)=>((r,o,s)=>{const a={},i=[];for(const l of s)oC(l,(d,c,u,f)=>{const m=hN(u,r,o,d,f);mN(m,g=>{i.push(...g)},g=>{a[c]=g})},(d,c)=>{a[d]=c(o)});return i.length>0?Zs(i):Do(a)})(e,n,t),toString:()=>"obj{\n"+yt(t,n=>oC(n,(r,o,s,a)=>r+" -> "+a.toString(),(r,o)=>"state("+r+")")).join("\n")+"}"}),aC=t=>({extract:(e,n)=>(t=>{const e=(r=>{const o=[],s=[];return H(r,a=>{Vu(a,i=>s.push(i),i=>o.push(i))}),{values:o,errors:s}})(t);return e.errors.length>0?(n=e.errors,mr(Zs,Fm)(n)):Do(e.values);var n})(yt(n,(o,s)=>t.extract(e.concat(["["+s+"]"]),o))),toString:()=>"array("+t.toString()+")"}),iC=(t,e)=>((t,e)=>({extract:(n,r)=>Nt(r,t).fold(()=>{return s=t,Hi(n,()=>'Choice schema did not contain choice key: "'+s+'"');var s},o=>{return s=n,a=r,Nt(i=e,l=o).fold(()=>{return c=i,u=l,Hi(s,()=>'The chosen schema: "'+u+'" did not exist in branches: '+Hu(c));var c,u},d=>d.extract(s.concat(["branch: "+l]),a));var s,a,i,l}),toString:()=>"chooseOn("+t+"). Possible values: "+Ke(e)}))(t,Xo(e,Wu)),vN=q(pN),$i=(t,e)=>qu(n=>{const r=typeof n;return t(n)?Do(n):Zs(`Expected type: ${e} but got: ${r}`)}),yN=$i(mn,"number"),qi=$i(st,"string"),CN=$i(ur,"boolean"),Ku=$i(xt,"function"),ta=(t,e,n,r)=>({tag:"field",key:t,newKey:e,presence:n,prop:r}),lC=(t,e)=>({tag:"custom",newKey:t,instantiator:e}),dC=(t,e)=>ta(t,t,{tag:"required",process:{}},e),cC=t=>dC(t,qi),uC=t=>dC(t,Ku),Gu=(t,e)=>ta(t,t,{tag:"option",process:{}},e),Wi=t=>Gu(t,qi),Po=(t,e,n)=>ta(t,t,rC(e),n),mC=(t,e)=>Po(t,e,yN),fC=(t,e,n)=>{return Po(t,e,(r=n,o=s=>Ot(r,s)?he.value(s):he.error(`Unsupported value: "${s}", choose one of "${r.join(", ")}".`),qu(s=>o(s).fold(Zs,Do))));var r,o},Yu=(t,e)=>Po(t,e,CN),Xu=(t,e)=>Po(t,e,Ku),wN=cC("type"),xN=uC("fetch"),Qu=uC("onAction"),kN=Xu("onSetup",()=>pt),SN=Wi("text"),EN=Wi("icon"),_N=Wi("tooltip"),NN=Wi("label"),RN=Yu("active",!1),AN=Yu("enabled",!0),gC=Yu("primary",!1),ea=t=>Po("type",t,qi),ON=Wu([wN,cC("ch"),mC("minChars",1),((t,e)=>ta(t,t,rC(1),vN()))("columns"),mC("maxResults",10),Gu("matches",Ku),xN,Qu,(pC=qi,Po("highlightOn",[],aC(pC)))]);var pC;const Ju=[AN,_N,EN,SN,kN],hC=[RN].concat(Ju),TN=[Xu("predicate",Dt),fC("scope","node",["node","editor"]),fC("position","selection",["node","selection","line"])],BN=Ju.concat([ea("contextformbutton"),gC,Qu,lC("original",pe)]),DN=hC.concat([ea("contextformbutton"),gC,Qu,lC("original",pe)]),PN=Ju.concat([ea("contextformbutton")]),LN=hC.concat([ea("contextformtogglebutton")]),MN=iC("type",{contextformbutton:BN,contextformtogglebutton:DN});Wu([ea("contextform"),Xu("initValue",q("")),NN,((t,e)=>ta(t,t,{tag:"required",process:{}},aC(e)))("commands",MN),Gu("launch",iC("type",{contextformbutton:PN,contextformtogglebutton:LN}))].concat(TN));const FN=t=>{const e=Zn(),n=Xt(!1),r=e.isSet,o=()=>{r()&&(Lt(t).autocompleter.removeDecoration(),t.dispatch("AutocompleterEnd"),n.set(!1),e.clear())},s=gr(()=>(t=>{const e=t.ui.registry.getAll().popups,n=Xo(e,s=>{return(a=s,((t,e,n)=>{return r=(i=e.extract([t],a=n)).stype===Tn.Error?{stype:Tn.Error,serror:(i=>({input:a,errors:i}))(i.serror)}:i,Vu(r,he.error,he.value);var a,i,r})("Autocompleter",ON,a)).fold(i=>{throw new Error("Errors: \n"+(d=>{const c=d.length>10?d.slice(0,10).concat([{path:[],getErrorInfo:q("... (only showing first ten failures)")}]):d;return yt(c,u=>"Failed path: ("+u.path.join(" > ")+")\n"+u.getErrorInfo())})((l=i).errors).join("\n")+"\n\nInput object: "+Hu(l.input));var l},pe);var a}),r=zm(Ol(n,s=>s.ch)),o=Tl(n);return{dataset:n,triggerChars:r,lookupByChar:s=>dt(o,a=>a.ch===s)}})(t)),a=i=>{var l;(l=i,e.get().map(d=>Jy(t.dom,t.selection.getRng(),d.triggerChar).bind(c=>eC(t,s,c,l))).getOrThunk(()=>((d,c)=>{const u=c(),f=d.selection.getRng();return(m=d.dom,g=f,p=u,Yr(p.triggerChars,b=>Jy(m,g,b))).bind(m=>eC(d,c,m));var m,g,p})(t,s))).fold(o,l=>{var d,u;d=l.context,r()||(u=d.range,Lt(t).autocompleter.addDecoration(u),e.set({triggerChar:d.triggerChar,matchLength:d.text.length})),l.lookupData.then(d=>{e.get().map(c=>{const u=l.context;c.triggerChar===u.triggerChar&&(u.text.length-c.matchLength>=10?o():(e.set(Rt(at({},c),{matchLength:u.text.length})),n.get()?t.dispatch("AutocompleterUpdate",{lookupData:d}):(n.set(!0),t.dispatch("AutocompleterStart",{lookupData:d}))))})})})};t.addCommand("mceAutocompleterReload",(i,l)=>{const d=Te(l)?l.fetchOptions:{};a(d)}),t.addCommand("mceAutocompleterClose",o),((i,l)=>{const d=fd(l.load,50);i.on("keypress compositionend",c=>{27!==c.which&&d.throttle()}),i.on("keydown",c=>{const u=c.which;8===u?d.throttle():27===u&&l.cancelIfNecessary()}),i.on("remove",d.cancel)})(t,{cancelIfNecessary:o,load:a})},bC=t=>(e,n,r={})=>{const o=e.getBody(),s={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:o,currentTarget:o,eventPhase:Event.AT_TARGET,originalTarget:o,explicitOriginalTarget:o,isTrusted:!1,srcElement:o,cancelable:!1,preventDefault:pt,inputType:n},a=pg(new InputEvent(t));return e.dispatch(t,at(at(at({},a),s),r))},Zu=bC("input"),tm=bC("beforeinput"),na=(t,e)=>{let n,r=e;const o=t.dom,s=t.schema.getMoveCaretBeforeOnEnterElements();if(!e)return;if(/^(LI|DT|DD)$/.test(e.nodeName)){const i=(l=>{for(;l;){if(1===l.nodeType||3===l.nodeType&&l.data&&/[\r\n\s]/.test(l.data))return l;l=l.nextSibling}})(e.firstChild);i&&/^(UL|OL|DL)$/.test(i.nodeName)&&e.insertBefore(o.doc.createTextNode(ae),e.firstChild)}const a=o.createRng();if(e.normalize(),e.hasChildNodes()){const i=new zt(e,e);for(;n=i.current();){if(G(n)){a.setStart(n,0),a.setEnd(n,0);break}if(s[n.nodeName.toLowerCase()]){a.setStartBefore(n),a.setEndBefore(n);break}r=n,n=i.next()}n||(a.setStart(r,0),a.setEnd(r,0))}else Ft(e)?e.nextSibling&&o.isBlock(e.nextSibling)?(a.setStartBefore(e),a.setEndBefore(e)):(a.setStartAfter(e),a.setEndAfter(e)):(a.setStart(e,0),a.setEnd(e,0));t.selection.setRng(a),Ms(t,a)},em=t=>C.from(t.dom.getParent(t.selection.getStart(!0),t.dom.isBlock)),vC=(t,e)=>t&&t.parentNode&&t.parentNode.nodeName===e,yC=t=>t&&/^(OL|UL|LI)$/.test(t.nodeName),Ki=t=>{const e=t.parentNode;return/^(LI|DT|DD)$/.test(e.nodeName)?e:t},Gi=(t,e,n)=>{let r=t[n?"firstChild":"lastChild"];for(;r&&!rt(r);)r=r[n?"nextSibling":"previousSibling"];return r===e},UN=(t,e)=>e&&"A"===e.nodeName&&t.isEmpty(e),nm=t=>{t.innerHTML='<br data-mce-bogus="1">'},rm=(t,e)=>t.nodeName===e||t.previousSibling&&t.previousSibling.nodeName===e,CC=(t,e)=>e&&t.isBlock(e)&&!/^(TD|TH|CAPTION|FORM)$/.test(e.nodeName)&&!/^(fixed|absolute)/i.test(e.style.position)&&"true"!==t.getContentEditable(e),om=(t,e,n)=>!1===G(e)?n:t?1===n&&e.data.charAt(n-1)===ie?0:n:n===e.data.length-1&&e.data.charAt(n)===ie?e.data.length:n,wC=(t,e)=>{const n=t.getRoot();let r,o;for(r=e;r!==n&&"false"!==t.getContentEditable(r);)"true"===t.getContentEditable(r)&&(o=r),r=r.parentNode;return r!==n?o:n},ra=(t,e)=>{_e(t).toLowerCase()===e.tagName.toLowerCase()&&((n,r,o)=>{const s=n.dom;C.from(o.style).map(s.parseStyle).each(c=>{const u=at(at({},Lf(N(r))),c);s.setStyles(r,u)});const a=C.from(o.class).map(c=>c.split(/\s+/)),i=C.from(r.className).map(c=>dt(c.split(/\s+/),u=>""!==u));Se(a,i,(c,u)=>{const f=dt(u,g=>!Ot(c,g)),m=[...c,...f];s.setAttrib(r,"class",m.join(" "))});const l=["style","class"],d=Qo(o,(c,u)=>!Ot(l,u));s.setAttribs(r,d)})(t,e,Tr(t))},xC={insert:(t,e)=>{let n,r,o,s,a,i,l,d,c;const u=t.dom,f=t.schema,m=f.getNonEmptyElements(),g=t.selection.getRng(),p=_e(t),b=k=>{let D,B,M,O=r;const P=f.getTextInlineElements();if(D=k||"TABLE"===d||"HR"===d?u.create(k||p):s.cloneNode(!1),M=D,!1===Lx(t))u.setAttrib(D,"style",null),u.setAttrib(D,"class",null);else do{if(P[O.nodeName]){if(En(O)||ze(O))continue;B=O.cloneNode(!1),u.setAttrib(B,"id",""),D.hasChildNodes()?(B.appendChild(D.firstChild),D.appendChild(B)):(M=B,D.appendChild(B))}}while((O=O.parentNode)&&O!==x);return ra(t,D),nm(M),D},h=k=>{let D,B;const M=om(k,r,o);if(G(r)&&(k?M>0:M<r.nodeValue.length))return!1;if(r.parentNode===s&&c&&!k||k&&rt(r)&&r===s.firstChild)return!0;if(rm(r,"TABLE")||rm(r,"HR"))return c&&!k||!c&&k;const O=new zt(r,s);for(G(r)&&(k&&0===M?O.prev():k||M!==r.nodeValue.length||O.next());D=O.current();){if(rt(D)){if(!D.getAttribute("data-mce-bogus")&&(B=D.nodeName.toLowerCase(),m[B]&&"br"!==B))return!1}else if(G(D)&&!Sr(D.nodeValue))return!1;k?O.prev():O.next()}return!0},v=()=>{a=/^(H[1-6]|PRE|FIGURE)$/.test(d)&&"HGROUP"!==S?b(p):b(),((k,D)=>{const B=Mx(k);return!xe(D)&&(st(B)?Ot(z.explode(B),D.nodeName.toLowerCase()):B)})(t,l)&&CC(u,l)&&u.isEmpty(s)?a=u.split(l,s):u.insertAfter(a,s),na(t,a)};oi(u,g).each(k=>{g.setStart(k.startContainer,k.startOffset),g.setEnd(k.endContainer,k.endOffset)}),r=g.startContainer,o=g.startOffset;const y=!(!e||!e.shiftKey),w=!(!e||!e.ctrlKey);rt(r)&&r.hasChildNodes()&&(c=o>r.childNodes.length-1,r=r.childNodes[Math.min(o,r.childNodes.length-1)]||r,o=c&&G(r)?r.nodeValue.length:0);const x=wC(u,r);if(!x)return;y||(r=((k,D,B,M,O)=>{let P,L,F,V,nt,tt;const it=k.dom,bt=wC(it,M);if(L=it.getParent(M,it.isBlock),!L||!CC(it,L)){if(L=L||bt,tt=L===k.getBody()||(St=L)&&/^(TD|TH|CAPTION)$/.test(St.nodeName)?L.nodeName.toLowerCase():L.parentNode.nodeName.toLowerCase(),!L.hasChildNodes())return P=it.create(D),ra(k,P),L.appendChild(P),B.setStart(P,0),B.setEnd(P,0),P;for(V=M;V.parentNode!==L;)V=V.parentNode;for(;V&&!it.isBlock(V);)F=V,V=V.previousSibling;if(F&&k.schema.isValidChild(tt,D.toLowerCase())){for(P=it.create(D),ra(k,P),F.parentNode.insertBefore(P,F),V=F;V&&!it.isBlock(V);)nt=V.nextSibling,P.appendChild(V),V=nt;B.setStart(M,O),B.setEnd(M,O)}}var St;return M})(t,p,g,r,o)),s=u.getParent(r,u.isBlock),l=s?u.getParent(s.parentNode,u.isBlock):null,d=s?s.nodeName.toUpperCase():"";const S=l?l.nodeName.toUpperCase():"";"LI"!==S||w||(s=l,l=l.parentNode,d=S),/^(LI|DT|DD)$/.test(d)&&u.isEmpty(s)?((k,D,B,M,O)=>{const P=k.dom,L=k.selection.getRng();if(B===k.getBody())return;var F;yC(F=B)&&yC(F.parentNode)&&(O="LI");let V=D(O);if(Gi(B,M,!0)&&Gi(B,M,!1))if(vC(B,"LI")){const nt=Ki(B);P.insertAfter(V,nt),(null===(it=(tt=B).parentNode)||void 0===it?void 0:it.firstChild)===tt?P.remove(nt):P.remove(B)}else P.replace(V,B);else if(Gi(B,M,!0))vC(B,"LI")?(P.insertAfter(V,Ki(B)),V.appendChild(P.doc.createTextNode(" ")),V.appendChild(B)):B.parentNode.insertBefore(V,B),P.remove(M);else if(Gi(B,M,!1))P.insertAfter(V,Ki(B)),P.remove(M);else{B=Ki(B);const nt=L.cloneRange();nt.setStartAfter(M),nt.setEndAfter(B);const tt=nt.extractContents();"LI"===O&&((it,bt)=>it.firstChild&&"LI"===it.firstChild.nodeName)(tt)?(V=tt.firstChild,P.insertAfter(tt,B)):(P.insertAfter(tt,B),P.insertAfter(V,B)),P.remove(M)}var tt,it;na(k,V)})(t,b,l,s,p):s!==t.getBody()&&(io(s)?(a=td(s),u.isEmpty(s)&&nm(s),ra(t,a),na(t,a)):h()?v():h(!0)?(a=s.parentNode.insertBefore(b(),s),na(t,rm(s,"HR")?a:s)):(n=(k=>{const D=k.cloneRange();return D.setStart(k.startContainer,om(!0,k.startContainer,k.startOffset)),D.setEnd(k.endContainer,om(!1,k.endContainer,k.endOffset)),D})(g).cloneRange(),n.setEndAfter(s),i=n.extractContents(),H(vg(N(i),Le),D=>{const B=D.dom;B.nodeValue=Yn(B.nodeValue)}),(k=>{do{G(k)&&(k.nodeValue=k.nodeValue.replace(/^[\r\n]+/,"")),k=k.firstChild}while(k)})(i),a=i.firstChild,u.insertAfter(i,s),((k,D,B)=>{let M=B;const O=[];let P;if(M){for(;M=M.firstChild;){if(k.isBlock(M))return;rt(M)&&!D[M.nodeName.toLowerCase()]&&O.push(M)}for(P=O.length;P--;)M=O[P],(!M.hasChildNodes()||M.firstChild===M.lastChild&&""===M.firstChild.nodeValue||UN(k,M))&&k.remove(M)}})(u,m,a),((k,D)=>{D.normalize();const B=D.lastChild;B&&!/^(left|right)$/gi.test(k.getStyle(B,"float",!0))||k.add(D,"br")})(u,s),u.isEmpty(s)&&nm(s),a.normalize(),u.isEmpty(a)?(u.remove(a),v()):(ra(t,a),na(t,a))),u.setAttrib(a,"id",""),t.dispatch("NewBlock",{newBlock:a}))},fakeEventName:"insertParagraph"},kC=(t,e,n)=>{const r=t.dom.createRng();n?(r.setStartBefore(e),r.setEndBefore(e)):(r.setStartAfter(e),r.setEndAfter(e)),t.selection.setRng(r),Ms(t,r)},zN=(t,e)=>{const n=Ut("br");Xe(N(e),n),t.undoManager.add()},jN=(t,e)=>{VN(t.getBody(),e)||Kn(N(e),Ut("br"));const n=Ut("br");Kn(N(e),n),kC(t,n.dom,!1),t.undoManager.add()},VN=(t,e)=>{return n=I.after(e),!!Ft(n.getNode())||Ue(t,I.after(e)).map(r=>Ft(r.getNode())).getOr(!1);var n},SC=t=>t&&"A"===t.nodeName&&"href"in t,HN=t=>t.fold(Dt,SC,SC,Dt),$N=(t,e)=>{e.fold(pt,Y(zN,t),Y(jN,t),pt)},EC={insert:(t,e)=>{const n=(r=>{const o=Y(Fr,r),s=I.fromRangeStart(r.selection.getRng());return An(o,r.getBody(),s).filter(HN)})(t);n.isSome()?n.each(Y($N,t)):((r,o)=>{const a=r.dom,i=r.selection.getRng();let l,d;oi(a,i).each(b=>{i.setStart(b.startContainer,b.startOffset),i.setEnd(b.endContainer,b.endOffset)});let c=i.startOffset,u=i.startContainer;if(1===u.nodeType&&u.hasChildNodes()){const b=c>u.childNodes.length-1;u=u.childNodes[Math.min(c,u.childNodes.length-1)]||u,c=b&&3===u.nodeType?u.nodeValue.length:0}let f=a.getParent(u,a.isBlock);const m=f?a.getParent(f.parentNode,a.isBlock):null;"LI"!==(m?m.nodeName.toUpperCase():"")||!(!o||!o.ctrlKey)||(f=m),u&&3===u.nodeType&&c>=u.nodeValue.length&&(((b,h,v)=>{const y=new zt(h,v);let w;const x=b.getNonEmptyElements();for(;w=y.next();)if(x[w.nodeName.toLowerCase()]||w.length>0)return!0})(r.schema,u,f)||(l=a.create("br"),i.insertNode(l),i.setStartAfter(l),i.setEndAfter(l),d=!0)),l=a.create("br"),vd(a,i,l),kC(r,l,d),r.undoManager.add()})(t,e)},fakeEventName:"insertLineBreak"},_C=(t,e)=>em(t).filter(n=>e.length>0&&hn(N(n),e)).isSome(),Ze=Cn([{br:[]},{block:[]},{none:[]}]),qN=(t,e)=>{return _C(n=t,Px(n));var n},NC=t=>(e,n)=>em(e).filter(o=>ms(N(o))).isSome()===t,RC=(t,e)=>(n,r)=>em(n).fold(q(""),a=>a.nodeName.toUpperCase())===t.toUpperCase()===e,Yi=t=>RC("pre",t),Xi=t=>(e,n)=>Tx(e)===t,WN=(t,e)=>{return _C(n=t,Dx(n));var n},Qi=(t,e)=>e,KN=t=>{const e=_e(t),n=((r,o)=>{const s=r.getRoot();let a,i;for(a=o;a!==s&&"false"!==r.getContentEditable(a);)"true"===r.getContentEditable(a)&&(i=a),a=a.parentNode;return a!==s?i:s})(t.dom,t.selection.getStart());return n&&t.schema.isValidChild(n.nodeName,e)},cn=(t,e)=>(n,r)=>Be(t,(o,s)=>o&&s(n,r),!0)?C.some(e):C.none(),Ji=(t,e,n)=>{e.selection.isCollapsed()||Cc(e),lt(n)&&tm(e,t.fakeEventName).isDefaultPrevented()||(t.insert(e,n),lt(n)&&Zu(e,t.fakeEventName))},AC=(t,e)=>{const n=()=>Ji(EC,t,e),r=()=>Ji(xC,t,e),o=(s=t,a=e,jv([cn([qN],Ze.none()),cn([RC("summary",!0)],Ze.br()),cn([Yi(!0),Xi(!1),Qi],Ze.br()),cn([Yi(!0),Xi(!1)],Ze.block()),cn([Yi(!0),Xi(!0),Qi],Ze.block()),cn([Yi(!0),Xi(!0)],Ze.br()),cn([NC(!0),Qi],Ze.br()),cn([NC(!0)],Ze.block()),cn([WN],Ze.br()),cn([Qi],Ze.br()),cn([KN],Ze.block())],[s,!(!a||!a.shiftKey)]).getOr(Ze.none()));var s,a;switch(Bx(t)){case"linebreak":o.fold(n,n,pt);break;case"block":o.fold(r,r,pt);break;case"invert":o.fold(r,n,pt);break;default:o.fold(n,r,pt)}},GN=pr(),OC=t=>t.stopImmediatePropagation(),TC=t=>t.keyCode===J.PAGE_UP||t.keyCode===J.PAGE_DOWN,BC=(t,e,n)=>{n&&!t.get()?e.on("NodeChange",OC,!0):!n&&t.get()&&e.off("NodeChange",OC),t.set(n)},DC=(t,e)=>{const n=e.container(),r=e.offset();return G(n)?(n.insertData(r,t),C.some(I(n,r+t.length))):Ha(e).map(o=>{const s=as(t);return e.isAtEnd()?Kn(o,s):Xe(o,s),I(s.dom,t.length)})},YN=Y(DC,ae),XN=Y(DC," "),JN=t=>{const e=I.fromRangeStart(t.selection.getRng()),n=N(t.getBody());if(t.selection.isCollapsed()){const r=Y(Fr,t),o=I.fromRangeStart(t.selection.getRng());return An(r,t.getBody(),o).bind((s=n,a=>a.fold(i=>on(s.dom,I.before(i)),i=>be(i),i=>Sn(i),i=>Ue(s.dom,I.after(i))))).map(s=>()=>{return((t,e)=>n=>{return r=t,!bc(o=n)&&(on((s=r).dom,a=o).isNone()||Ue(s.dom,a).isNone()||gc(s,a)||bb(s,a)||hc(s,a)||pc(s,a)||Cb(r,o)||wb(r,o))?YN(e):XN(e);var r,o,s,a})(n,e)(s).each((a=t,i=>(a.selection.setRng(i.toRange()),a.nodeChanged(),!0)));var a})}var s;return C.none()},ZN=t=>Lk(t)?[{keyCode:J.TAB,action:mt(Gy,t,!0)},{keyCode:J.TAB,shiftKey:!0,action:mt(Gy,t,!1)}]:[],tR=t=>{if(t.addShortcut("Meta+P","","mcePrint"),FN(t),jn(t))return Xt(null);{const e=(t=>{const e=Xt(null),n=Y(Fr,t);return t.on("NodeChange",r=>{ks(t)&&(((o,s,a)=>{const i=yt(Ee(N(s.getRoot()),'*[data-mce-selected="inline-boundary"]'),c=>c.dom),l=dt(i,o),d=dt(a,o);H(_l(l,d),Y(ay,!1)),H(_l(d,l),Y(ay,!0))})(n,t.dom,r.parents),((o,s)=>{if(o.selection.isCollapsed()&&!0!==o.composing&&s.get()){const a=I.fromRangeStart(o.selection.getRng());I.isTextPosition(a)&&!1===(Jl(i=a)||Zl(i))&&(Fi(o,((t,e)=>{return I.isTextPosition(e)?(r=e,yp(n=t)&&r.container()===n?((o,s)=>{const a=wp(o.data.substr(0,s.offset())),i=wp(o.data.substr(s.offset()));return(a.text+i.text).length>0?(xp(o),I(o,s.offset()-a.count)):s})(n,r):kp(n,r)):((n,r)=>r.container()===n.parentNode?((o,s)=>{const a=s.container(),i=((l,d)=>{const c=Lm(l,d);return-1===c?C.none():C.some(c)})(ke(a.childNodes),o).map(l=>l<s.offset()?I(a,s.offset()-1):s).getOr(s);return Br(o),i})(n,r):kp(n,r))(t,e);var n,r})(s.get(),a)),s.set(null))}var i})(t,e),((o,s,a,i)=>{if(s.selection.isCollapsed()){const l=dt(i,o);H(l,d=>{const c=I.fromRangeStart(s.selection.getRng());An(o,s.getBody(),c).bind(u=>iy(s,a,u))})}})(n,t,e,r.parents))}),e})(t);return(n=t).on("keyup compositionstart",Y(eN,n)),((n,r)=>{n.on("keydown",o=>{!1===o.isDefaultPrevented()&&((s,a,i)=>{const l=Ct.os.isMacOS()||Ct.os.isiOS();Qs([{keyCode:J.RIGHT,action:mt(Ey,s,!0)},{keyCode:J.LEFT,action:mt(Ey,s,!1)},{keyCode:J.UP,action:mt(_y,s,!1)},{keyCode:J.DOWN,action:mt(_y,s,!0)},...l?[{keyCode:J.UP,action:mt(zi,s,!1),metaKey:!0,shiftKey:!0},{keyCode:J.DOWN,action:mt(zi,s,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:J.RIGHT,action:mt($y,s,!0)},{keyCode:J.LEFT,action:mt($y,s,!1)},{keyCode:J.UP,action:mt(qy,s,!1)},{keyCode:J.DOWN,action:mt(qy,s,!0)},{keyCode:J.RIGHT,action:mt(By,s,!0)},{keyCode:J.LEFT,action:mt(By,s,!1)},{keyCode:J.UP,action:mt(Dy,s,!1)},{keyCode:J.DOWN,action:mt(Dy,s,!0)},{keyCode:J.RIGHT,action:mt(ly,s,a,!0)},{keyCode:J.LEFT,action:mt(ly,s,a,!1)},{keyCode:J.RIGHT,ctrlKey:!l,altKey:l,action:mt(W_,s,a)},{keyCode:J.LEFT,ctrlKey:!l,altKey:l,action:mt(K_,s,a)},{keyCode:J.UP,action:mt(Ry,s,!1)},{keyCode:J.DOWN,action:mt(Ry,s,!0)}],i).each(d=>{i.preventDefault()})})(n,r,o)})})(t,e),((n,r)=>{n.on("keydown",o=>{!1===o.isDefaultPrevented()&&((s,a,i)=>{const l=i.keyCode===J.BACKSPACE?"deleteContentBackward":"deleteContentForward";Ty([{keyCode:J.BACKSPACE,action:mt(vy,s)},{keyCode:J.BACKSPACE,action:mt(xu,s,!1)},{keyCode:J.DELETE,action:mt(xu,s,!0)},{keyCode:J.BACKSPACE,action:mt(yu,s,!1)},{keyCode:J.DELETE,action:mt(yu,s,!0)},{keyCode:J.BACKSPACE,action:mt(Tu,s,a,!1)},{keyCode:J.DELETE,action:mt(Tu,s,a,!0)},{keyCode:J.BACKSPACE,action:mt(Rc,s,!1)},{keyCode:J.DELETE,action:mt(Rc,s,!0)},{keyCode:J.BACKSPACE,action:mt(ku,s,!1)},{keyCode:J.DELETE,action:mt(ku,s,!0)},{keyCode:J.BACKSPACE,action:mt(Pu,s,!1)},{keyCode:J.DELETE,action:mt(Pu,s,!0)},{keyCode:J.BACKSPACE,action:mt(bu,s,!1)},{keyCode:J.DELETE,action:mt(bu,s,!0)},{keyCode:J.BACKSPACE,action:mt(hu,s,!1)},{keyCode:J.DELETE,action:mt(hu,s,!0)},{keyCode:J.BACKSPACE,action:mt(Bu,s,!1)},{keyCode:J.DELETE,action:mt(Bu,s,!0)}],i).each(d=>{i.preventDefault(),tm(s,l).isDefaultPrevented()||(d(),Zu(s,l))})})(n,r,o)}),n.on("keyup",o=>{var s,a;!1===o.isDefaultPrevented()&&(a=o,Qs([{keyCode:J.BACKSPACE,action:mt(Lv,s=n)},{keyCode:J.DELETE,action:mt(Lv,s)}],a))})})(t,e),(n=>{n.on("keydown",r=>{var o,s,a;r.keyCode===J.ENTER&&(o=n,(s=r).isDefaultPrevented()||(s.preventDefault(),(a=o.undoManager).typing&&(a.typing=!1,a.add()),o.undoManager.transact(()=>{AC(o,s)})))})})(t),(n=>{n.on("keydown",r=>{var o,s;!1===r.isDefaultPrevented()&&(s=r,Ty([{keyCode:J.SPACEBAR,action:mt(JN,o=n)}],s).each(a=>{s.preventDefault(),tm(o,"insertText",{data:" "}).isDefaultPrevented()||(a(),Zu(o,"insertText",{data:" "}))}))})})(t),(n=>{n.on("input",r=>{!1===r.isComposing&&(o=>{const s=N(o.getBody());o.selection.isCollapsed()&&((t,e)=>C.some(e).filter(zS).bind(n=>{const r=n.container();return((s,a)=>{const i=a.data,l=I(a,0);return!(!kb(i,0)||xb(s,l)||(a.data=" "+i.slice(1),0))})(t,r)||(s=>{const a=s.data,i=(l=>{const d=l.split("");return yt(d,(c,u)=>Ga(c)&&u>0&&u<d.length-1&&Dd(d[u-1])&&Dd(d[u+1])?" ":c).join("")})(a);return i!==a&&(s.data=i,!0)})(r)||((s,a)=>{const i=a.data,l=I(a,i.length-1);return!(!kb(i,i.length-1)||xb(s,l)||(a.data=i.slice(0,-1)+" ",0))})(t,r)?C.some(n):C.none()}))(s,I.fromRangeStart(o.selection.getRng())).each(a=>{o.selection.setRng(a.toRange())})})(n)})})(t),(n=>{n.on("keydown",r=>{var s;!1===r.isDefaultPrevented()&&(s=r,Qs([...ZN(n)],s).each(a=>{s.preventDefault()}))})})(t),((n,r)=>{n.on("keydown",o=>{!1===o.isDefaultPrevented()&&((s,a,i)=>{const l=Ct.os.isMacOS()||Ct.os.isiOS();Qs([{keyCode:J.END,action:mt(Ny,s,!0)},{keyCode:J.HOME,action:mt(Ny,s,!1)},...l?[]:[{keyCode:J.HOME,action:mt(zi,s,!1),ctrlKey:!0,shiftKey:!0},{keyCode:J.END,action:mt(zi,s,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:J.END,action:mt(Py,s,!0)},{keyCode:J.HOME,action:mt(Py,s,!1)},{keyCode:J.END,action:mt(Ui,s,!0,a)},{keyCode:J.HOME,action:mt(Ui,s,!1,a)}],i).each(d=>{i.preventDefault()})})(n,r,o)})})(t,e),((n,r)=>{if(GN.os.isMacOS())return;const o=Xt(!1);n.on("keydown",s=>{TC(s)&&BC(o,n,!0)}),n.on("keyup",s=>{var a,i,l;!1===s.isDefaultPrevented()&&(l=s,Qs([{keyCode:J.PAGE_UP,action:mt(Ui,a=n,!1,i=r)},{keyCode:J.PAGE_DOWN,action:mt(Ui,a,!0,i)}],l)),TC(s)&&o.get()&&(BC(o,n,!1),n.nodeChanged())})})(t,e),e}var n};class eR{constructor(e){let n;this.lastPath=[],this.editor=e;const r=this;"onselectionchange"in e.getDoc()||e.on("NodeChange click mouseup keyup focus",o=>{const s=e.selection.getRng(),a={startContainer:s.startContainer,startOffset:s.startOffset,endContainer:s.endContainer,endOffset:s.endOffset};"nodechange"!==o.type&&Jd(a,n)||e.dispatch("SelectionChange"),n=a}),e.on("contextmenu",()=>{e.dispatch("SelectionChange")}),e.on("SelectionChange",()=>{const o=e.selection.getStart(!0);o&&ti(e)&&!r.isSameElementPath(o)&&e.dom.isChildOf(o,e.getBody())&&e.nodeChanged({selectionChange:!0})}),e.on("mouseup",o=>{!o.isDefaultPrevented()&&ti(e)&&("IMG"===e.selection.getNode().nodeName?je.setEditorTimeout(e,()=>{e.nodeChanged()}):e.nodeChanged())})}nodeChanged(e){const n=this.editor.selection;let r,o,s;this.editor.initialized&&n&&!ck(this.editor)&&!this.editor.mode.isReadOnly()&&(s=this.editor.getBody(),r=n.getStart(!0)||s,r.ownerDocument===this.editor.getDoc()&&this.editor.dom.isChildOf(r,s)||(r=s),o=[],this.editor.dom.getParent(r,a=>{if(a===s)return!0;o.push(a)}),(e=e||{}).element=r,e.parents=o,this.editor.dispatch("NodeChange",e))}isSameElementPath(e){let n;const r=this.editor,o=Go(r.dom.getParents(e,Vt,r.getBody()));if(o.length===this.lastPath.length){for(n=o.length;n>=0&&o[n]===this.lastPath[n];n--);if(-1===n)return this.lastPath=o,!0}return this.lastPath=o,!1}}const Zi=q("x-tinymce/html"),sm="\x3c!-- x-tinymce/html --\x3e",nR=t=>sm+t,PC=t=>-1!==t.indexOf(sm),LC="%MCEPASTEBIN%",am=t=>t.dom.get("mcepastebin"),rR=t=>t&&"mcepastebin"===t.id,MC=t=>t===LC,IC=(t,e)=>(z.each(e,n=>{t=ma(n,RegExp)?t.replace(n,""):t.replace(n[0],n[1])}),t),FC=t=>IC(t,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(e,n,r)=>n||r?ae:" "],/<br class="Apple-interchange-newline">/g,/<br>$/i]),UC=(t,e)=>({content:t,cancelled:e}),im=(t,e)=>(t.insertContent(e,{merge:Rk(t),paste:!0}),!0),lm=t=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(t),oR=(t,e,n)=>{return!(t.selection.isCollapsed()||!lm(e)||(r=t,o=e,s=n,r.undoManager.extra(()=>{s(r,o)},()=>{r.execCommand("mceInsertLink",!1,o)}),0));var r,o,s},sR=(t,e,n)=>{return r=t,!(!lm(o=e)||!It(vp(r),s=>Wm(o.toLowerCase(),`.${s.toLowerCase()}`)))&&((r,o,s)=>(r.undoManager.extra(()=>{s(r,o)},()=>{r.insertContent('<img src="'+o+'">')}),!0))(t,e,n);var r,o},aR=(t=>{let e=0;return()=>"mceclip"+e++})(),zC=(t,e,n,r)=>{const o=((l,d,c)=>{const u=l.dispatch("PastePreProcess",{content:d,internal:c}),f=((m,g)=>{const p=Ro({},m.schema);p.addNodeFilter("meta",h=>{z.each(h,v=>{v.remove()})});const b=p.parse(g,{forced_root_block:!1,isRootContent:!0});return rr({validate:!0},m.schema).serialize(b)})(l,u.content);return l.hasEventListeners("PastePostProcess")&&!u.isDefaultPrevented()?((m,g,p)=>{const b=m.dom.create("div",{style:"display:none"},g),h=m.dispatch("PastePostProcess",{node:b,internal:p});return UC(h.node.innerHTML,h.isDefaultPrevented())})(l,f,c):UC(f,u.isDefaultPrevented())})(t,e,n);var s,a,l,d;!1===o.cancelled&&(s=t,a=o.content,r||!Ak(s)?im(s,a):(l=s,d=a,z.each([oR,sR,im],c=>!0!==c(l,d,im))))},tl=(t,e,n)=>{const r=n||PC(e);zC(t,e.replace(sm,""),r,!1)},dm=(t,e)=>{const n=t.dom.encode(e).replace(/\r\n/g,"\n"),r=((o,s,a)=>{const i=o.split(/\n\n/),l=((u,f)=>{let m="<"+u;const g=Ol(f,(p,b)=>b+'="'+Xn.encodeAllRaw(p)+'"');return g.length&&(m+=" "+g.join(" ")),m+">"})(s,a),d="</"+s+">",c=yt(i,u=>u.split(/\n/).join("<br />"));return 1===c.length?c[0]:yt(c,u=>l+u+d).join("")})(ag(n,Tk(t)),_e(t),Tr(t));zC(t,r,!1,!0)},jC=t=>{const e={};if(t&&t.types)for(let n=0;n<t.types.length;n++){const r=t.types[n];try{e[r]=t.getData(r)}catch(o){e[r]=""}}return e},Lo=(t,e)=>e in t&&t[e].length>0,VC=t=>Lo(t,"text/html")||Lo(t,"text/plain"),HC=(t,e,n)=>{const r="paste"===e.type?e.clipboardData:e.dataTransfer;var o;if(ja(t)&&r){const s=((a,i)=>{const l=i.items?Dn(ke(i.items),c=>"file"===c.kind?[c.getAsFile()]:[]):[],d=i.files?ke(i.files):[];return dt(l.length>0?l:d,(c=>{const u=vp(c);return f=>ne(f.type,"image/")&&It(u,m=>(g=>{const p=g.toLowerCase(),b={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return z.hasOwn(b,p)?"image/"+b[p]:"image/"+p})(m)===f.type)})(a))})(t,r);if(s.length>0)return e.preventDefault(),(o=s,Promise.all(yt(o,a=>D0(a).then(i=>({file:a,uri:i}))))).then(a=>{n&&t.selection.setRng(n),H(a,i=>{var l,d;l=t,ou((d=i).uri).each(({data:c,type:u,base64Encoded:f})=>{const m=f?c:btoa(c),g=d.file,p=l.editorUpload.blobCache,b=p.getByData(m,u),h=null!=b?b:((v,y,w,x)=>{const S=aR(),k=ip(v)&&lt(w.name),D=k?((O,P)=>{const L=P.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return lt(L)?O.dom.encode(L[1]):null})(v,w.name):S,M=y.create(S,w,x,D,k?w.name:void 0);return y.add(M),M})(l,p,g,m);tl(l,`<img src="${h.blobUri()}">`,!1)})})}),!0}return!1},$C=(t,e,n,r)=>{let o=FC(n);const s=Lo(e,Zi())||PC(n),a=!s&&!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(o),i=lm(o);(MC(o)||!o.length||a&&!i)&&(r=!0),(r||i)&&(o=Lo(e,"text/plain")&&a?e["text/plain"]:(l=>{const d=Jn(),c=Ro({},d);let u="";const f=d.getVoidElements(),m=z.makeMap("script noscript style textarea video audio iframe object"," "),g=d.getBlockElements(),p=b=>{const h=b.name,v=b;if("br"!==h){if("wbr"!==h)if(f[h]&&(u+=" "),m[h])u+=" ";else{if(3===b.type&&(u+=b.value),!(b.name in d.getVoidElements())&&(b=b.firstChild))do{p(b)}while(b=b.next);g[h]&&v.next&&(u+="\n","p"===h&&(u+="\n"))}}else u+="\n"};return l=IC(l,[/<!\[[^\]]+\]>/g]),p(c.parse(l)),u})(o)),MC(o)||(r?dm(t,o):tl(t,o,s))},qC=(t,e,n,r)=>{((o,s,a)=>{try{return o.clearData(),o.setData("text/html",s),o.setData("text/plain",a),o.setData(Zi(),s),!0}catch(i){return!1}})(t.clipboardData,e.html,e.text)?(t.preventDefault(),r()):n(e.html,r)},WC=t=>(e,n)=>{const{dom:r,selection:o}=t,s=r.create("div",{contenteditable:"false","data-mce-bogus":"all"}),a=r.create("div",{contenteditable:"true"},e);r.setStyles(s,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),s.appendChild(a),r.add(t.getBody(),s);const i=o.getRng();a.focus();const l=r.createRng();l.selectNodeContents(a),o.setRng(l),je.setEditorTimeout(t,()=>{o.setRng(i),r.remove(s),n()},0)},KC=t=>({html:nR(t.selection.getContent({contextual:!0})),text:t.selection.getContent({format:"text"})}),GC=t=>{return!t.selection.isCollapsed()||!!(e=t).dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody());var e},YC=(t,e)=>{var n,r;return Eo.getCaretRangeFromPoint(null!==(n=e.clientX)&&void 0!==n?n:0,null!==(r=e.clientY)&&void 0!==r?r:0,t.getDoc())},XC=(t,e)=>{t.focus(),e&&t.selection.setRng(e)},lR=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,QC=t=>z.trim(t).replace(lR,Ya).toLowerCase(),dR=(t,e,n)=>{const r=_k(t);if(n||"all"===r||!Nk(t))return e;const o=r?r.split(/[, ]/):[];if(o&&"none"!==r){const s=t.dom,a=t.selection.getNode();e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(i,l,d,c)=>{const u=s.parseStyle(s.decode(d)),f={};for(let g=0;g<o.length;g++){const p=u[o[g]];let b=p,h=s.getStyle(a,o[g],!0);/color/.test(o[g])&&(b=QC(b),h=QC(h)),h!==b&&(f[o[g]]=p)}const m=s.serializeStyle(f,"span");return m?l+' style="'+m+'"'+c:l+c})}else e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return e.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(s,a,i,l)=>a+' style="'+i+'"'+l)},uR=Ft,JC=G,mR=t=>Bt(t.dom),ZC=t=>e=>kt(N(t),e),t1=(t,e)=>oo(N(t),mR,ZC(e)),e1=(t,e,n)=>{const r=new zt(t,e),o=n?r.next.bind(r):r.prev.bind(r);let s=t;for(let a=n?t:o();a&&!uR(a);a=o())Je(a)&&(s=a);return s};var oa;!function(t){t.Before="before",t.After="after"}(oa||(oa={}));const gR=(t,e)=>Math.abs(t.left-e),pR=(t,e)=>Math.abs(t.right-e),bR=(t,e,n)=>e>t.left&&e<t.right?0:Math.min(Math.abs(t.left-e),Math.abs(t.right-e)),cm=(t,e,n)=>{const r=d=>Je(d.node)?C.some(d):rt(d.node)?cm(ke(d.node.childNodes),e,n):C.none(),o=(d,c)=>{const u=Yo(d,(f,m)=>c(f,e,n)-c(m,e,n));return((f,m)=>{if(f.length>=2){const g=r(f[0]).getOr(f[0]),p=r(f[1]).getOr(f[1]);if(Math.abs(m(g,e,n)-m(p,e,n))<2){if(G(g.node))return C.some(g);if(G(p.node))return C.some(p)}}return C.none()})(u,c).orThunk(()=>Yr(u,r))},[s,a]=((t,e)=>{return(n=dt(t,n=>{return(r=e)>=(o=n).top&&r<=o.bottom;var r,o}),Be(n,(r,o)=>r.fold(()=>C.some(o),s=>{const a=Math.min(o.left,s.left),i=Math.min(o.top,s.top),l=Math.max(o.right,s.right),d=Math.max(o.bottom,s.bottom);return C.some({top:i,right:l,bottom:d,left:a,width:l-a,height:d-i})}),C.none())).fold(()=>[[],t],n=>{const{pass:r,fail:o}=Wo(t,s=>((a,i)=>{const l=(d=a,c=i,Math.max(0,Math.min(d.bottom,c.bottom)-Math.max(d.top,c.top))/Math.min(a.height,i.height));var d,c;return((d,c)=>d.top<c.bottom&&d.bottom>c.top)(a,i)&&l>.5})(s,n));return[r,o]});var n})(ty(t),n),{pass:i,fail:l}=Wo(a,d=>d.top<n);return o(s,bR).orThunk(()=>o(l,Tg)).orThunk(()=>o(i,Tg))},n1=t=>{const e=t.getBoundingClientRect(),n=t.ownerDocument,r=n.documentElement,o=n.defaultView;return{top:e.top+o.pageYOffset-r.clientTop,left:e.left+o.pageXOffset-r.clientLeft}},um=Bt,yR=vn,CR=(t,e,n,r)=>{const o=t.dom,s=e.cloneNode(!0);o.setStyles(s,{width:n,height:r}),o.setAttrib(s,"data-mce-selected",null);const a=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:r}),o.setStyles(s,{margin:0,boxSizing:"border-box"}),a.appendChild(s),a},r1=t=>{t&&t.parentNode&&t.parentNode.removeChild(t)},o1=t=>{t.on(e=>{r1(e.ghost)}),t.clear()},Mo=Bt,mm=(t,e)=>js(t.getBody(),e),xR=t=>{const e=t.selection,n=t.dom,r=n.isBlock,o=t.getBody(),s=((t,e,n,r)=>{const o=Zn();let s,a;const i=_e(t),l=t.dom,d=()=>{(c=>{const u=Ee(N(c),"*[contentEditable=false],video,audio,embed,object");for(let f=0;f<u.length;f++){const m=u[f].dom;let g=m.previousSibling;if(Oa(g)){const p=g.data;1===p.length?g.parentNode.removeChild(g):g.deleteData(p.length-1,1)}g=m.nextSibling,Aa(g)&&(1===g.data.length?g.parentNode.removeChild(g):g.deleteData(0,1))}})(e),a&&(Br(a),a=null),o.on(c=>{l.remove(c.caret),o.clear()}),s&&(clearInterval(s),s=void 0)};return{show:(c,u)=>{let f;if(d(),zk(u))return null;if(!n(u))return a=((m,g)=>{const p=m.ownerDocument.createTextNode(ie),b=m.parentNode;if(g){const h=m.previousSibling;if(ao(h)){if(Ie(h))return h;if(Oa(h))return h.splitText(h.data.length-1)}b.insertBefore(p,m)}else{const h=m.nextSibling;if(ao(h)){if(Ie(h))return h;if(Aa(h))return h.splitText(1),h}m.nextSibling?b.insertBefore(p,m.nextSibling):b.appendChild(p)}return p})(u,c),f=u.ownerDocument.createRange(),Ss(a.nextSibling)?(f.setStart(a,0),f.setEnd(a,0)):(f.setStart(a,1),f.setEnd(a,1)),f;{a=((p,b,h)=>{const v=b.ownerDocument.createElement(p);v.setAttribute("data-mce-caret",h?"before":"after"),v.setAttribute("data-mce-bogus","all"),v.appendChild((()=>{const w=document.createElement("br");return w.setAttribute("data-mce-bogus","1"),w})());const y=b.parentNode;return h?y.insertBefore(v,b):b.nextSibling?y.insertBefore(v,b.nextSibling):y.appendChild(v),v})(i,u,c);const m=Sp(e,u,c);l.setStyle(a,"top",m.top);const g=l.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});l.setStyles(g,at({},m)),l.add(e,g),o.set({caret:g,element:u,before:c}),c&&l.addClass(g,"mce-visual-caret-before"),s=setInterval(()=>{o.on(p=>{r()?l.toggleClass(p.caret,"mce-visual-caret-hidden"):l.addClass(p.caret,"mce-visual-caret-hidden")})},500),f=u.ownerDocument.createRange(),f.setStart(a,0),f.setEnd(a,0)}return f},hide:d,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{o.on(c=>{const u=Sp(e,c.element,c.before);l.setStyles(c.caret,at({},u))})},destroy:()=>clearInterval(s)}})(t,o,r,()=>Lr(t)),a="sel-"+n.uniqueId(),i="data-mce-selected";let l;const d=h=>h!==o&&(Mo(h)||yn(h))&&n.isChildOf(h,o),c=(h,v,y,w=!0)=>t.dispatch("ShowCaret",{target:v,direction:h,before:y}).isDefaultPrevented()?null:(w&&e.scrollIntoView(v,-1===h),s.show(y,v)),u=h=>Ie(h)||Aa(h)||Oa(h),f=h=>u(h.startContainer)||u(h.endContainer),g=(h,v)=>{if(!h)return null;if(h.collapsed){if(!f(h)){const S=v?1:-1,k=As(S,o,h),D=k.getNode(!v);if(Es(D))return c(S,D,!!v&&!k.isAtEnd(),!1);const B=k.getNode(v);if(Es(B))return c(S,B,!v&&!k.isAtEnd(),!1)}return null}let y=h.startContainer,w=h.startOffset;const x=h.endOffset;if(3===y.nodeType&&0===w&&Mo(y.parentNode)&&(y=y.parentNode,w=n.nodeIndex(y),y=y.parentNode),1!==y.nodeType)return null;if(x===w+1&&y===h.endContainer){const S=y.childNodes[w];if(d(S))return(k=>{const D=k.cloneNode(!0),B=t.dispatch("ObjectSelected",{target:k,targetClone:D});if(B.isDefaultPrevented())return null;const M=((P,L)=>{const F=N(t.getBody()),V=t.getDoc(),nt=us(F,"#"+a).getOrThunk(()=>{const bt=ss('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',V);return re(bt,"id",a),Ht(F,bt),bt}),tt=n.createRng();ls(nt),yr(nt,[as(ae,V),N(L),as(ae,V)]),tt.setStart(nt.dom.firstChild,1),tt.setEnd(nt.dom.lastChild,0),ya(nt,{top:n.getPos(P,t.getBody()).y+"px"}),zh(nt);const it=e.getSel();return it.removeAllRanges(),it.addRange(tt),tt})(k,B.targetClone),O=N(k);return H(Ee(N(t.getBody()),"*[data-mce-selected]"),P=>{kt(O,P)||oe(P,i)}),n.getAttrib(k,i)||k.setAttribute(i,"1"),l=k,b(),M})(S)}return null},p=()=>{l&&l.removeAttribute(i),us(N(t.getBody()),"#"+a).each(Mt),l=null},b=()=>{s.hide()};return jn(t)||(t.on("click",h=>{const v=mm(t,h.target);v&&Mo(v)&&(h.preventDefault(),t.focus())}),t.on("blur NewBlock",p),t.on("ResizeWindow FullscreenStateChanged",s.reposition),t.on("tap",h=>{const v=h.target,y=mm(t,v);Mo(y)?(h.preventDefault(),Ks(t,y).each(g)):d(v)&&Ks(t,v).each(g)},!0),t.on("mousedown",h=>{const v=h.target;if(v!==o&&"HTML"!==v.nodeName&&!n.isChildOf(v,o)||!1===((w,x,S)=>{const k=N(w.getBody()),D=w.inline?k:N(Wn(k).dom.documentElement),B=((M,O,P,L)=>{const F=O.dom.getBoundingClientRect();return{x:P-(M?F.left+O.dom.clientLeft+s_(O):0),y:L-(M?F.top+O.dom.clientTop+o_(O):0)}})(w.inline,D,x,S);return((M,O,P)=>{const L=n_(M),F=r_(M);return O>=0&&P>=0&&O<=L&&P<=F})(D,B.x,B.y)})(t,h.clientX,h.clientY))return;p(),b();const y=mm(t,v);Mo(y)?(h.preventDefault(),Ks(t,y).each(g)):((t,e,n)=>((r,o,s)=>{const a=N(r),l=((t,e,n)=>C.from(t.dom.elementFromPoint(e,n)).map(os))(Wn(a),o,s).filter(d=>Mn(a,d)).getOr(a);return((d,c,u,f)=>{const m=(g,p)=>p.fold(()=>cm(ke(g.dom.childNodes),u,f),b=>{const h=dt(ke(g.dom.childNodes),v=>v!==b.dom);return cm(h,u,f)}).orThunk(()=>{var b;return(kt(g,d)?C.none():(b=g,C.from(b.dom.parentElement).map(N))).bind(h=>m(h,C.some(g)))});return m(c,C.none())})(a,l,o,s)})(t,e,n).filter(r=>Es(r.node)).map(r=>{return{node:(o=r).node,position:gR(o,s=e)<pR(o,s)?oa.Before:oa.After};var o,s}))(o,h.clientX,h.clientY).each(w=>{var x;h.preventDefault(),(x=c(1,w.node,w.position===oa.Before,!1))&&e.setRng(x),rt(y)?y.focus():t.getBody().focus()})}),t.on("keypress",h=>{J.modifierPressed(h)||Mo(e.getNode())&&h.preventDefault()}),t.on("GetSelectionRange",h=>{let v=h.range;if(l){if(!l.parentNode)return void(l=null);v=v.cloneRange(),v.selectNode(l),h.range=v}}),t.on("SetSelectionRange",h=>{h.range=(h=>{const v=t.schema.getVoidElements(),y=n.createRng(),w=h.startContainer,x=h.startOffset,S=h.endContainer,k=h.endOffset;return gt(v,w.nodeName.toLowerCase())?0===x?y.setStartBefore(w):y.setStartAfter(w):y.setStart(w,x),gt(v,S.nodeName.toLowerCase())?0===k?y.setEndBefore(S):y.setEndAfter(S):y.setEnd(S,k),y})(h.range);const v=g(h.range,h.forward);v&&(h.range=v)}),t.on("AfterSetSelectionRange",h=>{const v=h.range,y=v.startContainer.parentNode;f(v)||"mcepastebin"===y.id||b(),n.hasClass(y,"mce-offscreen-selection")||p()}),(t=>{const e=Zn(),n=Et.DOM,r=document,o=(l=e,d=t,c=>{if(0===c.button){const m=Gt(d.dom.getParents(c.target),((...g)=>p=>{for(let b=0;b<g.length;b++)if(g[b](p))return!0;return!1})(um,yR)).getOr(null);if(u=d.getBody(),um(f=m)&&f!==u){const g=d.dom.getPos(m),p=d.getBody(),b=d.getDoc().documentElement;l.set({element:m,dragging:!1,screenX:c.screenX,screenY:c.screenY,maxX:(d.inline?p.scrollWidth:b.offsetWidth)-2,maxY:(d.inline?p.scrollHeight:b.offsetHeight)-2,relX:c.pageX-g.x,relY:c.pageY-g.y,width:m.offsetWidth,height:m.offsetHeight,ghost:CR(d,m,m.offsetWidth,m.offsetHeight)})}}var u,f}),s=((l,d)=>{const c=La((u,f)=>{d._selectionOverrides.hideFakeCaret(),d.selection.placeCaretAt(u,f)},0);return d.on("remove",c.cancel),u=>l.on(f=>{const m=Math.max(Math.abs(u.screenX-f.screenX),Math.abs(u.screenY-f.screenY));if(!f.dragging&&m>10){if(d.dispatch("dragstart",{target:f.element}).isDefaultPrevented())return;f.dragging=!0,d.focus()}if(f.dragging){const b=((h,v)=>({pageX:v.pageX-h.relX,pageY:v.pageY+5}))(f,(v=u,y=(S=h=d).inline?n1(S.getBody()):{left:0,top:0},w=(S=>{const k=S.getBody();return S.inline?{left:k.scrollLeft,top:k.scrollTop}:{left:0,top:0}})(h),x=((S,k)=>{if(k.target.ownerDocument!==S.getDoc()){const D=n1(S.getContentAreaContainer()),B=(M=>{const O=M.getBody(),P=M.getDoc().documentElement;return M.inline?{left:O.scrollLeft,top:O.scrollTop}:{left:O.scrollLeft||P.scrollLeft,top:O.scrollTop||P.scrollTop}})(S);return{left:k.pageX-D.left+B.left,top:k.pageY-D.top+B.top}}return{left:k.pageX,top:k.pageY}})(h,v),{pageX:x.left-y.left+w.left,pageY:x.top-y.top+w.top}));g=f.ghost,p=d.getBody(),g.parentNode!==p&&p.appendChild(g),((h,v,y,w,x,S)=>{let k=0,D=0;h.style.left=v.pageX+"px",h.style.top=v.pageY+"px",v.pageX+y>x&&(k=v.pageX+y-x),v.pageY+w>S&&(D=v.pageY+w-S),h.style.width=y-k+"px",h.style.height=w-D+"px"})(f.ghost,b,f.width,f.height,f.maxX,f.maxY),c.throttle(u.clientX,u.clientY)}var h,v,S,y,w,x,g,p})})(e,t),a=((l,d)=>c=>{l.on(u=>{if(u.dragging){if(f=d,m=(f=>{const m=f.getSel().getRangeAt(0).startContainer;return 3===m.nodeType?m.parentNode:m})(d.selection),m!==(g=u.element)&&!f.dom.isChildOf(m,g)&&!um(m)){const f=(m=>{const g=m.cloneNode(!0);return g.removeAttribute("data-mce-selected"),g})(u.element);d.dispatch("drop",{clientX:c.clientX,clientY:c.clientY}).isDefaultPrevented()||d.undoManager.transact(()=>{r1(u.element),d.insertContent(d.dom.getOuterHTML(f)),d._selectionOverrides.hideFakeCaret()})}d.dispatch("dragend")}var f,m,g}),o1(l)})(e,t),i=((l,d)=>()=>{l.on(c=>{c.dragging&&d.dispatch("dragend")}),o1(l)})(e,t);var l,d;t.on("mousedown",o),t.on("mousemove",s),t.on("mouseup",a),n.bind(r,"mousemove",s),n.bind(r,"mouseup",i),t.on("remove",()=>{n.unbind(r,"mousemove",s),n.unbind(r,"mouseup",i)}),t.on("keydown",l=>{l.keyCode===J.ESC&&i()})})(h=t),fk(h)&&(v=>{const y=S=>{if(!S.isDefaultPrevented()){const k=S.dataTransfer;k&&(Ot(k.types,"Files")||k.files.length>0)&&(S.preventDefault(),"drop"===S.type&&Ti(v,"Dropped file type is not supported"))}},w=S=>{ii(v,S.target)&&y(S)},x=()=>{const S=Et.DOM,k=v.dom,D=document,B=v.inline?v.getBody():v.getDoc(),M=["drop","dragover"];H(M,O=>{S.bind(D,O,w),k.bind(B,O,y)}),v.on("remove",()=>{H(M,O=>{S.unbind(D,O,w),k.unbind(B,O,y)})})};v.on("init",()=>{je.setEditorTimeout(v,x,0)})})(h),(h=>{const v=La(()=>{if(!h.removed&&h.getBody().contains(document.activeElement)){const y=h.selection.getRng();if(y.collapsed){const w=vu(h,y,!1);h.selection.setRng(w)}}},0);h.on("focus",()=>{v.throttle()}),h.on("blur",()=>{v.cancel()})})(t),(h=>{h.on("init",()=>{h.on("focusin",v=>{const y=v.target;if(yn(y)){const w=js(h.getBody(),y),x=Bt(w)?w:y;h.selection.getNode()!==x&&Ks(h,x).each(S=>h.selection.setRng(S))}})})})(t)),{showCaret:c,showBlockCaretContainer:h=>{h.hasAttribute("data-mce-caret")&&(td(h),e.scrollIntoView(h))},hideFakeCaret:b,destroy:()=>{s.destroy(),l=null}};var h},s1=(t,e,n)=>{if(G(e)&&(n<0||n>e.data.length))return[];const r=[n];let o=e;for(;o!==t&&o.parentNode;){const s=o.parentNode;for(let a=0;a<s.childNodes.length;a++)if(s.childNodes[a]===o){r.push(a);break}o=s}return o===t?r.reverse():[]},fm=(t,e,n,r,o)=>({start:s1(t,e,n),end:s1(t,r,o)}),a1=(t,e)=>{const n=e.slice(),r=n.pop();return Be(n,(o,s)=>o.bind(a=>C.from(a.childNodes[s])),C.some(t)).bind(o=>G(o)&&(r<0||r>o.data.length)?C.none():C.some({node:o,offset:r}))},i1=(t,e)=>a1(t,e.start).bind(({node:n,offset:r})=>a1(t,e.end).map(({node:o,offset:s})=>{const a=document.createRange();return a.setStart(n,r),a.setEnd(o,s),a})),Io=(t,e,n)=>{if(e&&t.isEmpty(e)&&!n(e)){const r=e.parentNode;t.remove(e),Io(t,r,n)}},el=(t,e,n,r=!0)=>{const o=e.startContainer.parentNode,s=e.endContainer.parentNode;e.deleteContents(),r&&!n(e.startContainer)&&(G(e.startContainer)&&0===e.startContainer.data.length&&t.remove(e.startContainer),G(e.endContainer)&&0===e.endContainer.data.length&&t.remove(e.endContainer),Io(t,o,n),o!==s&&Io(t,s,n))},gm=(t,e)=>C.from(t.dom.getParent(e.startContainer,t.dom.isBlock)),l1=(t,e,n)=>{((r,o,s)=>{if(G(r)&&0>=r.length)return C.some(dn(r,0));{const a=Rr(ji);return C.from(a.forwards(r,0,Vi(r),s)).map(i=>dn(i.container,0))}})(e,0,e).each(r=>{const o=r.container;Yy(o,n.start.length,e).each(s=>{const a=t.createRng();a.setStart(o,0),a.setEnd(s.container,s.offset),el(t,a,i=>i===e)})})},d1=(t,e)=>t.create("span",{"data-mce-type":"bookmark",id:e}),nl=(t,e)=>{const n=t.createRng();return n.setStartAfter(e.start),n.setEndBefore(e.end),n},c1=(t,e,n)=>{const r=i1(t.getRoot(),n).getOrDie("Unable to resolve path range"),o=r.startContainer,s=r.endContainer,a=0===r.endOffset?s:s.splitText(r.endOffset),i=0===r.startOffset?o:o.splitText(r.startOffset);return{prefix:e,end:a.parentNode.insertBefore(d1(t,e+"-end"),a),start:i.parentNode.insertBefore(d1(t,e+"-start"),i)}},u1=(t,e,n)=>{Io(t,t.get(e.prefix+"-end"),n),Io(t,t.get(e.prefix+"-start"),n)},pm=t=>0===t.start.length,m1=(t,e,n,r)=>{const o=e.start;var s;return zu(t,r.container,r.offset,(s=o,(a,i)=>{const l=a.data.substring(0,i),d=l.lastIndexOf(s.charAt(s.length-1)),c=l.lastIndexOf(s);return-1!==c?c+s.length:-1!==d?d+1:-1}),n).bind(a=>{if(a.offset>=o.length){const i=t.createRng();return i.setStart(a.container,a.offset-o.length),i.setEnd(a.container,a.offset),C.some(i)}return Uu(a.container,a.offset-o.length,n).map(l=>{const d=t.createRng();return d.setStart(l.container,l.offset),d.setEnd(a.container,a.offset),d}).filter(l=>l.toString()===o).orThunk(()=>m1(t,e,n,dn(a.container,0)))})},kR=(t,e,n)=>{const r=t.dom,o=r.getRoot(),s=n.pattern,a=n.position.container,i=n.position.offset;return Uu(a,i-n.pattern.end.length,e).bind(l=>{const d=fm(o,l.container,l.offset,a,i);if(pm(s))return C.some({matches:[{pattern:s,startRng:d,endRng:d}],position:l});{const c=f1(t,n.remainingPatterns,l.container,l.offset,e),u=c.getOr({matches:[],position:l}),f=u.position;return((g,p,b,h,v,y=!1)=>{if(0===p.start.length&&!y){const w=g.createRng();return w.setStart(b,h),w.setEnd(b,h),C.some(w)}return Fu(b,h,v).bind(w=>m1(g,p,v,w).bind(x=>y&&(x.endContainer===w.container&&x.endOffset===w.offset||0===w.offset&&x.endContainer.textContent.length===x.endOffset)?C.none():C.some(x)))})(r,s,f.container,f.offset,e,c.isNone()).map(g=>{const p=fm(o,(h=g).startContainer,h.startOffset,h.endContainer,h.endOffset);var h;return{matches:u.matches.concat([{pattern:s,startRng:p,endRng:d}]),position:dn(g.startContainer,g.startOffset)}})}})},f1=(t,e,n,r,o)=>{const s=t.dom;return Fu(n,r,s.getRoot()).bind(a=>{const i=s.createRng();i.setStart(o,0),i.setEnd(n,r);const l=i.toString();for(let d=0;d<e.length;d++){const c=e[d];if(!Wm(l,c.end))continue;const u=e.slice();u.splice(d,1);const f=kR(t,o,{pattern:c,remainingPatterns:u,position:a});if(f.isSome())return f}return C.none()})},g1=(t,e,n)=>{t.selection.setRng(n),"inline-format"===e.type?H(e.format,r=>{t.formatter.apply(r)}):t.execCommand(e.cmd,!1,e.value)},p1=(t,e,n)=>{const r=t.selection.getRng();return!1===r.collapsed?[]:gm(t,r).bind(o=>{const s=Math.max(0,r.startOffset-(n?1:0));return f1(t,e,r.startContainer,s,o)}).fold(()=>[],o=>o.matches)},h1=(t,e)=>{if(0===e.length)return;const n=t.dom,r=t.selection.getBookmark(),o=((s,a)=>{const i=Eg("mce_textpattern"),l=fa(a,(d,c)=>{const u=c1(s,i+`_end${d.length}`,c.endRng);return d.concat([Rt(at({},c),{endMarker:u})])},[]);return fa(l,(d,c)=>{const u=l.length-d.length-1,f=pm(c.pattern)?c.endMarker:c1(s,i+`_start${u}`,c.startRng);return d.concat([Rt(at({},c),{startMarker:f})])},[])})(n,e);H(o,s=>{const a=n.getParent(s.startMarker.start,n.isBlock),i=l=>l===a;pm(s.pattern)?((l,d,c,u)=>{const f=nl(l.dom,c);el(l.dom,f,u),g1(l,d,f)})(t,s.pattern,s.endMarker,i):((l,d,c,u,f)=>{const m=l.dom,g=nl(m,u),p=nl(m,c);el(m,p,f),el(m,g,f);const h=nl(m,{prefix:c.prefix,start:c.end,end:u.start});g1(l,d,h)})(t,s.pattern,s.startMarker,s.endMarker,i),u1(n,s.endMarker,i),u1(n,s.startMarker,i)}),t.selection.moveToBookmark(r)},b1=(t,e)=>{if(e.length>0){const n=p1(t,e,!0);n.length>0&&t.undoManager.transact(()=>{h1(t,n)})}},v1=(t,e,n)=>{for(let r=0;r<t.length;r++)if(n(t[r],e))return!0;return!1},hm=Et.DOM,NR=t=>t.inline?t.getElement().nodeName.toLowerCase():void 0,bm=t=>Qo(t,e=>!1===we(e)),y1=t=>{const e=t.options.get,n=t.editorUpload.blobCache;return bm({allow_conditional_comments:e("allow_conditional_comments"),allow_html_data_urls:e("allow_html_data_urls"),allow_svg_data_urls:e("allow_svg_data_urls"),allow_html_in_named_anchor:e("allow_html_in_named_anchor"),allow_script_urls:e("allow_script_urls"),allow_unsafe_link_target:e("allow_unsafe_link_target"),convert_fonts_to_spans:e("convert_fonts_to_spans"),fix_list_elements:e("fix_list_elements"),font_size_legacy_values:e("font_size_legacy_values"),forced_root_block:e("forced_root_block"),forced_root_block_attrs:e("forced_root_block_attrs"),preserve_cdata:e("preserve_cdata"),remove_trailing_brs:e("remove_trailing_brs"),inline_styles:e("inline_styles"),root_name:NR(t),validate:!0,blob_cache:n,document:t.getDoc()})},C1=t=>{const e=t.options.get;return bm({custom_elements:e("custom_elements"),extended_valid_elements:e("extended_valid_elements"),invalid_elements:e("invalid_elements"),invalid_styles:e("invalid_styles"),schema:e("schema"),valid_children:e("valid_children"),valid_classes:e("valid_classes"),valid_elements:e("valid_elements"),valid_styles:e("valid_styles"),verify_html:e("verify_html"),padd_empty_block_inline_children:e("format_empty_lines")})},w1=t=>t.inline?t.ui.styleSheetLoader:t.dom.styleSheetLoader,x1=t=>{const e=w1(t),n=up(t),r=t.contentCSS,o=()=>{e.unloadAll(r),t.inline||t.ui.styleSheetLoader.unloadAll(n)},s=()=>{t.removed?o():t.on("remove",o)};if(t.contentStyles.length>0){let l="";z.each(t.contentStyles,d=>{l+=d+"\r\n"}),t.dom.addStyle(l)}const a=Promise.all(((l,d,c)=>{const u=[w1(l).loadAll(d)];return l.inline?u:u.concat([l.ui.styleSheetLoader.loadAll(c)])})(t,r,n)).then(s).catch(s),i=Kx(t);return i&&((l,d)=>{const c=N(l.getBody()),u=Vl(vr(c)),f=Ut("style");re(f,"type","text/css"),Ht(f,as(d)),Ht(u,f),l.on("remove",()=>{Mt(f)})})(t,i),a},vm=t=>{var e;!0!==t.removed&&(jn(e=t)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"}),(e=>{e.bindPendingEventDelegates(),e.initialized=!0,e.dispatch("Init"),e.focus(!0),(r=>{const o=r.dom.getRoot();r.inline||ti(r)&&r.selection.getStart(!0)!==o||be(o).each(s=>{const a=s.getNode(),i=ds(a)?be(a).getOr(s):s;r.selection.setRng(i.toRange())})})(e),e.nodeChanged({initial:!0});const n=vk(e);xt(n)&&n.call(e,e),(r=>{const o=Ck(r);o&&je.setEditorTimeout(r,()=>{let s;s=!0===o?r:r.editorManager.get(o),s.destroyed||s.focus()},100)})(e)})(t))},k1=t=>{const e=t.getElement();let n=t.getDoc();t.inline&&(hm.addClass(e,"mce-content-body"),t.contentDocument=n=document,t.contentWindow=window,t.bodyElement=e,t.contentAreaContainer=e);const r=t.getBody();var a,i;r.disabled=!0,t.readonly=gp(t),t.readonly||(t.inline&&"static"===hm.getStyle(r,"position",!0)&&(r.style.position="relative"),r.contentEditable="true"),r.disabled=!1,t.editorUpload=(t=>{const e=(()=>{let p=[];const b=y=>{if(!y.blob||!y.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");const w=y.id||"blobid"+l_+++(()=>{const D=()=>Math.round(4294967295*Math.random()).toString(36);return"s"+(new Date).getTime().toString(36)+D()+D()+D()})(),x=y.name||w,S=y.blob;var k;return{id:q(w),name:q(x),filename:q(y.filename||x+"."+(k=S.type,{"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"}[k.toLowerCase()]||"dat")),blob:q(S),base64:q(y.base64),blobUri:q(y.blobUri||URL.createObjectURL(S)),uri:q(y.uri)}},h=y=>Gt(p,y).getOrUndefined(),v=y=>h(w=>w.id()===y);return{create:(y,w,x,S,k)=>{if(st(y))return b({id:y,name:S,filename:k,blob:w,base64:x});if(Te(y))return b(y);throw new Error("Unknown input type")},add:y=>{v(y.id())||p.push(y)},get:v,getByUri:y=>h(w=>w.blobUri()===y),getByData:(y,w)=>h(x=>x.base64()===y&&x.blob().type===w),findFirst:h,removeByUri:y=>{p=dt(p,w=>w.blobUri()!==y||(URL.revokeObjectURL(w.blobUri()),!1))},destroy:()=>{H(p,y=>{URL.revokeObjectURL(y.blobUri())}),p=[]}}})();let n,r;const o=pv(),s=[],a=p=>b=>t.selection?p(b):[],i=(p,b,h)=>{let v=0;do{v=p.indexOf(b,v),-1!==v&&(p=p.substring(0,v)+h+p.substr(v+b.length),v+=h.length-b.length+1)}while(-1!==v);return p},l=(p,b,h)=>(p=i(p,`src="${b}"`,`src="${h}"${h===Ct.transparentSrc?' data-mce-placeholder="1"':""}`),i(p,'data-mce-src="'+b+'"','data-mce-src="'+h+'"')),d=(p,b)=>{H(t.undoManager.data,h=>{"fragmented"===h.type?h.fragments=yt(h.fragments,v=>l(v,p,b)):h.content=l(h.content,p,b)})},c=()=>(n||(n=bv(t,o)),m().then(a(p=>{const b=yt(p,h=>h.blobInfo);return n.upload(b,hv(t)).then(a(h=>{const v=[];let y=!1;const w=yt(h,(x,S)=>{const k=p[S].blobInfo,D=p[S].image;let B=!1;return x.status&&Ix(t)?(x.url&&!de(D.src,x.url)&&(y=!0),e.removeByUri(D.src),jn(t)||((M,O)=>{const P=t.convertURL(O,"src");var L;d(M.src,O),pn(N(M),{src:ip(t)?(L=O,L+(-1===L.indexOf("?")?"?":"&")+(new Date).getTime()):O,"data-mce-src":P})})(D,x.url)):x.error&&(x.error.remove&&(d(D.getAttribute("src"),Ct.transparentSrc),v.push(D),B=!0),Ti(t,nn.translate(["Failed to upload image: {0}",x.error.message]))),{element:D,status:x.status,uploadUri:x.url,blobInfo:k,removed:B}});return v.length>0&&!jn(t)?t.undoManager.transact(()=>{H(v,x=>{t.dom.remove(x),e.removeByUri(x.src)})}):y&&t.undoManager.dispatchChange(),w}))}))),u=()=>ap(t)?c():Promise.resolve([]),f=p=>Kr(s,b=>b(p)),m=()=>(r||(r=((t,e)=>{const n={};return{findAll:(r,o=Vt)=>{const s=dt((i=r)?ke(i.getElementsByTagName("img")):[],i=>{const l=i.src;return!i.hasAttribute("data-mce-bogus")&&!i.hasAttribute("data-mce-placeholder")&&!(!l||l===Ct.transparentSrc)&&(ne(l,"blob:")?!t.isUploaded(l)&&o(i):!!ne(l,"data:")&&o(i))}),a=yt(s,i=>{const l=i.src;if(gt(n,l))return n[l].then(d=>st(d)?d:{image:i,blobInfo:d.blobInfo});{const d=((c,u)=>{const f=()=>Promise.reject("Invalid data URI");if(ne(u,"blob:")){const p=c.getByUri(u);return lt(p)?Promise.resolve(p):(m=u,ne(m,"blob:")?(b=m,fetch(b).then(h=>h.ok?h.blob():Promise.reject()).catch(()=>Promise.reject(`Cannot convert ${b} to Blob. Resource might not exist or is inaccessible.`))):ne(m,"data:")?(g=m,new Promise((b,h)=>{ou(g).bind(({type:v,data:y,base64Encoded:w})=>B0(v,y,w)).fold(()=>h("Invalid data URI"),b)})):Promise.reject("Unknown URI format")).then(b=>D0(b).then(h=>P0(h,!1,v=>C.some(L0(c,b,v))).getOrThunk(f)))}var b,m,g;return ne(u,"data:")?M0(c,u).fold(f,p=>Promise.resolve(p)):Promise.reject("Unknown image data format")})(e,l).then(c=>(delete n[l],{image:i,blobInfo:c})).catch(c=>(delete n[l],c));return n[l]=d,d}});var i;return Promise.all(a)}}})(o,e)),r.findAll(t.getBody(),f).then(a(p=>{const b=dt(p,h=>!st(h)||(Ti(t,h),!1));return jn(t)||H(b,h=>{d(h.image.src,h.blobInfo.blobUri()),h.image.src=h.blobInfo.blobUri(),h.image.removeAttribute("data-mce-src")}),b}))),g=p=>p.replace(/src="(blob:[^"]+)"/g,(b,h)=>{const v=o.getResultUri(h);if(v)return'src="'+v+'"';let y=e.getByUri(h);return y||(y=Be(t.editorManager.get(),(w,x)=>w||x.editorUpload&&x.editorUpload.blobCache.getByUri(h),null)),y?'src="data:'+y.blob().type+";base64,"+y.base64()+'"':b});return t.on("SetContent",()=>{ap(t)?u():m()}),t.on("RawSaveContent",p=>{p.content=g(p.content)}),t.on("GetContent",p=>{p.source_view||"raw"===p.format||"tree"===p.format||(p.content=g(p.content))}),t.on("PostRender",()=>{t.parser.addNodeFilter("img",p=>{H(p,b=>{const h=b.attr("src");if(e.getByUri(h))return;const v=o.getResultUri(h);v&&b.attr("src",v)})})}),{blobCache:e,addFilter:p=>{s.push(p)},uploadImages:c,uploadImagesAuto:u,scanForImages:m,destroy:()=>{e.destroy(),o.destroy(),r=n=null}}})(t),t.schema=Jn(C1(t)),t.dom=Et(n,{keep_values:!0,url_converter:t.convertURL,url_converter_scope:t,update_styles:!0,root_element:t.inline?t.getBody():null,collect:()=>t.inline,schema:t.schema,contentCssCors:Hx(t),referrerPolicy:kd(t),onSetAttrib:a=>{t.dispatch("SetAttrib",a)}}),t.parser=(a=>{const i=Ro(y1(a),a.schema);return i.addAttributeFilter("src,href,style,tabindex",(l,d)=>{let c,u,f=l.length;const m=a.dom,g="data-mce-"+d;for(;f--;)if(c=l[f],u=c.attr(d),u&&!c.attr(g)){if(0===u.indexOf("data:")||0===u.indexOf("blob:"))continue;"style"===d?(u=m.serializeStyle(m.parseStyle(u),c.name),u.length||(u=null),c.attr(g,u),c.attr(d,u)):"tabindex"===d?(c.attr(g,u),c.attr(d,null)):c.attr(g,a.convertURL(u,d,c.name))}}),i.addNodeFilter("script",l=>{let d=l.length;for(;d--;){const c=l[d],u=c.attr("type")||"no/type";0!==u.indexOf("mce-")&&c.attr("type","mce-"+u)}}),a.options.get("preserve_cdata")&&i.addNodeFilter("#cdata",l=>{let d=l.length;for(;d--;){const c=l[d];c.type=8,c.name="#comment",c.value="[CDATA["+a.dom.encode(c.value)+"]]"}}),i.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",l=>{let d=l.length;const c=a.schema.getNonEmptyElements();for(;d--;){const u=l[d];u.isEmpty(c)&&0===u.getAll("br").length&&u.append(new ve("br",1))}}),i})(t),t.serializer=lv((a=>{const i=a.options.get;return at(at(at({},y1(a)),C1(a)),bm({url_converter:i("url_converter"),url_converter_scope:i("url_converter_scope"),element_format:i("element_format"),entities:i("entities"),entity_encoding:i("entity_encoding"),indent:i("indent"),indent_after:i("indent_after"),indent_before:i("indent_before")}))})(t),t),t.selection=iv(t.dom,t.getWin(),t.serializer,t),t.annotator=gh(t),t.formatter=Cv(t),t.undoManager=xv(t),t._nodeChangeDispatcher=new eR(t),t._selectionOverrides=xR(t),(a=>{const i=Zn(),l=Xt(!1),d=fd(c=>{a.dispatch("longpress",Rt(at({},c),{type:"longpress"})),l.set(!0)},400);a.on("touchstart",c=>{Cy(c).each(u=>{d.cancel();const f={x:u.clientX,y:u.clientY,target:c.target};d.throttle(c),l.set(!1),i.set(f)})},!0),a.on("touchmove",c=>{d.cancel(),Cy(c).each(u=>{i.on(f=>{((m,g)=>{const p=Math.abs(m.clientX-g.x),b=Math.abs(m.clientY-g.y);return p>5||b>5})(u,f)&&(i.clear(),l.set(!1),a.dispatch("longpresscancel"))})})},!0),a.on("touchend touchcancel",c=>{d.cancel(),"touchcancel"!==c.type&&i.get().filter(u=>u.target.isEqualNode(c.target)).each(()=>{l.get()?c.preventDefault():a.dispatch("tap",Rt(at({},c),{type:"tap"}))})},!0)})(t),(i=a=t).on("click",l=>{i.dom.getParent(l.target,"details")&&l.preventDefault()}),(i=>{i.parser.addNodeFilter("details",l=>{H(l,d=>{d.attr("data-mce-open",d.attr("open")),d.attr("open","open")})}),i.serializer.addNodeFilter("details",l=>{H(l,d=>{const c=d.attr("data-mce-open");d.attr("open",st(c)?c:null),d.attr("data-mce-open",null)})})})(a),(a=>{const i="contenteditable",l=" "+z.trim(Dk(a))+" ",d=" "+z.trim(bp(a))+" ",c=wy(l),u=wy(d),f=Pk(a);f.length>0&&a.on("BeforeSetContent",m=>{((g,p,b)=>{let h=p.length,v=b.content;if("raw"!==b.format){for(;h--;)v=v.replace(p[h],tN(g,v,bp(g)));b.content=v}})(a,f,m)}),a.parser.addAttributeFilter("class",m=>{let g=m.length;for(;g--;){const p=m[g];c(p)?p.attr(i,"true"):u(p)&&p.attr(i,"false")}}),a.serializer.addAttributeFilter(i,m=>{let g=m.length;for(;g--;){const p=m[g];(c(p)||u(p))&&(f.length>0&&p.attr("data-mce-content")?(p.name="#text",p.type=3,p.raw=!0,p.value=p.attr("data-mce-content")):p.attr(i,null))}})})(t),jn(t)||((a=>{a.on("mousedown",i=>{i.detail>=3&&(i.preventDefault(),(t=>{const e=((n,r)=>{const o=I.fromRangeStart(n).getNode(),s=(c=r,oo(N(o),u=>vn(u.dom)||en(u),ZC(c)).getOr(N(c)).dom),a=e1(o,s,!1),i=e1(o,s,!0),l=document.createRange();var c;return t1(a,s).fold(()=>{JC(a)?l.setStart(a,0):l.setStartBefore(a)},d=>l.setStartBefore(d.dom)),t1(i,s).fold(()=>{JC(i)?l.setEnd(i,i.data.length):l.setEndAfter(i)},d=>l.setEndAfter(d.dom)),l})(t.selection.getRng(),t.getBody());t.selection.setRng(Dc(e))})(a))})})(t),(a=>{(t=>{const e=[",",".",";",":","!","?"],n=[32],r=()=>ep(hp(t));t.on("keydown",o=>{var s;13!==o.keyCode||J.modifierPressed(o)||((t,e)=>{if(!(t.selection.isCollapsed()&&(o=e,o.inlinePatterns.length>0||o.blockPatterns.length>0)))return!1;var o;const n=p1(t,e.inlinePatterns,!1),r=((o,s)=>{const a=o.dom,i=o.selection.getRng();return gm(o,i).filter(l=>{const d=_e(o),c=a.is(l,d);return null!==l&&c}).bind(l=>{const d=l.textContent;return((u,f)=>{const m=f.replace(ae," ");return Gt(u,g=>0===f.indexOf(g.start)||0===m.indexOf(g.start))})(s,d).map(u=>z.trim(d).length===u.start.length?[]:[{pattern:u,range:fm(a.getRoot(),l,0,l,0)}])}).getOr([])})(t,e.blockPatterns);return(r.length>0||n.length>0)&&(t.undoManager.add(),t.undoManager.extra(()=>{t.execCommand("mceInsertNewLine")},()=>{t.insertContent("\ufeff"),h1(t,n),((a,i)=>{if(0===i.length)return;const l=a.selection.getBookmark();H(i,d=>((c,u)=>{const m=u.pattern,g=i1(c.dom.getRoot(),u.range).getOrDie("Unable to resolve path range");return gm(c,g).each(p=>{"block-format"===m.type?((b,h)=>{const v=h.get(b);return Kt(v)&&De(v).exists(y=>gt(y,"block"))})(m.format,c.formatter)&&c.undoManager.transact(()=>{l1(c.dom,p,m),c.formatter.apply(m.format)}):"block-command"===m.type&&c.undoManager.transact(()=>{l1(c.dom,p,m),c.execCommand(m.cmd,!1,m.value)})}),!0})(a,d)),a.selection.moveToBookmark(l)})(t,r);const o=t.selection.getRng(),s=Fu(o.startContainer,o.startOffset,t.dom.getRoot());t.execCommand("mceInsertNewLine"),s.each(a=>{const i=a.container;"\ufeff"===i.data.charAt(a.offset-1)&&(i.deleteData(a.offset-1,1),Io(t.dom,i.parentNode,l=>l===t.dom.getRoot()))})}),!0)})(t,(s=hp(t),{inlinePatterns:ep(s),blockPatterns:kx(s)}))&&o.preventDefault()},!0),t.on("keyup",o=>{v1(n,o,(s,a)=>s===a.keyCode&&!1===J.modifierPressed(a))&&b1(t,r())}),t.on("keypress",o=>{v1(e,o,(s,a)=>s.charCodeAt(0)===a.charCode)&&je.setEditorTimeout(t,()=>{b1(t,r())})})})(a)})(t));const o=tR(t);((t,e)=>{t.addCommand("delete",()=>{var n;yy(n=t,e,!1).fold(()=>{Cc(n),Tb(n)},qo)}),t.addCommand("forwardDelete",()=>{var n;yy(n=t,e,!0).fold(()=>Ob(n,"ForwardDelete"),qo)})})(t,o),(a=>{a.on("NodeChange",Y(Z_,a))})(t),(a=>{const i=a.dom,l=_e(a),d=Qx(a),c=(u,f)=>{if((p=>{if(Sv(p)){const b=p.keyCode;return!Ev(p)&&(J.metaKeyPressed(p)||p.altKey||b>=112&&b<=123||Ot(p_,b))}return!1})(u))return;const m=a.getBody(),g=!(Sv(p=u)&&!(Ev(p)||"keyup"===p.type&&229===p.keyCode))&&((p,b,h)=>{if(Yt(N(b),!1)){const v=b.firstElementChild;return!v||!p.getStyle(b.firstElementChild,"padding-left")&&!p.getStyle(b.firstElementChild,"padding-right")&&h===v.nodeName.toLowerCase()}return!1})(i,m,l);var p;(""!==i.getAttrib(m,kv)!==g||f)&&(i.setAttrib(m,kv,g?d:null),i.setAttrib(m,"aria-placeholder",g?d:null),((p,b)=>{p.dispatch("PlaceholderToggle",{state:b})})(a,g),a.on(g?"keydown":"keyup",c),a.off(g?"keyup":"keydown",c))};d&&a.on("init",u=>{c(u,!0),a.on("change SetContent ExecCommand",c),a.on("paste",f=>je.setEditorTimeout(a,()=>c(f)))})})(t),(t=>{const e=Xt(!1),n=Xt(Ok(t)?"text":"html"),r=(o=>{const s=Xt(null);return{create:()=>((a,i)=>{const{dom:l,selection:d}=a,c=a.getBody();i.set(d.getRng());const u=l.add(a.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},LC);Ct.browser.isFirefox()&&l.setStyle(u,"left","rtl"===l.getStyle(c,"direction",!0)?65535:-65535),l.bind(u,"beforedeactivate focusin focusout",f=>{f.stopPropagation()}),u.focus(),d.select(u,!0)})(o,s),remove:()=>((a,i)=>{const l=a.dom;if(am(a)){let d;const c=i.get();for(;d=am(a);)l.remove(d),l.unbind(d);c&&a.selection.setRng(c)}i.set(null)})(o,s),getEl:()=>am(o),getHtml:()=>(a=>{const i=a.dom,l=(f,m)=>{f.appendChild(m),i.remove(m,!0)},[d,...c]=dt(a.getBody().childNodes,rR);H(c,f=>{l(d,f)});const u=i.select("div[id=mcepastebin]",d);for(let f=u.length-1;f>=0;f--){const m=i.create("div");d.insertBefore(m,u[f]),l(m,u[f])}return d?d.innerHTML:""})(o),getLastRng:s.get}})(t);var o,s,a;o=t,(Ct.browser.isChromium()||Ct.browser.isSafari())&&(a=dR,(s=o).on("PastePreProcess",i=>{i.content=a(s,i.content,i.internal)})),((o,s)=>{o.addCommand("mceTogglePlainTextPaste",()=>{((a,i)=>{"text"===i.get()?(i.set("html"),Ch(a,!1)):(i.set("text"),Ch(a,!0)),a.focus()})(o,s)}),o.addCommand("mceInsertClipboardContent",(a,i)=>{i.html&&tl(o,i.html,i.internal),i.text&&dm(o,i.text)})})(t,n),(o=>{const s=l=>d=>{l(o,d)},a=Sk(o);xt(a)&&o.on("PastePreProcess",s(a));const i=Ek(o);xt(i)&&o.on("PastePostProcess",s(i))})(t),t.on("PreInit",()=>{(o=>{o.on("cut",(s=>a=>{!a.isDefaultPrevented()&&GC(s)&&qC(a,KC(s),WC(s),()=>{if(Ct.browser.isChromium()||Ct.browser.isFirefox()){const i=s.selection.getRng();je.setEditorTimeout(s,()=>{s.selection.setRng(i),s.execCommand("Delete")},0)}else s.execCommand("Delete")})})(o)),o.on("copy",(s=>a=>{!a.isDefaultPrevented()&&GC(s)&&qC(a,KC(s),WC(s),pt)})(o))})(t),((o,s)=>{kk(o)&&o.on("dragend dragover draggesture dragdrop drop drag",a=>{a.preventDefault(),a.stopPropagation()}),ja(o)||o.on("drop",a=>{const i=a.dataTransfer;i&&It(i.files,d=>/^image\//.test(d.type))&&a.preventDefault()}),o.on("drop",a=>{if(a.isDefaultPrevented()||s.get())return;const i=YC(o,a);if(xe(i))return;const l=jC(a.dataTransfer),d=Lo(l,Zi());if((!VC(l)||(f=>{const m=f["text/plain"];return!!m&&0===m.indexOf("file://")})(l))&&HC(o,a,i))return;const c=l[Zi()],u=c||l["text/html"]||l["text/plain"];u&&(a.preventDefault(),je.setEditorTimeout(o,()=>{o.undoManager.transact(()=>{c&&o.execCommand("Delete"),XC(o,i);const f=FC(u);l["text/html"]?tl(o,f,d):dm(o,f)})}))}),o.on("dragstart",a=>{s.set(!0)}),o.on("dragover dragend",a=>{ja(o)&&!1===s.get()&&(a.preventDefault(),XC(o,YC(o,a))),"dragend"===a.type&&s.set(!1)})})(t,e),((t,e,n)=>{((r,o,s)=>{let a;r.on("keydown",i=>{var l;(J.metaKeyPressed(l=i)&&86===l.keyCode||l.shiftKey&&45===l.keyCode)&&!i.isDefaultPrevented()&&(a=i.shiftKey&&86===i.keyCode)}),r.on("paste",i=>{if(i.isDefaultPrevented()||(c=i,Ct.os.isAndroid()&&0===(null===(f=null===(u=c.clipboardData)||void 0===u?void 0:u.items)||void 0===f?void 0:f.length)))return;var c,u,f;const l="text"===s.get()||a;a=!1;const d=jC(i.clipboardData);!VC(d)&&HC(r,i,o.getLastRng()||r.selection.getRng())||(Lo(d,"text/html")?(i.preventDefault(),$C(r,d,d["text/html"],l)):(o.create(),je.setEditorTimeout(r,()=>{const c=o.getHtml();o.remove(),$C(r,d,c,l)},0)))})})(t,e,n),(r=>{const o=a=>ne(a,"webkit-fake-url"),s=a=>ne(a,"data:");r.parser.addNodeFilter("img",(a,i,l)=>{if(!ja(r)&&!0===(null===(c=l.data)||void 0===c?void 0:c.paste))for(const d of a){const c=d.attr("src");st(c)&&!d.attr("data-mce-object")&&c!==Ct.transparentSrc&&(o(c)||!Bk(r)&&s(c))&&d.remove()}var c})})(t)})(t,r,n)})})(t);const s=(a=>{const i=a;return(l=a,Nt(l.plugins,"rtc").bind(d=>C.from(d.setup))).fold(()=>(i.rtcInstance=ev(a),C.none()),l=>(i.rtcInstance=(()=>{const d=q(null),c=q("");return{init:{bindEvents:pt},undoManager:{beforeChange:pt,add:d,undo:d,redo:d,clear:pt,reset:pt,hasUndo:Dt,hasRedo:Dt,transact:d,ignore:pt,extra:pt},formatter:{match:Dt,matchAll:q([]),matchNode:q(void 0),canApply:Dt,closest:c,apply:pt,remove:pt,toggle:pt,formatChanged:q({unbind:pt})},editor:{getContent:c,setContent:q({content:"",html:""}),insertContent:q(""),addVisual:pt},selection:{getContent:c},autocompleter:{addDecoration:pt,removeDecoration:pt},raw:{getModel:q(C.none())}}})(),C.some(()=>l().then(d=>(i.rtcInstance=(c=>{const u=y=>Te(y)?y:{},{init:f,undoManager:m,formatter:g,editor:p,selection:b,autocompleter:h,raw:v}=c;return{init:{bindEvents:f.bindEvents},undoManager:{beforeChange:m.beforeChange,add:m.add,undo:m.undo,redo:m.redo,clear:m.clear,reset:m.reset,hasUndo:m.hasUndo,hasRedo:m.hasRedo,transact:(y,w,x)=>m.transact(x),ignore:(y,w)=>m.ignore(w),extra:(y,w,x,S)=>m.extra(x,S)},formatter:{match:(y,w,x,S)=>g.match(y,u(w),S),matchAll:g.matchAll,matchNode:g.matchNode,canApply:y=>g.canApply(y),closest:y=>g.closest(y),apply:(y,w,x)=>g.apply(y,u(w)),remove:(y,w,x,S)=>g.remove(y,u(w)),toggle:(y,w,x)=>g.toggle(y,u(w)),formatChanged:(y,w,x,S,k)=>g.formatChanged(w,x,S,k)},editor:{getContent:y=>p.getContent(y),setContent:(y,w)=>({content:p.setContent(y,w),html:""}),insertContent:(y,w)=>(p.insertContent(y),""),addVisual:p.addVisual},selection:{getContent:(y,w)=>b.getContent(w)},autocompleter:{addDecoration:h.addDecoration,removeDecoration:h.removeDecoration},raw:{getModel:()=>C.some(v.getRawModel())}}})(d),d.rtc.isRemote)))));var l})(t);(a=>{const i=a.getDoc(),l=a.getBody();a.dispatch("PreInit"),wk(a)||(i.body.spellcheck=!1,hm.setAttrib(l,"spellcheck","false")),a.quirks=(t=>{const e=z.each,n=J.BACKSPACE,r=J.DELETE,o=t.dom,s=t.selection,a=t.parser,i=Ct.browser,l=i.isFirefox(),d=i.isChromium()||i.isSafari(),c=Ct.deviceType.isiPhone()||Ct.deviceType.isiPad(),u=Ct.os.isMacOS()||Ct.os.isiOS(),f=(O,P)=>{try{t.getDoc().execCommand(O,!1,P)}catch(L){}},m=O=>O.isDefaultPrevented(),g=()=>{t.shortcuts.add("meta+a",null,"SelectAll")},p=()=>{t.inline||o.bind(t.getDoc(),"mousedown mouseup",O=>{let P;if(O.target===t.getDoc().documentElement)if(P=s.getRng(),t.getBody().focus(),"mousedown"===O.type){if(Ie(P.startContainer))return;s.placeCaretAt(O.clientX,O.clientY)}else s.setRng(P)})},b=()=>{Range.prototype.getClientRects||t.on("mousedown",O=>{if(!m(O)&&"HTML"===O.target.nodeName){const P=t.getBody();P.blur(),je.setEditorTimeout(t,()=>{P.focus()})}})},h=()=>{const O=pp(t);t.on("click",P=>{const L=P.target;/^(IMG|HR)$/.test(L.nodeName)&&"false"!==o.getContentEditableParent(L)&&(P.preventDefault(),t.selection.select(L),t.nodeChanged()),"A"===L.nodeName&&o.hasClass(L,O)&&0===L.childNodes.length&&(P.preventDefault(),s.select(L))})},v=()=>{t.on("keydown",O=>{if(!m(O)&&O.keyCode===n&&s.isCollapsed()&&0===s.getRng().startOffset){const P=s.getNode().previousSibling;if(P&&P.nodeName&&"table"===P.nodeName.toLowerCase())return O.preventDefault(),!1}})},y=()=>{gp(t)||t.on("BeforeExecCommand mousedown",()=>{f("StyleWithCSS",!1),f("enableInlineTableEditing",!1),mp(t)||f("enableObjectResizing",!1)})},w=()=>{t.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},x=()=>{t.inline||t.on("keydown",()=>{document.activeElement===document.body&&t.getWin().focus()})},S=()=>{t.inline||(t.contentStyles.push("body {min-height: 150px}"),t.on("click",O=>{let P;"HTML"===O.target.nodeName&&(P=t.selection.getRng(),t.getBody().focus(),t.selection.setRng(P),t.selection.normalize(),t.nodeChanged())}))},k=()=>{u&&t.on("keydown",O=>{!J.metaKeyPressed(O)||O.shiftKey||37!==O.keyCode&&39!==O.keyCode||(O.preventDefault(),t.selection.getSel().modify("move",37===O.keyCode?"backward":"forward","lineboundary"))})},D=()=>{t.on("click",O=>{let P=O.target;do{if("A"===P.tagName)return void O.preventDefault()}while(P=P.parentNode)}),t.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},B=()=>{t.on("init",()=>{t.dom.bind(t.getBody(),"submit",O=>{O.preventDefault()})})},M=pt;return jn(t)?(d&&(p(),h(),B(),g(),c&&(x(),S(),D())),l&&(b(),y(),w(),k())):(t.on("keydown",O=>{let P,L;if(m(O)||O.keyCode!==J.BACKSPACE)return;P=s.getRng();const F=P.startContainer,V=P.startOffset,nt=o.getRoot();if(L=F,P.collapsed&&0===V){for(;L&&L.parentNode&&L.parentNode.firstChild===L&&L.parentNode!==nt;)L=L.parentNode;"BLOCKQUOTE"===L.tagName&&(t.formatter.toggle("blockquote",null,L),P=o.createRng(),P.setStart(F,0),P.setEnd(F,0),s.setRng(P))}}),(()=>{const O=P=>{const L=o.create("body"),F=P.cloneContents();return L.appendChild(F),s.serializer.serialize(L,{format:"html"})};t.on("keydown",P=>{const L=P.keyCode;let F,V;if(!m(P)&&(L===r||L===n)){if(F=t.selection.isCollapsed(),V=t.getBody(),F&&!o.isEmpty(V)||!F&&!(nt=>{const tt=O(nt),it=o.createRng();return it.selectNode(t.getBody()),tt===O(it)})(t.selection.getRng()))return;P.preventDefault(),t.setContent(""),V.firstChild&&o.isBlock(V.firstChild)?t.selection.setCursorLocation(V.firstChild,0):t.selection.setCursorLocation(V,0),t.nodeChanged()}})})(),Ct.windowsPhone||t.on("keyup focusin mouseup",O=>{J.modifierPressed(O)||(P=>{const L=P.getBody(),F=P.selection.getRng();return F.startContainer===F.endContainer&&F.startContainer===L&&0===F.startOffset&&F.endOffset===L.childNodes.length})(t)||s.normalize()},!0),d&&(p(),h(),t.on("init",()=>{f("DefaultParagraphSeparator",_e(t))}),B(),v(),a.addNodeFilter("br",O=>{let P=O.length;for(;P--;)"Apple-interchange-newline"===O[P].attr("class")&&O[P].remove()}),c?(x(),S(),D()):g()),l&&(t.on("keydown",O=>{if(!m(O)&&O.keyCode===n){if(!t.getBody().getElementsByTagName("hr").length)return;if(s.isCollapsed()&&0===s.getRng().startOffset){const P=s.getNode(),L=P.previousSibling;if("HR"===P.nodeName)return o.remove(P),void O.preventDefault();L&&L.nodeName&&"hr"===L.nodeName.toLowerCase()&&(o.remove(L),O.preventDefault())}}}),b(),(()=>{const O=()=>{const L=o.getAttribs(s.getStart().cloneNode(!1));return()=>{const F=s.getStart();F!==t.getBody()&&(o.setAttrib(F,"style",null),e(L,V=>{F.setAttributeNode(V.cloneNode(!0))}))}},P=()=>!s.isCollapsed()&&o.getParent(s.getStart(),o.isBlock)!==o.getParent(s.getEnd(),o.isBlock);t.on("keypress",L=>{let F;if(!m(L)&&(8===L.keyCode||46===L.keyCode)&&P())return F=O(),t.getDoc().execCommand("delete",!1,null),F(),L.preventDefault(),!1}),o.bind(t.getDoc(),"cut",L=>{let F;!m(L)&&P()&&(F=O(),je.setEditorTimeout(t,()=>{F()}))})})(),y(),t.on("SetContent ExecCommand",O=>{"setcontent"!==O.type&&"mceInsertLink"!==O.command||e(o.select("a"),P=>{let L=P.parentNode;const F=o.getRoot();if(L.lastChild===P){for(;L&&!o.isBlock(L);){if(L.parentNode.lastChild!==L||L===F)return;L=L.parentNode}o.add(L,"br",{"data-mce-bogus":1})}})}),w(),k(),v())),{refreshContentEditable:M,isHidden:()=>{if(!l||t.removed)return!1;const O=t.selection.getSel();return!O||!O.rangeCount||0===O.rangeCount}}})(a),a.dispatch("PostRender");const d=Gx(a);void 0!==d&&(l.dir=d);const c=xk(a);c&&a.on("BeforeSetContent",u=>{z.each(c,f=>{u.content=u.content.replace(f,m=>"\x3c!--mce:protected "+escape(m)+"--\x3e")})}),a.on("SetContent",()=>{a.addVisual(a.getBody())}),a.on("compositionstart compositionend",u=>{a.composing="compositionstart"===u.type})})(t),s.fold(()=>{x1(t).then(()=>vm(t))},a=>{t.setProgressState(!0),x1(t).then(()=>{a().then(i=>{t.setProgressState(!1),vm(t),nv(t)},i=>{t.notificationManager.open({type:"error",text:String(i)}),vm(t),nv(t)})})})},S1=(t,e)=>{if(t.inline||(t.getElement().style.visibility=t.orgVisibility),e||t.inline)k1(t);else{const r=t.iframeElement,o=((t,e,n,r)=>((o,s,a,i,l)=>{const d=(c=a,u=i,f=>{c(f)&&u((m=>{const g=N(Tf(m).getOr(m.target)),p=()=>m.stopPropagation(),b=()=>m.preventDefault(),h=mr(b,p);return{target:g,x:m.clientX,y:m.clientY,stop:p,prevent:b,kill:h,raw:m}})(f))});var c,u;return o.dom.addEventListener(s,d,!1),{unbind:Y(Mw,o,s,d,!1)}})(t,"load",n,r))(N(r),0,a_,()=>{o.unbind(),t.contentDocument=r.contentDocument,k1(t)});r.srcdoc=t.iframeHTML}},rl=Et.DOM,E1=Et.DOM,_1=t=>({editorContainer:t,iframeContainer:t,api:{}}),Vr=Et.DOM,N1=t=>"-"===t.charAt(0),R1=(t,e,n)=>C.from(e).filter(r=>Pn(r)&&!Oi.has(r)).map(r=>({url:`${t.editorManager.baseURL}/icons/${r}/icons${n}.js`,name:C.some(r)})),A1=pr().deviceType,O1=A1.isPhone(),TR=A1.isTablet(),sa=t=>{if(xe(t))return[];{const e=Kt(t)?t:t.split(/[ ,]/),n=yt(e,Jr);return dt(n,Pn)}},ym=(t,e)=>gt(t.sections(),e),DR=(t,e)=>at({table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:Nt(t,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1},e?{menubar:!1}:{}),PR=(t,e)=>{var n;const r=null!==(n=e.external_plugins)&&void 0!==n?n:{};return t&&t.external_plugins?z.extend({},t.external_plugins,r):r},IR=(t,e)=>{const n=t.selection,r=t.dom;return/^ | $/.test(e)?((o,s,a)=>{const i=N(o.getRoot());return a=ci(i,I.fromRangeStart(s))?a.replace(/^ /,"&nbsp;"):a.replace(/^&nbsp;/," "),ui(i,I.fromRangeEnd(s))?a.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):a.replace(/&nbsp;(<br( \/)?>)?$/," ")})(r,n.getRng(),e):e},ol=(t,e)=>{const{content:n,details:r}=(o=>{if("string"!=typeof o){const s=z.extend({paste:o.paste,data:{paste:o.paste}},o);return{content:o.content,details:s}}return{content:o,details:{}}})(e);au(t,{content:IR(t,n),format:"html",set:!1,selection:!0,paste:r.paste}).each(o=>{const s=(i=o.content,l=r,fu(t).editor.insertContent(i,l));var i,l;iu(t,s,o),t.addVisual()})},FR={"font-size":"size","font-family":"face"},T1=t=>(e,n)=>C.from(n).map(N).filter(Ge).bind(r=>{return(o=t,s=e,a=r.dom,Ic(N(a),i=>{return Ca(l=i,o).orThunk(()=>"font"===Tt(l)?Nt(FR,o).bind(d=>to(l,d)):C.none());var l},i=>kt(N(s),i))).or(((o,s)=>C.from(Et.DOM.getStyle(s,o,!0)))(t,r.dom));var o,s,a}).getOr(""),UR=T1("font-size"),zR=mr(t=>t.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),T1("font-family")),jR=t=>be(t.getBody()).map(e=>{const n=e.container();return G(n)?n.parentNode:n}),Cm=(t,e)=>{return n=t,r=Pm(C.some,e),(o=n,C.from(o.selection.getRng()).bind(s=>{const a=o.getBody();return s.startContainer===a&&0===s.startOffset?C.none():C.from(o.selection.getStart(!0))})).orThunk(Y(jR,n)).map(N).filter(Ge).bind(r);var n,r,o},B1=(t,e)=>{if(/^[0-9.]+$/.test(e)){const n=parseInt(e,10);if(n>=1&&n<=7){const r=z.explode(t.options.get("font_size_style_values")),o=z.explode(t.options.get("font_size_classes"));return o?o[n-1]||e:r[n-1]||e}return e}return e},VR=t=>{const e=t.split(/\s*,\s*/);return yt(e,n=>-1===n.indexOf(" ")||ne(n,'"')||ne(n,"'")?n:`'${n}'`).join(",")};class D1{constructor(e){this.commands={state:{},exec:{},value:{}},this.editor=e}execCommand(e,n,r,o){const s=this.editor,a=e.toLowerCase(),i=null==o?void 0:o.skip_focus;if(s.removed||("mcefocus"!==a&&(/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(a)||i?sc(d=s).each(c=>d.selection.setRng(c)):s.focus()),s.dispatch("BeforeExecCommand",{command:e,ui:n,value:r}).isDefaultPrevented()))return!1;var d;const l=this.commands.exec[a];return!!xt(l)&&(l(a,n,r),s.dispatch("ExecCommand",{command:e,ui:n,value:r}),!0)}queryCommandState(e){if(this.editor.quirks.isHidden()||this.editor.removed)return!1;const n=e.toLowerCase(),r=this.commands.state[n];return!!xt(r)&&r(n)}queryCommandValue(e){if(this.editor.quirks.isHidden()||this.editor.removed)return"";const n=e.toLowerCase(),r=this.commands.value[n];return xt(r)?r(n):""}addCommands(e,n="exec"){const r=this.commands;At(e,(o,s)=>{H(s.toLowerCase().split(","),a=>{r[n][a]=o})})}addCommand(e,n,r){const o=e.toLowerCase();this.commands.exec[o]=(s,a,i)=>n.call(null!=r?r:this.editor,a,i)}queryCommandSupported(e){const n=e.toLowerCase();return!!this.commands.exec[n]}addQueryStateHandler(e,n,r){this.commands.state[e.toLowerCase()]=()=>n.call(null!=r?r:this.editor)}addQueryValueHandler(e,n,r){this.commands.value[e.toLowerCase()]=()=>n.call(null!=r?r:this.editor)}}const Fo="data-mce-contenteditable",wm=(t,e,n)=>{try{t.getDoc().execCommand(e,!1,String(n))}catch(r){}},sl=(t,e)=>{t.dom.contentEditable=e?"true":"false"},Hr=t=>t.readonly,P1=t=>{t.parser.addAttributeFilter("contenteditable",e=>{Hr(t)&&H(e,n=>{n.attr(Fo,n.attr("contenteditable")),n.attr("contenteditable","false")})}),t.serializer.addAttributeFilter(Fo,e=>{Hr(t)&&H(e,n=>{n.attr("contenteditable",n.attr(Fo))})}),t.serializer.addTempAttr(Fo)},qR=["copy"],WR=z.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class xm{constructor(e){this.bindings={},this.settings=e||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||Dt}static isNative(e){return!!WR[e.toLowerCase()]}fire(e,n){return this.dispatch(e,n)}dispatch(e,n){const r=e.toLowerCase(),o=ld(r,null!=n?n:{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(o);const s=this.bindings[r];if(s)for(let a=0,i=s.length;a<i;a++){const l=s[a];if(!l.removed){if(l.once&&this.off(r,l.func),o.isImmediatePropagationStopped())return o;if(!1===l.func.call(this.scope,o))return o.preventDefault(),o}}return o}on(e,n,r,o){if(!1===n&&(n=Dt),n){const s={func:n,removed:!1};o&&z.extend(s,o);const a=e.toLowerCase().split(" ");let i=a.length;for(;i--;){const l=a[i];let d=this.bindings[l];d||(d=[],this.toggleEvent(l,!0)),d=r?[s,...d]:[...d,s],this.bindings[l]=d}}return this}off(e,n){if(e){const r=e.toLowerCase().split(" ");let o=r.length;for(;o--;){const s=r[o];let a=this.bindings[s];if(!s)return At(this.bindings,(i,l)=>{this.toggleEvent(l,!1),delete this.bindings[l]}),this;if(a){if(n){const i=Wo(a,l=>l.func===n);a=i.fail,this.bindings[s]=a,H(i.pass,l=>{l.removed=!0})}else a.length=0;a.length||(this.toggleEvent(e,!1),delete this.bindings[s])}}}else At(this.bindings,(r,o)=>{this.toggleEvent(o,!1)}),this.bindings={};return this}once(e,n,r){return this.on(e,n,r,{once:!0})}has(e){return e=e.toLowerCase(),!(!this.bindings[e]||0===this.bindings[e].length)}}const aa=t=>(t._eventDispatcher||(t._eventDispatcher=new xm({scope:t,toggleEvent:(e,n)=>{xm.isNative(e)&&t.toggleNativeEvent&&t.toggleNativeEvent(e,n)}})),t._eventDispatcher),km={fire(t,e,n){return this.dispatch(t,e,n)},dispatch(t,e,n){const r=this;if(r.removed&&"remove"!==t&&"detach"!==t)return ld(t.toLowerCase(),null!=e?e:{},r);const o=aa(r).dispatch(t,e);if(!1!==n&&r.parent){let s=r.parent();for(;s&&!o.isPropagationStopped();)s.dispatch(t,o,!1),s=s.parent()}return o},on(t,e,n){return aa(this).on(t,e,n)},off(t,e){return aa(this).off(t,e)},once(t,e){return aa(this).once(t,e)},hasEventListeners(t){return aa(this).has(t)}},al=Et.DOM;let $r;const il=(t,e)=>{if("selectionchange"===e)return t.getDoc();if(!t.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(e))return t.getDoc().documentElement;const n=fp(t);return n?(t.eventRoot||(t.eventRoot=al.select(n)[0]),t.eventRoot):t.getBody()},L1=(t,e,n)=>{var r;(r=t).hidden||Hr(r)?Hr(t)&&((r,o)=>{if("click"!==o.type||J.metaKeyPressed(o))Ot(qR,o.type)&&r.dispatch(o.type,o);else{const s=N(o.target);(a=r,i=s,kr(i,"a",l=>kt(l,N(a.getBody()))).bind(l=>to(l,"href"))).each(a=>{if(o.preventDefault(),/^#/.test(a)){const l=r.dom.select(`${a},[name="${i=a,ne(i,"#")?(d=i,d.substring("#".length)):i}"]`);l.length&&r.selection.scrollIntoView(l[0],!0)}else window.open(a,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes");var d,i})}var a,i})(t,n):t.dispatch(e,n)},M1=(t,e)=>{let n;if(t.delegates||(t.delegates={}),t.delegates[e]||t.removed)return;const r=il(t,e);if(fp(t)){if($r||($r={},t.editorManager.on("removeEditor",()=>{t.editorManager.activeEditor||$r&&(At($r,(o,s)=>{t.dom.unbind(il(t,s))}),$r=null)})),$r[e])return;n=o=>{const s=o.target,a=t.editorManager.get();let i=a.length;for(;i--;){const l=a[i].getBody();(l===s||al.isChildOf(s,l))&&L1(a[i],e,o)}},$r[e]=n,al.bind(r,e,n)}else n=o=>{L1(t,e,o)},al.bind(r,e,n),t.delegates[e]=n},I1=Rt(at({},km),{bindPendingEventDelegates(){const t=this;z.each(t._pendingNativeEvents,e=>{M1(t,e)})},toggleNativeEvent(t,e){const n=this;"focus"!==t&&"blur"!==t&&(n.removed||(e?n.initialized?M1(n,t):n._pendingNativeEvents?n._pendingNativeEvents.push(t):n._pendingNativeEvents=[t]:n.initialized&&(n.dom.unbind(il(n,t),t,n.delegates[t]),delete n.delegates[t])))},unbindAllNativeEvents(){const t=this,e=t.getBody(),n=t.dom;t.delegates&&(At(t.delegates,(r,o)=>{t.dom.unbind(il(t,o),o,r)}),delete t.delegates),!t.inline&&e&&n&&(e.onload=null,n.unbind(t.getWin()),n.unbind(t.getDoc())),n&&(n.unbind(e),n.unbind(t.getContainer()))}}),KR=t=>st(t)?{value:t.split(/[ ,]/),valid:!0}:Wr(t,st)?{value:t,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},F1=(t,e)=>t+(pa(e.message)?"":`. ${e.message}`),U1=t=>t.valid,Sm=(t,e,n="")=>{const r=e(t);return ur(r)?r?{value:t,valid:!0}:{valid:!1,message:n}:r},GR=["design","readonly"],z1=(t,e,n,r)=>{const o=n[e.get()],s=n[r];try{s.activate()}catch(a){return void console.error(`problem while activating editor mode ${r}:`,a)}var a;o.deactivate(),o.editorReadOnly!==s.editorReadOnly&&((t,e)=>{const n=N(t.getBody());var r,o,s;s=e,zl(r=n,o="mce-content-readonly")&&!1===s?ba(r,o):s&&ns(r,o),e?(t.selection.controlSelection.hideResizeRect(),t._selectionOverrides.hideFakeCaret(),(r=>{C.from(r.selection.getNode()).each(o=>{o.removeAttribute("data-mce-selected")})})(t),t.readonly=!0,sl(n,!1),H(Ee(n,'*[contenteditable="true"]'),r=>{re(r,Fo,"true"),sl(r,!1)})):(t.readonly=!1,sl(n,!0),H(Ee(n,'*[data-mce-contenteditable="true"]'),r=>{oe(r,Fo),sl(r,!0)}),wm(t,"StyleWithCSS",!1),wm(t,"enableInlineTableEditing",!1),wm(t,"enableObjectResizing",!1),(r=>Lr(r)||(o=>{const s=vr(N(o.getElement()));return rc(s).filter(a=>!(i=>{const l=i.classList;return void 0!==l&&(l.contains("tox-edit-area")||l.contains("tox-edit-area__iframe")||l.contains("mce-content-body"))})(a.dom)&&ii(o,a.dom)).isSome()})(r))(t)&&t.focus(),(r=>{r.selection.setRng(r.selection.getRng())})(t),t.nodeChanged())})(t,s.editorReadOnly),e.set(r),(a=t).dispatch("SwitchMode",{mode:r})},Em=z.each,_m=z.explode,YR={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},j1=z.makeMap("alt,ctrl,shift,meta,access"),XR=t=>{let e;const n={},r=Ct.os.isMacOS()||Ct.os.isiOS();Em(_m(t.toLowerCase(),"+"),s=>{s in j1?n[s]=!0:/^[0-9]{2,}$/.test(s)?n.keyCode=parseInt(s,10):(n.charCode=s.charCodeAt(0),n.keyCode=YR[s]||s.toUpperCase().charCodeAt(0))});const o=[n.keyCode];for(e in j1)n[e]?o.push(e):n[e]=!1;return n.id=o.join(","),n.access&&(n.alt=!0,r?n.ctrl=!0:n.shift=!0),n.meta&&(r?n.meta=!0:(n.ctrl=!0,n.meta=!1)),n};class V1{constructor(e){this.shortcuts={},this.pendingPatterns=[],this.editor=e;const n=this;e.on("keyup keypress keydown",r=>{!n.hasModifier(r)&&!n.isFunctionKey(r)||r.isDefaultPrevented()||(Em(n.shortcuts,o=>{if(n.matchShortcut(r,o))return n.pendingPatterns=o.subpatterns.slice(0),"keydown"===r.type&&n.executeShortcutAction(o),!0}),n.matchShortcut(r,n.pendingPatterns[0])&&(1===n.pendingPatterns.length&&"keydown"===r.type&&n.executeShortcutAction(n.pendingPatterns[0]),n.pendingPatterns.shift()))})}add(e,n,r,o){const s=this,a=s.normalizeCommandFunc(r);return Em(_m(z.trim(e)),i=>{const l=s.createShortcut(i,n,a,o);s.shortcuts[l.id]=l}),!0}remove(e){const n=this.createShortcut(e);return!!this.shortcuts[n.id]&&(delete this.shortcuts[n.id],!0)}normalizeCommandFunc(e){const n=this,r=e;return"string"==typeof r?()=>{n.editor.execCommand(r,!1,null)}:z.isArray(r)?()=>{n.editor.execCommand(r[0],r[1],r[2])}:r}createShortcut(e,n,r,o){const s=z.map(_m(e,">"),XR);return s[s.length-1]=z.extend(s[s.length-1],{func:r,scope:o||this.editor}),z.extend(s[0],{desc:this.editor.translate(n),subpatterns:s.slice(1)})}hasModifier(e){return e.altKey||e.ctrlKey||e.metaKey}isFunctionKey(e){return"keydown"===e.type&&e.keyCode>=112&&e.keyCode<=123}matchShortcut(e,n){return!!n&&n.ctrl===e.ctrlKey&&n.meta===e.metaKey&&n.alt===e.altKey&&n.shift===e.shiftKey&&!!(e.keyCode===n.keyCode||e.charCode&&e.charCode===n.charCode)&&(e.preventDefault(),!0)}executeShortcutAction(e){return e.func?e.func.call(e.scope):null}}const QR=()=>{const t=(()=>{const e={},n={},r={},o={},s={},a={},i={},l=(d,c)=>(u,f)=>d[u.toLowerCase()]=Rt(at({},f),{type:c});return{addButton:l(e,"button"),addGroupToolbarButton:l(e,"grouptoolbarbutton"),addToggleButton:l(e,"togglebutton"),addMenuButton:l(e,"menubutton"),addSplitButton:l(e,"splitbutton"),addMenuItem:l(n,"menuitem"),addNestedMenuItem:l(n,"nestedmenuitem"),addToggleMenuItem:l(n,"togglemenuitem"),addAutocompleter:l(r,"autocompleter"),addContextMenu:l(s,"contextmenu"),addContextToolbar:l(a,"contexttoolbar"),addContextForm:l(a,"contextform"),addSidebar:l(i,"sidebar"),addIcon:(d,c)=>o[d.toLowerCase()]=c,getAll:()=>({buttons:e,menuItems:n,icons:o,popups:r,contextMenus:s,contextToolbars:a,sidebars:i})}})();return{addAutocompleter:t.addAutocompleter,addButton:t.addButton,addContextForm:t.addContextForm,addContextMenu:t.addContextMenu,addContextToolbar:t.addContextToolbar,addIcon:t.addIcon,addMenuButton:t.addMenuButton,addMenuItem:t.addMenuItem,addNestedMenuItem:t.addNestedMenuItem,addSidebar:t.addSidebar,addSplitButton:t.addSplitButton,addToggleButton:t.addToggleButton,addGroupToolbarButton:t.addGroupToolbarButton,addToggleMenuItem:t.addToggleMenuItem,getAll:t.getAll}},qr=Et.DOM,H1=z.extend,JR=z.each;class ll{constructor(e,n,r){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.editorManager=r,this.documentBaseUrl=r.documentBaseURL,H1(this,I1);const o=this;this.id=e,this.hidden=!1;const s=((t,e,n,r,o)=>{var s;const a=t?{mobile:DR(null!==(s=o.mobile)&&void 0!==s?s:{},e)}:{},i=((t,e)=>{const n=((s,a)=>{const i={},l={};return Um(s,(d,c)=>Ot(t,c),Al(i),Al(l)),{t:i,f:l}})(e);return o=n.f,{sections:q(n.t),options:q(o)};var o})(["mobile"],$u(a,o)),l=z.extend(n,r,i.options(),t&&ym(i,"mobile")?((d,c,u={})=>{const f=d.sections(),m=Nt(f,c).getOr({});return z.extend({},u,m)})(i,"mobile"):{},{external_plugins:PR(r,i.options())});return((d,c,u,f)=>{const m=sa(u.forced_plugins),g=sa(f.plugins),p=ym(v=c,"mobile")?v.sections().mobile:{},b=((v,y,w,x)=>v&&ym(y,"mobile")?x:w)(d,c,g,p.plugins?sa(p.plugins):g),h=((v,y)=>[].concat(sa(v)).concat(sa(y)))(m,b);var v;return z.extend(f,{forced_plugins:m,plugins:h})})(t,i,r,l)})(O1||TR,O1,m=n,r.defaultOptions,m);var m;this.options=((f,m)=>{const g={},p={},b=(v,y,w)=>{const x=Sm(y,w);return U1(x)?(p[v]=x.value,!0):(console.warn(F1(`Invalid value passed for the ${v} option`,x)),!1)},h=v=>gt(g,v);return{register:(v,y)=>{const w=st(y.processor)?(S=>{const k=(()=>{switch(S){case"array":return Kt;case"boolean":return ur;case"function":return xt;case"number":return mn;case"object":return Te;case"string":return st;case"string[]":return KR;case"object[]":return D=>Wr(D,Te);case"regexp":return D=>ma(D,RegExp)}})();return D=>Sm(D,k,`The value must be a ${S}.`)})(y.processor):y.processor,x=((S,k,D)=>{if(!we(k)){const B=Sm(k,D);if(U1(B))return B.value;console.error(F1(`Invalid default value passed for the "${S}" option`,B))}})(v,y.default,w);g[v]=Rt(at({},y),{default:x,processor:w}),Nt(p,v).orThunk(()=>Nt(m,v)).each(S=>b(v,S,w))},isRegistered:h,get:v=>Nt(p,v).orThunk(()=>Nt(g,v).map(y=>y.default)).getOrUndefined(),set:(v,y)=>{if(h(v)){const w=g[v];return w.immutable?(console.error(`"${v}" is an immutable option and cannot be updated`),!1):b(v,y,w.processor)}return console.warn(`"${v}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},unset:v=>{const y=h(v);return y&&delete p[v],y},isSet:v=>gt(p,v)}})(0,s),(f=>{const m=f.options.register;m("id",{processor:"string",default:f.id}),m("selector",{processor:"string"}),m("target",{processor:"object"}),m("suffix",{processor:"string"}),m("cache_suffix",{processor:"string"}),m("base_url",{processor:"string"}),m("referrer_policy",{processor:"string",default:""}),m("language_load",{processor:"boolean"}),m("inline",{processor:"boolean",default:!1}),m("iframe_attrs",{processor:"object",default:{}}),m("doctype",{processor:"string",default:"<!DOCTYPE html>"}),m("document_base_url",{processor:"string",default:f.documentBaseUrl}),m("body_id",{processor:rp(f,"tinymce"),default:"tinymce"}),m("body_class",{processor:rp(f),default:""}),m("content_security_policy",{processor:"string",default:""}),m("br_in_pre",{processor:"boolean",default:!0}),m("forced_root_block",{processor:g=>{const p=st(g)&&Pn(g);return p?{value:g,valid:p}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),m("forced_root_block_attrs",{processor:"object",default:{}}),m("newline_behavior",{processor:g=>{const p=Ot(["block","linebreak","invert","default"],g);return p?{value:g,valid:p}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),m("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),m("no_newline_selector",{processor:"string",default:""}),m("keep_styles",{processor:"boolean",default:!0}),m("end_container_on_empty_block",{processor:g=>ur(g)||st(g)?{valid:!0,value:g}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),m("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),m("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),m("font_size_classes",{processor:"string",default:""}),m("automatic_uploads",{processor:"boolean",default:!0}),m("images_reuse_filename",{processor:"boolean",default:!1}),m("images_replace_blob_uris",{processor:"boolean",default:!0}),m("icons",{processor:"string",default:""}),m("icons_url",{processor:"string",default:""}),m("images_upload_url",{processor:"string",default:""}),m("images_upload_base_path",{processor:"string",default:""}),m("images_upload_base_path",{processor:"string",default:""}),m("images_upload_credentials",{processor:"boolean",default:!1}),m("images_upload_handler",{processor:"function"}),m("language",{processor:"string",default:"en"}),m("language_url",{processor:"string",default:""}),m("entity_encoding",{processor:"string",default:"named"}),m("indent",{processor:"boolean",default:!0}),m("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),m("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),m("indent_use_margin",{processor:"boolean",default:!1}),m("indentation",{processor:"string",default:"40px"}),m("content_css",{processor:g=>{const p=!1===g||st(g)||Wr(g,st);return p?st(g)?{value:yt(g.split(","),Jr),valid:p}:Kt(g)?{value:g,valid:p}:!1===g?{value:[],valid:p}:{value:g,valid:p}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:Ed(f)?[]:["default"]}),m("content_style",{processor:"string"}),m("content_css_cors",{processor:"boolean",default:!1}),m("font_css",{processor:g=>{const p=st(g)||Wr(g,st);return p?{value:Kt(g)?g:yt(g.split(","),Jr),valid:p}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),m("inline_boundaries",{processor:"boolean",default:!0}),m("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),m("object_resizing",{processor:g=>{const p=ur(g)||st(g);return p?!1===g||wd.isiPhone()||wd.isiPad()?{value:"",valid:p}:{value:!0===g?"table,img,figure.image,div,video,iframe":g,valid:p}:{valid:!1,message:"Must be boolean or a string"}},default:!Ex}),m("resize_img_proportional",{processor:"boolean",default:!0}),m("event_root",{processor:"object"}),m("service_message",{processor:"string"}),m("theme",{processor:g=>!1===g||st(g)||xt(g),default:"silver"}),m("theme_url",{processor:"string"}),m("formats",{processor:"object"}),m("format_empty_lines",{processor:"boolean",default:!1}),m("preview_styles",{processor:g=>{const p=!1===g||st(g);return p?{value:!1===g?"":g,valid:p}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),m("custom_ui_selector",{processor:"string",default:""}),m("hidden_input",{processor:"boolean",default:!0}),m("submit_patch",{processor:"boolean",default:!0}),m("encoding",{processor:"string"}),m("add_form_submit_trigger",{processor:"boolean",default:!0}),m("add_unload_trigger",{processor:"boolean",default:!0}),m("custom_undo_redo_levels",{processor:"number",default:0}),m("disable_nodechange",{processor:"boolean",default:!1}),m("readonly",{processor:"boolean",default:!1}),m("plugins",{processor:"string[]",default:[]}),m("external_plugins",{processor:"object"}),m("forced_plugins",{processor:"string[]"}),m("model",{processor:"string",default:f.hasPlugin("rtc")?"plugin":"dom"}),m("model_url",{processor:"string"}),m("block_unsupported_drop",{processor:"boolean",default:!0}),m("visual",{processor:"boolean",default:!0}),m("visual_table_class",{processor:"string",default:"mce-item-table"}),m("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),m("iframe_aria_text",{processor:"string",default:"Rich Text Area. Press ALT-0 for help."}),m("setup",{processor:"function"}),m("init_instance_callback",{processor:"function"}),m("url_converter",{processor:"function",default:f.convertURL}),m("url_converter_scope",{processor:"object",default:f}),m("urlconverter_callback",{processor:"function"}),m("allow_conditional_comments",{processor:"boolean",default:!1}),m("allow_html_data_urls",{processor:"boolean",default:!1}),m("allow_svg_data_urls",{processor:"boolean"}),m("allow_html_in_named_anchor",{processor:"boolean",default:!1}),m("allow_script_urls",{processor:"boolean",default:!1}),m("allow_unsafe_link_target",{processor:"boolean",default:!1}),m("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),m("fix_list_elements",{processor:"boolean",default:!1}),m("preserve_cdata",{processor:"boolean",default:!1}),m("remove_trailing_brs",{processor:"boolean"}),m("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),m("element_format",{processor:"string",default:"html"}),m("entities",{processor:"string"}),m("schema",{processor:"string",default:"html5"}),m("convert_urls",{processor:"boolean",default:!0}),m("relative_urls",{processor:"boolean",default:!0}),m("remove_script_host",{processor:"boolean",default:!0}),m("custom_elements",{processor:"string"}),m("extended_valid_elements",{processor:"string"}),m("invalid_elements",{processor:"string"}),m("invalid_styles",{processor:xd}),m("valid_children",{processor:"string"}),m("valid_classes",{processor:xd}),m("valid_elements",{processor:"string"}),m("valid_styles",{processor:xd}),m("verify_html",{processor:"boolean",default:!0}),m("auto_focus",{processor:g=>st(g)||!0===g}),m("browser_spellcheck",{processor:"boolean",default:!1}),m("protect",{processor:"array"}),m("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),m("deprecation_warnings",{processor:"boolean",default:!0}),m("a11y_advanced_options",{processor:"boolean",default:!1}),m("api_key",{processor:"string"}),m("paste_block_drop",{processor:"boolean",default:!1}),m("paste_data_images",{processor:"boolean",default:!0}),m("paste_preprocess",{processor:"function"}),m("paste_postprocess",{processor:"function"}),m("paste_webkit_styles",{processor:"string",default:"none"}),m("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),m("paste_merge_formats",{processor:"boolean",default:!0}),m("smart_paste",{processor:"boolean",default:!0}),m("paste_as_text",{processor:"boolean",default:!1}),m("paste_tab_spaces",{processor:"number",default:4}),m("text_patterns",{processor:g=>Wr(g,Te)||!1===g?{value:Sx(!1===g?[]:g),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}]}),m("noneditable_class",{processor:"string",default:"mceNonEditable"}),m("editable_class",{processor:"string",default:"mceEditable"}),m("noneditable_regexp",{processor:g=>Wr(g,np)?{value:g,valid:!0}:np(g)?{value:[g],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),m("table_tab_navigation",{processor:"boolean",default:!0}),f.on("ScriptsLoaded",()=>{m("directionality",{processor:"string",default:nn.isRtl()?"rtl":void 0}),m("placeholder",{processor:"string",default:_x.getAttrib(f.getElement(),"placeholder")})})})(o);const a=this.options.get;a("deprecation_warnings")&&((f,m)=>{((g,p)=>{const b=(t=>{const e=dt(JE,r=>gt(t,r)),n=t.forced_root_block;return!1!==n&&""!==n||e.push("forced_root_block (false only)"),Yo(e)})(g),h=(t=>{const e=z.makeMap(t.plugins," "),n=dt(ZE,r=>gt(e,r));return Yo(n)})(p),v=h.length>0,y=b.length>0,w="mobile"===p.theme;if(v||y||w){const x="\n- ",S=w?`\n\nThemes:${x}mobile`:"",k=v?`\n\nPlugins:${x}${h.join(x)}`:"",D=y?`\n\nOptions:${x}${b.join(x)}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 6.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/6/migration-from-5x/ for more information."+S+k+D)}})(f,m)})(n,s);const i=a("suffix");i&&(r.suffix=i),this.suffix=r.suffix;const l=a("base_url");l&&r._setBaseUrl(l),this.baseUri=r.baseURI;const d=kd(o);d&&(In.ScriptLoader._setReferrerPolicy(d),Et.DOM.styleSheetLoader._setReferrerPolicy(d)),ce.languageLoad=a("language_load"),ce.baseURL=r.baseURL,this.setDirty(!1),this.documentBaseURI=new ln(op(o),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=Ed(o),this.shortcuts=new V1(this),this.editorCommands=new D1(this),(t=>{var e;(t=>{(e=>{const n=r=>()=>{H("left,center,right,justify".split(","),o=>{r!==o&&e.formatter.remove("align"+o)}),"none"!==r&&(e.formatter.toggle("align"+r,void 0),e.nodeChanged())};e.editorCommands.addCommands({JustifyLeft:n("left"),JustifyCenter:n("center"),JustifyRight:n("right"),JustifyFull:n("justify"),JustifyNone:n("none")})})(t),(e=>{const n=r=>()=>{const o=e.selection,s=o.isCollapsed()?[e.dom.getParent(o.getNode(),e.dom.isBlock)]:o.getSelectedBlocks();return It(s,a=>lt(e.formatter.matchNode(a,r)))};e.editorCommands.addCommands({JustifyLeft:n("alignleft"),JustifyCenter:n("aligncenter"),JustifyRight:n("alignright"),JustifyFull:n("alignjustify")},"state")})(t)})(t),(e=t).editorCommands.addCommands({"Cut,Copy,Paste":n=>{const r=e.getDoc();let o;try{r.execCommand(n)}catch(s){o=!0}if("paste"!==n||r.queryCommandEnabled(n)||(o=!0),o||!r.queryCommandSupported(n)){let s=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(Ct.os.isMacOS()||Ct.os.isiOS())&&(s=s.replace(/Ctrl\+/g,"\u2318+")),e.notificationManager.open({text:s,type:"error"})}}}),(e=>{e.editorCommands.addCommands({mceAddUndoLevel:()=>{e.undoManager.add()},mceEndUndoLevel:()=>{e.undoManager.add()},Undo:()=>{e.undoManager.undo()},Redo:()=>{e.undoManager.redo()}})})(t),(e=>{e.editorCommands.addCommands({mceSelectNodeDepth:(n,r,o)=>{let s=0;e.dom.getParent(e.selection.getNode(),a=>{if(1===a.nodeType&&s++===o)return e.selection.select(a),!1},e.getBody())},mceSelectNode:(n,r,o)=>{e.selection.select(o)},selectAll:()=>{const n=e.dom.getParent(e.selection.getStart(),vn);if(n){const r=e.dom.createRng();r.selectNodeContents(n),e.selection.setRng(r)}}})})(t),(e=>{e.editorCommands.addCommands({mceCleanup:()=>{const n=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(n)},insertImage:(n,r,o)=>{ol(e,e.dom.createHTML("img",{src:o}))},insertHorizontalRule:()=>{e.execCommand("mceInsertContent",!1,"<hr>")},insertText:(n,r,o)=>{ol(e,e.dom.encode(o))},insertHTML:(n,r,o)=>{ol(e,o)},mceInsertContent:(n,r,o)=>{ol(e,o)},mceSetContent:(n,r,o)=>{e.setContent(o)},mceReplaceContent:(n,r,o)=>{e.execCommand("mceInsertContent",!1,o.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceNewDocument:()=>{e.setContent("")}})})(t),(e=>{const n=(r,o,s)=>{const a=st(s)?{href:s}:s,i=e.dom.getParent(e.selection.getNode(),"a");Te(a)&&st(a.href)&&(a.href=a.href.replace(/ /g,"%20"),i&&a.href||e.formatter.remove("link"),a.href&&e.formatter.apply("link",a,i))};e.editorCommands.addCommands({unlink:()=>{if(e.selection.isCollapsed()){const r=e.dom.getParent(e.selection.getStart(),"a");r&&e.dom.remove(r,!0)}else e.formatter.remove("link")},mceInsertLink:n,createLink:n})})(t),(e=>{e.editorCommands.addCommands({Indent:()=>{hy(e,"indent")},Outdent:()=>{by(e)}}),e.editorCommands.addCommands({Outdent:()=>fy(e)},"state")})(t),(e=>{e.editorCommands.addCommands({insertParagraph:()=>{Ji(xC,e)},mceInsertNewLine:(n,r,o)=>{AC(e,o)},InsertLineBreak:(n,r,o)=>{Ji(EC,e)}})})(t),(e=>{var n;(n=e).editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":r=>{n.getDoc().execCommand(r);const o=n.dom.getParent(n.selection.getNode(),"ol,ul");if(o){const s=o.parentNode;if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(s.nodeName)){const a=n.selection.getBookmark();n.dom.split(s,o),n.selection.moveToBookmark(a)}}}}),(n=>{n.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":r=>{const o=n.dom.getParent(n.selection.getNode(),"ul,ol");return o&&("insertunorderedlist"===r&&"UL"===o.tagName||"insertorderedlist"===r&&"OL"===o.tagName)}},"state")})(e)})(t),(e=>{(n=>{const r=(o,s)=>{n.formatter.toggle(o,s),n.nodeChanged()};n.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":o=>{r(o)},"ForeColor,HiliteColor":(o,s,a)=>{r(o,{value:a})},BackColor:(o,s,a)=>{r("hilitecolor",{value:a})},FontName:(o,s,a)=>{((i,l)=>{const d=B1(i,l);i.formatter.toggle("fontname",{value:VR(d)}),i.nodeChanged()})(n,a)},FontSize:(o,s,a)=>{var i;(i=n).formatter.toggle("fontsize",{value:B1(i,a)}),i.nodeChanged()},LineHeight:(o,s,a)=>{var i;(i=n).formatter.toggle("lineheight",{value:String(a)}),i.nodeChanged()},Lang:(o,s,a)=>{r(o,{value:a.code,customValue:a.customCode})},RemoveFormat:o=>{n.formatter.remove(o)},mceBlockQuote:()=>{r("blockquote")},FormatBlock:(o,s,a)=>{r(st(a)?a:"p")},mceToggleFormat:(o,s,a)=>{r(a)}})})(e),(n=>{const r=o=>n.formatter.match(o);n.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":o=>r(o),mceBlockQuote:()=>r("blockquote")},"state"),n.editorCommands.addQueryValueHandler("FontName",()=>{return Cm(o=n,s=>zR(o.getBody(),s.dom)).getOr("");var o}),n.editorCommands.addQueryValueHandler("FontSize",()=>{return Cm(o=n,s=>UR(o.getBody(),s.dom)).getOr("");var o}),n.editorCommands.addQueryValueHandler("LineHeight",()=>{return Cm(o=n,s=>{const a=N(o.getBody());return Ic(s,l=>Ca(l,"line-height"),Y(kt,a)).getOrThunk(()=>{const l=parseFloat(bn(s,"line-height")),d=parseFloat(bn(s,"font-size"));return String(l/d)})}).getOr("");var o})})(e)})(t),(e=>{e.editorCommands.addCommands({mceRemoveNode:(n,r,o)=>{const s=null!=o?o:e.selection.getNode();if(s!==e.getBody()){const a=e.selection.getBookmark();e.dom.remove(s,!0),e.selection.moveToBookmark(a)}},mcePrint:()=>{e.getWin().print()},mceFocus:(n,r,o)=>{var s;(s=e).removed||(o?lc(s):(i=>{const l=i.selection,d=i.getBody();let c=l.getRng();i.quirks.refreshContentEditable(),void 0!==i.bookmark&&!1===Lr(i)&&sc(i).each(f=>{i.selection.setRng(f),c=f});const u=(f=i,m=l.getNode(),f.dom.getParent(m,g=>"true"===f.dom.getContentEditable(g)));var f,m;if(i.dom.isChildOf(u,d))return ic(u),Wh(i,c),void lc(i);i.inline||(Ct.browser.isOpera()||ic(d),i.getWin().focus()),(Ct.browser.isFirefox()||i.inline)&&(ic(d),Wh(i,c)),lc(i)})(s))},mceToggleVisualAid:()=>{e.hasVisual=!e.hasVisual,e.addVisual()}})})(t)})(this);const c=a("cache_suffix");c&&(Ct.cacheSuffix=c.replace(/^[\?\&]+/,"")),this.ui={registry:QR(),styleSheetLoader:void 0,show:pt,hide:pt,setEnabled:pt,isEnabled:Vt},this.mode=(f=>{const m=Xt("design"),g=Xt({design:{activate:pt,deactivate:pt,editorReadOnly:!1},readonly:{activate:pt,deactivate:pt,editorReadOnly:!0}});return(p=f).serializer?P1(p):p.on("PreInit",()=>{P1(p)}),(p=>{p.on("ShowCaret",b=>{Hr(p)&&b.preventDefault()}),p.on("ObjectSelected",b=>{Hr(p)&&b.preventDefault()})})(f),{isReadOnly:()=>Hr(f),set:p=>((b,h,v,y)=>{if(y!==v.get()){if(!gt(h,y))throw new Error(`Editor mode '${y}' is invalid`);b.initialized?z1(b,v,h,y):b.on("init",()=>z1(b,v,h,y))}})(f,g.get(),m,p),get:()=>m.get(),register:(p,b)=>{g.set(((h,v,y)=>{if(Ot(GR,v))throw new Error(`Cannot override default mode ${v}`);return Rt(at({},h),{[v]:Rt(at({},y),{deactivate:()=>{try{y.deactivate()}catch(w){console.error(`problem while deactivating editor mode ${v}:`,w)}}})})})(g.get(),p,b))}};var p})(o),r.dispatch("SetupEditor",{editor:this});const u=bk(o);xt(u)&&u.call(o,o)}render(){(e=>{const n=e.id;nn.setCode(dp(e));const r=()=>{Vr.unbind(window,"ready",r),e.render()};if(!_r.Event.domLoaded)return void Vr.bind(window,"ready",r);if(!e.getElement())return;const o=N(e.getElement()),s=hf(o);var l;e.on("remove",()=>{Mm(o.dom.attributes,i=>oe(o,i.name)),pn(o,s)}),e.ui.styleSheetLoader=Qf.forElement(o,{contentCssCors:uk(l=e),referrerPolicy:kd(l)}),Ed(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");const a=e.getElement().form||Vr.getParent(n,"form");a&&(e.formElement=a,sk(e)&&!Wl(e.getElement())&&(Vr.insertAfter(Vr.create("input",{type:"hidden",name:n}),n),e.hasHiddenInput=!0),e.formEventDelegate=i=>{e.dispatch(i.type,i)},Vr.bind(a,"submit reset",e.formEventDelegate),e.on("reset",()=>{e.resetContent()}),!ak(e)||a.submit.nodeType||a.submit.length||a._mceOldSubmit||(a._mceOldSubmit=a.submit,a.submit=()=>(e.editorManager.triggerSave(),e.setDirty(!1),a._mceOldSubmit(a)))),e.windowManager=mv(e),e.notificationManager=uv(e),"xml"===e.options.get("encoding")&&e.on("GetContent",i=>{i.save&&(i.content=Vr.encode(i.content))}),ik(e)&&e.on("submit",()=>{e.initialized&&e.save()}),lk(e)&&(e._beforeUnload=()=>{!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),((t,e)=>{const n=In.ScriptLoader,r=()=>{!t.removed&&(o=>{const s=ho(o);return!st(s)||lt(jr.get(s))})(t)&&(o=>{const s=Sd(o);return lt(Ao.get(s))})(t)&&(t=>{t.dispatch("ScriptsLoaded"),(r=>{const o=z.trim(lp(r)),s=r.ui.registry.getAll().icons,a=at(at({},Oi.get("default").icons),Oi.get(o).icons);At(a,(i,l)=>{gt(s,l)||r.ui.registry.addIcon(l,i)})})(t),(r=>{const o=ho(r);if(st(o)){const s=jr.get(o);r.theme=s(r,jr.urls[o])||{},xt(r.theme.init)&&r.theme.init(r,jr.urls[o]||r.documentBaseUrl.replace(/\/$/,""))}else r.theme={}})(t),(r=>{const o=Sd(r),s=Ao.get(o);r.model=s(r,Ao.urls[o])})(t),(r=>{const o=[];H(za(r),s=>{((a,i,l)=>{const d=Oo.get(l),c=Oo.urls[l]||a.documentBaseUrl.replace(/\/$/,"");if(l=z.trim(l),d&&-1===z.inArray(i,l)){if(a.plugins[l])return;try{const u=d(a,c)||{};a.plugins[l]=u,xt(u.init)&&(u.init(a,c),i.push(l))}catch(u){((f,m,g)=>{const p=nn.translate(["Failed to initialize plugin: {0}",m]);hh(f,"PluginLoadError",{message:p}),Bi(p,g),Ti(f,p)})(a,l,u)}}})(r,o,s.replace(/^\-/,""))})})(t);const e=(t=>{const e=t.getElement();return t.orgDisplay=e.style.display,st(ho(t))?t.theme.renderUI():xt(ho(t))?(n=>{const r=n.getElement(),o=ho(n)(n,r);return o.editorContainer.nodeType&&(o.editorContainer.id=o.editorContainer.id||n.id+"_parent"),o.iframeContainer&&o.iframeContainer.nodeType&&(o.iframeContainer.id=o.iframeContainer.id||n.id+"_iframecontainer"),o.height=o.iframeHeight?o.iframeHeight:r.offsetHeight,o})(t):(n=>{const r=n.getElement();return n.inline?_1(null):(o=>{const s=E1.create("div");return E1.insertAfter(s,o),_1(s)})(r)})(t)})(t);((r,o)=>{const s={show:C.from(o.show).getOr(pt),hide:C.from(o.hide).getOr(pt),isEnabled:C.from(o.isEnabled).getOr(Vt),setEnabled:a=>{r.mode.isReadOnly()||C.from(o.setEnabled).each(i=>i(a))}};r.ui=at(at({},r.ui),s)})(t,C.from(e.api).getOr({}));const n={editorContainer:e.editorContainer,iframeContainer:e.iframeContainer};return t.editorContainer=n.editorContainer?n.editorContainer:null,(r=t).contentCSS=r.contentCSS.concat(gv(o=r,Wx(o)),(o=>gv(o,up(o)))(r)),t.inline?S1(t):((r,o)=>{((s,a)=>{const i=s.translate("Rich Text Area"),l=to(N(s.getElement()),"tabindex").bind(bw),d=((c,u,f,m)=>{const g=Ut("iframe");return m.each(p=>re(g,"tabindex",p)),pn(g,f),pn(g,{id:c+"_ifr",frameBorder:"0",allowTransparency:"true",title:u}),ns(g,"tox-edit-area__iframe"),g})(s.id,i,Nx(s),l).dom;d.onload=()=>{d.onload=null,s.dispatch("load")},s.contentAreaContainer=a.iframeContainer,s.iframeElement=d,s.iframeHTML=(c=>{let u=Rx(c)+"<html><head>";op(c)!==c.documentBaseUrl&&(u+='<base href="'+c.documentBaseURI.getURI()+'" />'),u+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';const f=Ax(c),m=Ox(c),g=c.translate(hk(c));return sp(c)&&(u+='<meta http-equiv="Content-Security-Policy" content="'+sp(c)+'" />'),u+=`</head><body id="${f}" class="mce-content-body ${m}" data-id="${c.id}" aria-label="${g}"><br></body></html>`,u})(s),rl.add(a.iframeContainer,d)})(r,o),o.editorContainer&&(rl.get(o.editorContainer).style.display=r.orgDisplay,r.hidden=rl.isHidden(o.editorContainer)),r.getElement().style.display="none",rl.setAttrib(r.id,"aria-hidden","true"),S1(r)})(t,n);var r,o})(t)};((o,s)=>{const a=ho(o);if(st(a)&&!N1(a)&&!gt(jr.urls,a)){const i=Zx(o),l=i?o.documentBaseURI.toAbsolute(i):`themes/${a}/theme${s}.js`;jr.load(a,l).catch(()=>{qs(o,"ThemeLoadError",Ws("theme",l,a))})}})(t,e),((o,s)=>{const a=Sd(o);if("plugin"!==a&&!gt(Ao.urls,a)){const i=tk(o),l=st(i)?o.documentBaseURI.toAbsolute(i):`models/${a}/model${s}.js`;Ao.load(a,l).catch(()=>{qs(o,"ModelLoadError",Ws("model",l,a))})}})(t,e),((o,s)=>{const a=dp(s),i=$x(s);if(!1===nn.hasCode(a)&&"en"!==a){const l=Pn(i)?i:`${s.editorManager.baseURL}/langs/${a}.js`;o.add(l).catch(()=>{qs(s,"LanguageLoadError",Ws("language",l,a))})}})(n,t),((o,s,a)=>{const i=R1(s,"default",a),l=(d=s,C.from(Fx(d)).filter(Pn).map(c=>({url:c,name:C.none()}))).orThunk(()=>R1(s,lp(s),""));var d;H((d=>{const c=[],u=f=>{c.push(f)};for(let f=0;f<d.length;f++)d[f].each(u);return c})([i,l]),d=>{o.add(d.url).catch(()=>{var c,u,f;c=s,u=d.url,f=d.name.getOrUndefined(),qs(c,"IconsLoadError",Ws("icons",u,f))})})})(n,t,e),((o,s)=>{const a=(i,l)=>{Oo.load(i,l).catch(()=>{qs(o,"PluginLoadError",Ws("plugin",l,i))})};At(mk(o),(i,l)=>{a(l,i),o.options.set("plugins",za(o).concat(l))}),H(za(o),i=>{!(i=z.trim(i))||Oo.urls[i]||N1(i)||a(i,`plugins/${i}/plugin${s}.js`)})})(t,e),n.loadQueue().then(r,r)})(e,e.suffix)})(this)}focus(e){this.execCommand("mceFocus",!1,e)}hasFocus(){return Lr(this)}translate(e){return nn.translate(e)}getParam(e,n,r){const o=this.options;return o.isRegistered(e)||(lt(r)?o.register(e,{processor:r,default:n}):o.register(e,{processor:Vt,default:n})),o.isSet(e)||we(n)?o.get(e):n}hasPlugin(e,n){return!(!Ot(za(this),e)||n&&void 0===Oo.get(e))}nodeChanged(e){this._nodeChangeDispatcher.nodeChanged(e)}addCommand(e,n,r){this.editorCommands.addCommand(e,n,r)}addQueryStateHandler(e,n,r){this.editorCommands.addQueryStateHandler(e,n,r)}addQueryValueHandler(e,n,r){this.editorCommands.addQueryValueHandler(e,n,r)}addShortcut(e,n,r,o){this.shortcuts.add(e,n,r,o)}execCommand(e,n,r,o){return this.editorCommands.execCommand(e,n,r,o)}queryCommandState(e){return this.editorCommands.queryCommandState(e)}queryCommandValue(e){return this.editorCommands.queryCommandValue(e)}queryCommandSupported(e){return this.editorCommands.queryCommandSupported(e)}show(){const e=this;e.hidden&&(e.hidden=!1,e.inline?e.getBody().contentEditable="true":(qr.show(e.getContainer()),qr.hide(e.id)),e.load(),e.dispatch("show"))}hide(){const e=this;e.hidden||(e.save(),e.inline?(e.getBody().contentEditable="false",e===e.editorManager.focusedEditor&&(e.editorManager.focusedEditor=null)):(qr.hide(e.getContainer()),qr.setStyle(e.id,"display",e.orgDisplay)),e.hidden=!0,e.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(e,n){this.dispatch("ProgressState",{state:e,time:n})}load(e){const n=this;let r,o=n.getElement();if(n.removed)return"";if(o){(e=e||{}).load=!0;const s=Wl(o)?o.value:o.innerHTML;return r=n.setContent(s,e),e.element=o,e.no_events||n.dispatch("LoadContent",e),e.element=o=null,r}}save(e){const n=this;let r,o,s=n.getElement();if(s&&n.initialized&&!n.removed)return(e=e||{}).save=!0,e.element=s,r=e.content=n.getContent(e),e.no_events||n.dispatch("SaveContent",e),"raw"===e.format&&n.dispatch("RawSaveContent",e),r=e.content,Wl(s)?s.value=r:(!e.is_removing&&n.inline||(s.innerHTML=r),(o=qr.getParent(n.id,"form"))&&JR(o.elements,a=>{if(a.name===n.id)return a.value=r,!1})),e.element=s=null,!1!==e.set_dirty&&n.setDirty(!1),r}setContent(e,n){return gu(this,e,n)}getContent(e){return((n,r={})=>{const o=(a=r.format?r.format:"html",Rt(at({},r),{format:a,get:!0,getInner:!0}));var a;return H0(n,o).fold(pe,s=>{const a=(l=s,fu(n).editor.getContent(l));var l;return $0(n,a,s)})})(this,e)}insertContent(e,n){n&&(e=H1({content:e},n)),this.execCommand("mceInsertContent",!1,e)}resetContent(e){void 0===e?gu(this,this.startContent,{format:"raw"}):gu(this,e),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(e){const n=!this.isNotDirty;this.isNotDirty=!e,e&&e!==n&&this.dispatch("dirty")}getContainer(){const e=this;return e.container||(e.container=qr.get(e.editorContainer||e.id+"_parent")),e.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=qr.get(this.id)),this.targetElm}getWin(){const e=this;let n;return e.contentWindow||(n=e.iframeElement,n&&(e.contentWindow=n.contentWindow)),e.contentWindow}getDoc(){const e=this;let n;return e.contentDocument||(n=e.getWin(),n&&(e.contentDocument=n.document)),e.contentDocument}getBody(){const e=this.getDoc();return this.bodyElement||(e?e.body:null)}convertURL(e,n,r){const o=this,s=o.options.get,a=yk(o);return xt(a)?a.call(o,e,r,!0,n):!s("convert_urls")||r&&"LINK"===r.nodeName||0===e.indexOf("file:")||0===e.length?e:s("relative_urls")?o.documentBaseURI.toRelative(e):e=o.documentBaseURI.toAbsolute(e,s("remove_script_host"))}addVisual(e){((n,r)=>{var s;s=r,Lt(this).editor.addVisual(s)})(0,e)}remove(){(e=>{if(!e.removed){const{_selectionOverrides:n,editorUpload:r}=e,o=e.getBody(),s=e.getElement();o&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&s&&Ri.remove(s.nextSibling),e.dispatch("remove"),e.editorManager.remove(e),!e.inline&&o&&Ri.setStyle((a=e).id,"display",a.orgDisplay),(a=>{a.dispatch("detach")})(e),Ri.remove(e.getContainer()),Ai(n),Ai(r),e.destroy()}var a})(this)}destroy(e){((n,r)=>{const{selection:o,dom:s}=n;var a;n.destroyed||(r||n.removed?(r||(n.editorManager.off("beforeunload",n._beforeUnload),n.theme&&n.theme.destroy&&n.theme.destroy(),Ai(o),Ai(s)),(a=>{const i=a.formElement;i&&(i._mceOldSubmit&&(i.submit=i._mceOldSubmit,i._mceOldSubmit=null),Ri.unbind(i,"submit reset",a.formEventDelegate))})(n),(a=n).contentAreaContainer=a.formElement=a.container=a.editorContainer=null,a.bodyElement=a.contentDocument=a.contentWindow=null,a.iframeElement=a.targetElm=null,a.selection&&(a.selection=a.selection.win=a.selection.dom=a.selection.dom.doc=null),n.destroyed=!0):n.remove())})(this,e)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}const Uo=Et.DOM,dl=z.each;let cl,$1=!1,ye=[];const ul=t=>{const e=t.type;dl(dr.get(),n=>{switch(e){case"scroll":n.dispatch("ScrollWindow",t);break;case"resize":n.dispatch("ResizeWindow",t)}})},q1=t=>{if(t!==$1){const e=Et.DOM;t?(e.bind(window,"resize",ul),e.bind(window,"scroll",ul)):(e.unbind(window,"resize",ul),e.unbind(window,"scroll",ul)),$1=t}},W1=t=>{const e=ye;return ye=dt(ye,n=>t!==n),dr.activeEditor===t&&(dr.activeEditor=ye.length>0?ye[0]:null),dr.focusedEditor===t&&(dr.focusedEditor=null),e.length!==ye.length},ZR="CSS1Compat"!==document.compatMode,dr=Rt(at({},km),{baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"6",minorVersion:"1.0",releaseDate:"2022-06-29",i18n:nn,activeEditor:null,focusedEditor:null,setup(){const t=this;let e,n,r="";n=ln.getDocumentBaseUrl(document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(n)&&(n=n.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(n)||(n+="/"));const o=window.tinymce||window.tinyMCEPreInit;if(o)e=o.base||o.baseURL,r=o.suffix;else{const a=document.getElementsByTagName("script");for(let i=0;i<a.length;i++){const l=a[i].src||"";if(""===l)continue;const d=l.substring(l.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(l)){-1!==d.indexOf(".min")&&(r=".min"),e=l.substring(0,l.lastIndexOf("/"));break}}if(!e&&document.currentScript){const i=document.currentScript.src;-1!==i.indexOf(".min")&&(r=".min"),e=i.substring(0,i.lastIndexOf("/"))}}var s;t.baseURL=new ln(n).toAbsolute(e),t.documentBaseURL=n,t.baseURI=new ln(t.baseURL),t.suffix=r,(s=t).on("AddEditor",Y(wS,s)),s.on("RemoveEditor",Y(xS,s))},overrideDefaults(t){const e=t.base_url;e&&this._setBaseUrl(e),t.suffix&&(this.suffix=t.suffix),this.defaultOptions=t;const r=t.plugin_base_urls;void 0!==r&&At(r,(o,s)=>{ce.PluginManager.urls[s]=o})},init(t){const e=this;let n;const r=z.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," ");let o=a=>{n=a};const s=()=>{let a=0;const i=[];let l;var d;Uo.unbind(window,"ready",s),(d=>{const c=t.onpageload;c&&c.apply(e,[])})(),l=((d,c)=>{const u=[],f=xt(c)?m=>It(u,g=>c(g,m)):m=>Ot(u,m);for(let m=0,g=d.length;m<g;m++){const p=d[m];f(p)||u.push(p)}return u})((d=t,Ct.browser.isIE()||Ct.browser.isEdge()?(Bi("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/6/support/#supportedwebbrowsers"),[]):ZR?(Bi("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):st(d.selector)?Uo.select(d.selector):lt(d.target)?[d.target]:[])),z.each(l,d=>{var c;(c=e.get(d.id))&&c.initialized&&!(c.getContainer()||c.getBody()).parentNode&&(W1(c),c.unbindAllNativeEvents(),c.destroy(!0),c.removed=!0,c=null)}),l=z.grep(l,d=>!e.get(d.id)),0===l.length?o([]):dl(l,d=>{t.inline&&d.tagName.toLowerCase()in r?Bi("Could not initialize inline editor on invalid inline target element",d):((c,u,f)=>{const m=new ll(c,u,e);i.push(m),m.on("init",()=>{++a===l.length&&o(i)}),m.targetElm=m.targetElm||f,m.render()})((c=>{let u=c.id;return u||(u=Nt(c,"name").filter(f=>!Uo.get(f)).getOrThunk(Uo.uniqueId),c.setAttribute("id",u)),u})(d),t,d)})};return Uo.bind(window,"ready",s),new Promise(a=>{n?a(n):o=i=>{a(i)}})},get(t){return 0===arguments.length?ye.slice(0):st(t)?Gt(ye,e=>e.id===t).getOr(null):mn(t)&&ye[t]?ye[t]:null},add(t){const e=this,n=e.get(t.id);return n===t||(null===n&&ye.push(t),q1(!0),e.activeEditor=t,e.dispatch("AddEditor",{editor:t}),cl||(cl=r=>{const o=e.dispatch("BeforeUnload");if(o.returnValue)return r.preventDefault(),r.returnValue=o.returnValue,o.returnValue},window.addEventListener("beforeunload",cl))),t},createEditor(t,e){return this.add(new ll(t,e,this))},remove(t){const e=this;let n,r;if(t){if(!st(t))return r=t,$o(e.get(r.id))?null:(W1(r)&&e.dispatch("RemoveEditor",{editor:r}),0===ye.length&&window.removeEventListener("beforeunload",cl),r.remove(),q1(ye.length>0),r);dl(Uo.select(t),o=>{r=e.get(o.id),r&&e.remove(r)})}else for(n=ye.length-1;n>=0;n--)e.remove(ye[n])},execCommand(t,e,n){var r;const o=this,s=Te(n)?null!==(r=n.id)&&void 0!==r?r:n.index:n;switch(t){case"mceAddEditor":return o.get(s)||new ll(s,n.options,o).render(),!0;case"mceRemoveEditor":{const a=o.get(s);return a&&a.remove(),!0}case"mceToggleEditor":{const a=o.get(s);return a?(a.isHidden()?a.show():a.hide(),!0):(o.execCommand("mceAddEditor",!1,n),!0)}}return!!o.activeEditor&&o.activeEditor.execCommand(t,e,n)},triggerSave:()=>{dl(ye,t=>{t.save()})},addI18n:(t,e)=>{nn.add(t,e)},translate:t=>nn.translate(t),setActive(t){const e=this.activeEditor;this.activeEditor!==t&&(e&&e.dispatch("deactivate",{relatedTarget:t}),t.dispatch("activate",{relatedTarget:e})),this.activeEditor=t},_setBaseUrl(t){this.baseURL=new ln(this.documentBaseURL).toAbsolute(t.replace(/\/+$/,"")),this.baseURI=new ln(this.baseURL)}});dr.setup();const tA=(()=>{const t=Zn();return{FakeClipboardItem:e=>({items:e,types:Ke(e),getType:n=>Nt(e,n).getOrUndefined()}),write:e=>{t.set(e)},read:()=>t.get().getOrUndefined(),clear:t.clear}})(),K1=Math.min,zo=Math.max,ml=Math.round,G1=(t,e,n)=>{let r=e.x,o=e.y;const s=t.w,a=t.h,i=e.w,l=e.h,d=(n||"").split("");return"b"===d[0]&&(o+=l),"r"===d[1]&&(r+=i),"c"===d[0]&&(o+=ml(l/2)),"c"===d[1]&&(r+=ml(i/2)),"b"===d[3]&&(o-=a),"r"===d[4]&&(r-=s),"c"===d[3]&&(o-=ml(a/2)),"c"===d[4]&&(r-=ml(s/2)),jo(r,o,s,a)},jo=(t,e,n,r)=>({x:t,y:e,w:n,h:r}),eA={inflate:(t,e,n)=>jo(t.x-e,t.y-n,t.w+2*e,t.h+2*n),relativePosition:G1,findBestRelativePosition:(t,e,n,r)=>{let o,s;for(s=0;s<r.length;s++)if(o=G1(t,e,r[s]),o.x>=n.x&&o.x+o.w<=n.w+n.x&&o.y>=n.y&&o.y+o.h<=n.h+n.y)return r[s];return null},intersect:(t,e)=>{const n=zo(t.x,e.x),r=zo(t.y,e.y),o=K1(t.x+t.w,e.x+e.w),s=K1(t.y+t.h,e.y+e.h);return o-n<0||s-r<0?null:jo(n,r,o-n,s-r)},clamp:(t,e,n)=>{let r=t.x,o=t.y,s=t.x+t.w,a=t.y+t.h;const i=e.x+e.w,l=e.y+e.h,d=zo(0,e.x-r),c=zo(0,e.y-o),u=zo(0,s-i),f=zo(0,a-l);return r+=d,o+=c,n&&(s+=d,a+=c,r-=u,o-=f),s-=u,a-=f,jo(r,o,s-r,a-o)},create:jo,fromClientRect:t=>jo(t.left,t.top,t.width,t.height)},nA=(()=>{const t={},e={};return{load:(n,r)=>{const o=`Script at URL "${r}" failed to load`,s=`Script at URL "${r}" did not call \`tinymce.Resource.add('${n}', data)\` within 1 second`;if(void 0!==t[n])return t[n];{const a=new Promise((i,l)=>{const d=((c,u,f=1e3)=>{let m=!1,g=null;const p=v=>(...y)=>{m||(m=!0,null!==g&&(clearTimeout(g),g=null),v.apply(null,y))},b=p(c),h=p(u);return{start:(...v)=>{m||null!==g||(g=setTimeout(()=>h.apply(null,v),f))},resolve:b,reject:h}})(i,l);e[n]=d.resolve,In.ScriptLoader.loadScript(r).then(()=>d.start(s),()=>d.reject(o))});return t[n]=a,a}},add:(n,r)=>{void 0!==e[n]&&(e[n](r),delete e[n]),t[n]=Promise.resolve(r)},unload:n=>{delete t[n]}}})();let ia;try{const t="__storage_test__";ia=window.localStorage,ia.setItem(t,t),ia.removeItem(t)}catch(t){ia=(()=>{let e={},n=[];const r={getItem:o=>e[o]||null,setItem:(o,s)=>{n.push(o),e[o]=String(s)},key:o=>n[o],removeItem:o=>{n=n.filter(s=>s===o),delete e[o]},clear:()=>{n=[],e={}},length:0};return Object.defineProperty(r,"length",{get:()=>n.length,configurable:!1,enumerable:!1}),r})()}const rA={geom:{Rect:eA},util:{Delay:je,Tools:z,VK:J,URI:ln,EventDispatcher:xm,Observable:km,I18n:nn,LocalStorage:ia,ImageUploader:t=>{const e=pv(),n=bv(t,e);return{upload:(r,o=!0)=>n.upload(r,o?hv(t):void 0)}}},dom:{EventUtils:_r,TreeWalker:zt,TextSeeker:Rr,DOMUtils:Et,ScriptLoader:In,RangeUtils:Eo,Serializer:lv,StyleSheetLoader:Xf,ControlSelection:xh,BookmarkManager:Ds,Selection:iv,Event:_r.Event},html:{Styles:id,Entities:Xn,Node:ve,Schema:Jn,DomParser:Ro,Writer:sb,Serializer:rr},Env:Ct,AddOnManager:ce,Annotator:gh,Formatter:Cv,UndoManager:xv,EditorCommands:D1,WindowManager:mv,NotificationManager:uv,EditorObservable:I1,Shortcuts:V1,Editor:ll,FocusManager:qh,EditorManager:dr,DOM:Et.DOM,ScriptLoader:In.ScriptLoader,PluginManager:Oo,ThemeManager:jr,ModelManager:Ao,IconManager:Oi,Resource:nA,FakeClipboard:tA,trim:z.trim,isArray:z.isArray,is:z.is,toArray:z.toArray,makeMap:z.makeMap,each:z.each,map:z.map,grep:z.grep,inArray:z.inArray,extend:z.extend,walk:z.walk,resolve:z.resolve,explode:z.explode,_addCacheSuffix:z._addCacheSuffix},Y1=z.extend(dr,rA);(t=>{window.tinymce=t,window.tinyMCE=t})(Y1),(t=>{if("object"==typeof module)try{module.exports=t}catch(e){}})(Y1)}();